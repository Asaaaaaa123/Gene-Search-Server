<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Appendix 1. System_Architecture_Complete - GenoCorr Platform System Architecture</title>
    <style>
        @media print {
            @page {
                size: A4;
                margin: 2.5cm 2cm;
            }
            
            body {
                print-color-adjust: exact;
                -webkit-print-color-adjust: exact;
            }
            
            .no-print {
                display: none;
            }
            
            h1, h2, h3, h4, h5, h6 {
                page-break-after: avoid;
            }
            
            pre, blockquote, table {
                page-break-inside: avoid;
            }
            
            .flow-diagram {
                page-break-inside: avoid;
            }
        }
        
        body {
            font-family: "Microsoft YaHei", "SimHei", "Arial Unicode MS", "DejaVu Sans", Arial, sans-serif;
            line-height: 1.8;
            color: #333;
            font-size: 12pt;
            max-width: 210mm;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
        }
        
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #3498db;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14pt;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        .print-button:hover {
            background-color: #2980b9;
        }
        
        h1 {
            font-size: 28pt;
            font-weight: bold;
            color: #2c3e50;
            margin-top: 1.5em;
            margin-bottom: 0.8em;
            border-bottom: 3px solid #3498db;
            padding-bottom: 0.5em;
        }
        
        h2 {
            font-size: 22pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1.5em;
            margin-bottom: 0.6em;
            border-bottom: 2px solid #95a5a6;
            padding-bottom: 0.3em;
        }
        
        h3 {
            font-size: 18pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1.3em;
            margin-bottom: 0.5em;
        }
        
        h4 {
            font-size: 16pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1.2em;
            margin-bottom: 0.4em;
        }
        
        h5, h6 {
            font-size: 14pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1em;
            margin-bottom: 0.3em;
        }
        
        p {
            margin: 0.8em 0;
            text-align: justify;
        }
        
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", "Courier New", monospace;
            font-size: 10.5pt;
            color: #c7254e;
            border: 1px solid #e1e1e1;
        }
        
        pre {
            background-color: #f8f8f8;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border-left: 4px solid #3498db;
            margin: 1em 0;
            font-family: "Consolas", "Monaco", "Courier New", monospace;
            font-size: 10pt;
            line-height: 1.5;
        }
        
        pre code {
            background-color: transparent;
            padding: 0;
            border: none;
            color: #333;
            font-size: 10pt;
            display: block;
            white-space: pre;
            overflow-x: auto;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 1.5em 0;
            font-size: 11pt;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
            text-align: center;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        ul, ol {
            margin: 0.8em 0;
            padding-left: 2em;
        }
        
        li {
            margin: 0.4em 0;
        }
        
        blockquote {
            border-left: 4px solid #3498db;
            margin: 1.5em 0;
            padding-left: 1.5em;
            padding-right: 1em;
            color: #555;
            font-style: italic;
            background-color: #f9f9f9;
            padding-top: 0.5em;
            padding-bottom: 0.5em;
        }
        
        hr {
            border: none;
            border-top: 2px solid #ddd;
            margin: 2em 0;
        }
        
        strong {
            font-weight: bold;
            color: #2c3e50;
        }
        
        em {
            font-style: italic;
            color: #555;
        }
        
        .toc {
            background-color: #f9f9f9;
            padding: 1.5em;
            margin: 1.5em 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 1em;
        }
        
        .toc li {
            margin: 0.3em 0;
        }
        
        .toc a {
            color: #3498db;
            text-decoration: none;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        /* æµç¨‹å›¾æ ·å¼ */
        .flow-diagram {
            background-color: #f8f8f8;
            padding: 15px;
            border-radius: 5px;
            margin: 1.5em 0;
            border: 1px solid #ddd;
            font-family: "Consolas", "Monaco", "Courier New", monospace;
            font-size: 10pt;
            overflow-x: auto;
            white-space: pre;
        }
        
        /* ä»£ç å—ä¸­çš„ç‰¹æ®Šå­—ç¬¦ */
        pre.highlight, pre code {
            white-space: pre;
            word-wrap: normal;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <button class="print-button no-print" onclick="window.print()">
        ğŸ–¨ï¸ Print to PDF
    </button>
    
    <h1 id="genocorr">GenoCorr å¹³å°å®Œæ•´ç³»ç»Ÿæ¶æ„æ–‡æ¡£<a class="headerlink" href="#genocorr" title="Permanent link">&para;</a></h1>
<h2 id="_1">ç›®å½•<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#æ•´ä½“æ¶æ„æ¦‚è¿°">æ•´ä½“æ¶æ„æ¦‚è¿°</a></li>
<li><a href="#ä¸‰å±‚æ¶æ„è¯¦è§£">ä¸‰å±‚æ¶æ„è¯¦è§£</a></li>
<li><a href="#å‰ç«¯æ¶æ„è¯¦ç»†è®¾è®¡">å‰ç«¯æ¶æ„è¯¦ç»†è®¾è®¡</a></li>
<li><a href="#åç«¯æ¶æ„è¯¦ç»†è®¾è®¡">åç«¯æ¶æ„è¯¦ç»†è®¾è®¡</a></li>
<li><a href="#æ•°æ®æµä¸äº¤äº’æµç¨‹">æ•°æ®æµä¸äº¤äº’æµç¨‹</a></li>
<li><a href="#æ ¸å¿ƒæ¨¡å—æ¶æ„">æ ¸å¿ƒæ¨¡å—æ¶æ„</a></li>
<li><a href="#apiæ¥å£æ¶æ„">APIæ¥å£æ¶æ„</a></li>
<li><a href="#æ•°æ®åº“æ¶æ„">æ•°æ®åº“æ¶æ„</a></li>
<li><a href="#éƒ¨ç½²æ¶æ„">éƒ¨ç½²æ¶æ„</a></li>
<li><a href="#æŠ€æœ¯æ ˆè¯¦è§£">æŠ€æœ¯æ ˆè¯¦è§£</a></li>
</ol>
<hr />
<h2 id="_2">æ•´ä½“æ¶æ„æ¦‚è¿°<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="_3">æ¶æ„æ¨¡å¼<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>GenoCorr å¹³å°é‡‡ç”¨<strong>ä¸‰å±‚å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„</strong>ï¼ˆThree-Tier Client-Server Architectureï¼‰ï¼Œç»“åˆ<strong>RESTful API</strong>é€šä¿¡æ¨¡å¼å’Œ<strong>å‰åç«¯åˆ†ç¦»</strong>çš„è®¾è®¡ç†å¿µã€‚</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è¡¨ç¤ºå±‚ (Presentation Layer)                â”‚
â”‚                    Next.js 15.3.5 Frontend                    â”‚
â”‚                  (React 19.0 + TypeScript)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTP/REST API (JSON)
                     â”‚ Port: 8000
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic Layer)             â”‚
â”‚                   FastAPI 0.68.0 Backend                      â”‚
â”‚                    (Python 3.9+)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                        â”‚              â”‚
        â”‚                        â”‚              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MongoDB      â”‚  â”‚   GProfiler API  â”‚  â”‚  File System     â”‚
â”‚  (æ•°æ®æŒä¹…å±‚)   â”‚  â”‚  (å¤–éƒ¨APIæœåŠ¡)    â”‚  â”‚  (Excel/CSV/TSV) â”‚
â”‚                â”‚  â”‚                  â”‚  â”‚                  â”‚
â”‚ gene_search_db â”‚  â”‚ å¯Œé›†åˆ†ææœåŠ¡      â”‚  â”‚ åç«¯æ•°æ®æ–‡ä»¶      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="_4">æ¶æ„å±‚æ¬¡è¯´æ˜<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>è¡¨ç¤ºå±‚ï¼ˆå‰ç«¯ï¼‰</strong>ï¼šç”¨æˆ·ç•Œé¢å’Œäº¤äº’</li>
<li><strong>ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆåç«¯ï¼‰</strong>ï¼šæ ¸å¿ƒä¸šåŠ¡å¤„ç†å’Œç®—æ³•</li>
<li><strong>æ•°æ®æŒä¹…å±‚</strong>ï¼šæ•°æ®å­˜å‚¨å’Œå¤–éƒ¨æœåŠ¡é›†æˆ</li>
</ol>
<hr />
<h2 id="_5">ä¸‰å±‚æ¶æ„è¯¦è§£<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="frontend-nextjs">ç¬¬ä¸€å±‚ï¼šè¡¨ç¤ºå±‚ï¼ˆFrontend - Next.jsï¼‰<a class="headerlink" href="#frontend-nextjs" title="Permanent link">&para;</a></h3>
<h4 id="_6">æŠ€æœ¯æ ˆ<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>æ¡†æ¶</strong>ï¼šNext.js 15.3.5ï¼ˆåŸºäº React 19.0ï¼‰</li>
<li><strong>è¯­è¨€</strong>ï¼šTypeScript 5.x</li>
<li><strong>æ ·å¼</strong>ï¼šTailwind CSS 4.x</li>
<li><strong>å¯è§†åŒ–</strong>ï¼šPlotly.js 2.35.3</li>
<li><strong>æ„å»ºå·¥å…·</strong>ï¼šTurbopackï¼ˆNext.jså†…ç½®ï¼‰</li>
</ul>
<h4 id="_7">å‰ç«¯ç›®å½•ç»“æ„<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<pre><code>genegen/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ layout.tsx               # æ ¹å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ page.tsx                 # é¦–é¡µ
â”‚   â”œâ”€â”€ globals.css              # å…¨å±€æ ·å¼
â”‚   â”‚
â”‚   â”œâ”€â”€ gene-search/             # æ¨¡å—1ï¼šåŸºå› æœç´¢
â”‚   â”‚   â””â”€â”€ page.tsx            # åŸºå› æœç´¢é¡µé¢ç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ gene-ontology/           # æ¨¡å—2ï¼šä¸»é¢˜åˆ†æ
â”‚   â”‚   â”œâ”€â”€ page.tsx            # ä¸»é¢˜åˆ†æå…¥å£é¡µ
â”‚   â”‚   â”œâ”€â”€ default-theme/      # é»˜è®¤ä¸»é¢˜åˆ†æ
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ customize-theme/    # è‡ªå®šä¹‰ä¸»é¢˜åˆ†æ
â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ ivcca/                   # æ¨¡å—3ï¼šIVCCAåˆ†æ
â”‚   â”‚   â””â”€â”€ page.tsx            # IVCCAåˆ†æé¡µé¢
â”‚   â”‚
â”‚   â”œâ”€â”€ login/                   # è®¤è¯é¡µé¢
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ add-gene/                # æ·»åŠ åŸºå› æ•°æ®ï¼ˆéœ€è®¤è¯ï¼‰
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚
â”‚   â””â”€â”€ upload-csv/              # CSVä¸Šä¼ åŠŸèƒ½
â”‚       â””â”€â”€ page.tsx
â”‚
â”œâ”€â”€ public/                      # é™æ€èµ„æº
â”‚   â””â”€â”€ 885_genes.txt           # ç¤ºä¾‹åŸºå› åˆ—è¡¨
â”‚
â”œâ”€â”€ package.json                 # ä¾èµ–é…ç½®
â”œâ”€â”€ tsconfig.json                # TypeScripté…ç½®
â””â”€â”€ next.config.ts               # Next.jsé…ç½®
</code></pre>
<h4 id="_8">å‰ç«¯ç»„ä»¶æ¶æ„<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<p><strong>1. é¡µé¢ç»„ä»¶ï¼ˆPage Componentsï¼‰</strong></p>
<p>æ¯ä¸ªé¡µé¢éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ React ç»„ä»¶ï¼Œä½¿ç”¨ <code>'use client'</code> æŒ‡ä»¤æ ‡è®°ä¸ºå®¢æˆ·ç«¯ç»„ä»¶ã€‚</p>
<pre><code class="language-typescript">// ç¤ºä¾‹ï¼šåŸºå› æœç´¢é¡µé¢ç»“æ„
export default function GeneSearch() {
  // çŠ¶æ€ç®¡ç†
  const [searchTerm, setSearchTerm] = useState('');
  const [searchResults, setSearchResults] = useState&lt;GeneData[]&gt;([]);
  const [isLoading, setIsLoading] = useState(false);

  // APIè°ƒç”¨
  const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000';

  // äº‹ä»¶å¤„ç†å‡½æ•°
  const handleSearch = async () =&gt; {
    // è°ƒç”¨åç«¯API
    const response = await fetch(`${API_BASE_URL}/api/gene/symbol/search?gene_symbol=${searchTerm}`);
    const data = await response.json();
    setSearchResults(data.data);
  };

  // UIæ¸²æŸ“
  return (
    // JSXç»“æ„
  );
}
</code></pre>
<p><strong>2. çŠ¶æ€ç®¡ç†æ¶æ„</strong></p>
<ul>
<li><strong>æœ¬åœ°çŠ¶æ€</strong>ï¼šä½¿ç”¨ React <code>useState</code> Hook</li>
<li><strong>å…¨å±€çŠ¶æ€</strong>ï¼šé€šè¿‡ Context API æˆ– propsä¼ é€’</li>
<li><strong>APIçŠ¶æ€</strong>ï¼šæ¯æ¬¡APIè°ƒç”¨æ—¶ç‹¬ç«‹ç®¡ç†</li>
<li><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼šæµè§ˆå™¨ localStorageï¼ˆè®¤è¯tokenï¼‰</li>
</ul>
<p><strong>3. æ•°æ®è·å–æµç¨‹</strong></p>
<pre><code>ç”¨æˆ·æ“ä½œ â†’ äº‹ä»¶è§¦å‘ â†’ APIè°ƒç”¨ â†’ çŠ¶æ€æ›´æ–° â†’ UIé‡æ¸²æŸ“
</code></pre>
<h4 id="-">å‰ç«¯-åç«¯é€šä¿¡<a class="headerlink" href="#-" title="Permanent link">&para;</a></h4>
<p><strong>é€šä¿¡åè®®</strong>ï¼š<br />
- <strong>åè®®</strong>ï¼šHTTP/HTTPS<br />
- <strong>æ•°æ®æ ¼å¼</strong>ï¼šJSON<br />
- <strong>æ–¹æ³•</strong>ï¼šGET, POST<br />
- <strong>è®¤è¯</strong>ï¼šToken-basedï¼ˆå­˜å‚¨åœ¨localStorageï¼‰</p>
<p><strong>APIè°ƒç”¨æ¨¡å¼</strong>ï¼š</p>
<pre><code class="language-typescript">// æ ‡å‡†APIè°ƒç”¨æ¨¡å¼
const response = await fetch(`${API_BASE_URL}/api/endpoint`, {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify(requestData),
});

const data = await response.json();
</code></pre>
<p><strong>é”™è¯¯å¤„ç†</strong>ï¼š<br />
- Try-catch æ•è·ç½‘ç»œé”™è¯¯<br />
- HTTPçŠ¶æ€ç æ£€æŸ¥<br />
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º</p>
<h3 id="backend-fastapi">ç¬¬äºŒå±‚ï¼šä¸šåŠ¡é€»è¾‘å±‚ï¼ˆBackend - FastAPIï¼‰<a class="headerlink" href="#backend-fastapi" title="Permanent link">&para;</a></h3>
<h4 id="_9">æŠ€æœ¯æ ˆ<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>æ¡†æ¶</strong>ï¼šFastAPI 0.68.0</li>
<li><strong>è¯­è¨€</strong>ï¼šPython 3.9+</li>
<li><strong>æ•°æ®ç§‘å­¦åº“</strong>ï¼š</li>
<li>pandasï¼šæ•°æ®å¤„ç†</li>
<li>NumPyï¼šæ•°å€¼è®¡ç®—</li>
<li>SciPyï¼šç§‘å­¦è®¡ç®—</li>
<li>scikit-learnï¼šæœºå™¨å­¦ä¹ </li>
<li><strong>å¯è§†åŒ–</strong>ï¼šmatplotlib, seaborn</li>
<li><strong>å¤–éƒ¨æœåŠ¡</strong>ï¼šGProfiler Pythonå®¢æˆ·ç«¯</li>
</ul>
<h4 id="_10">åç«¯ç›®å½•ç»“æ„<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<pre><code>backend/
â”œâ”€â”€ server.py                    # FastAPIä¸»åº”ç”¨ï¼ˆ1900+è¡Œï¼‰
â”œâ”€â”€ ivcca_core.py               # IVCCAæ ¸å¿ƒç®—æ³•æ¨¡å—ï¼ˆ2200+è¡Œï¼‰
â”œâ”€â”€ start_backend.py            # åç«¯å¯åŠ¨è„šæœ¬
â”œâ”€â”€ requirements.txt            # Pythonä¾èµ–
â”‚
â”œâ”€â”€ data/                       # æ•°æ®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ BoneMarrow.xlsx
â”‚   â”œâ”€â”€ Cortex.xlsx
â”‚   â”œâ”€â”€ DRG.xlsx
â”‚   â”œâ”€â”€ Fat.xlsx
â”‚   â”œâ”€â”€ Heart.xlsx
â”‚   â”œâ”€â”€ Hypothalamus.xlsx
â”‚   â”œâ”€â”€ Kidneys.xlsx
â”‚   â”œâ”€â”€ Liver.xlsx
â”‚   â””â”€â”€ Muscle.xlsx
â”‚
â””â”€â”€ .env                        # ç¯å¢ƒå˜é‡é…ç½®
</code></pre>
<h4 id="_11">åç«¯åº”ç”¨æ¶æ„<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<p><strong>1. FastAPI åº”ç”¨åˆå§‹åŒ–</strong></p>
<pre><code class="language-python"># server.py
app = FastAPI(title=&quot;Gene Expression Search API&quot;, version=&quot;1.0.0&quot;)

# CORSä¸­é—´ä»¶é…ç½®
app.add_middleware(
    CORSMiddleware,
    allow_origins=[&quot;*&quot;],
    allow_credentials=True,
    allow_methods=[&quot;*&quot;],
    allow_headers=[&quot;*&quot;],
)
</code></pre>
<p><strong>2. APIç±»ç»„ç»‡</strong></p>
<pre><code class="language-python"># ä¸‰ä¸ªä¸»è¦APIç±»
class GeneSearchAPI:
    &quot;&quot;&quot;åŸºå› æœç´¢APIç±»&quot;&quot;&quot;
    - load_data_to_mongodb()
    - search_gene_data()
    - create_fold_change_plot()
    # ...

class GeneOntologyAPI:
    &quot;&quot;&quot;åŸºå› æœ¬ä½“åˆ†æAPIç±»&quot;&quot;&quot;
    - enrich()
    - assign_theme()
    - aggregate()
    - create_theme_chart()
    # ...

# IVCCAåŠŸèƒ½é€šè¿‡ ivcca_core.py ä¸­çš„ç±»å®ç°
# åœ¨ server.py ä¸­ç›´æ¥ä½¿ç”¨ IVCCAAnalyzer ç±»
</code></pre>
<p><strong>3. è¯·æ±‚å¤„ç†æµç¨‹</strong></p>
<pre><code>HTTPè¯·æ±‚ â†’ FastAPIè·¯ç”± â†’ PydanticéªŒè¯ â†’ ä¸šåŠ¡é€»è¾‘ â†’ æ•°æ®å¤„ç† â†’ å“åº”è¿”å›
</code></pre>
<h4 id="api">APIç«¯ç‚¹ç»„ç»‡<a class="headerlink" href="#api" title="Permanent link">&para;</a></h4>
<p><strong>ç«¯ç‚¹åˆ†ç±»</strong>ï¼š</p>
<ol>
<li><strong>è®¤è¯ç«¯ç‚¹</strong>ï¼š</li>
<li>
<p><code>POST /api/auth/login</code> - Tokenè®¤è¯</p>
</li>
<li>
<p><strong>åŸºå› æœç´¢ç«¯ç‚¹</strong>ï¼ˆ7ä¸ªï¼‰ï¼š</p>
</li>
<li><code>GET /api/gene/symbols</code> - è·å–æ‰€æœ‰åŸºå› ç¬¦å·</li>
<li><code>GET /api/gene/symbol/search</code> - æœç´¢åŸºå› </li>
<li><code>GET /api/gene/symbol/showFoldChange</code> - Fold Changeå›¾</li>
<li><code>GET /api/gene/symbol/showLSMeanControl</code> - å¯¹ç…§ç»„å›¾</li>
<li><code>GET /api/gene/symbol/showLSMeanTenMgKg</code> - å¤„ç†ç»„å›¾</li>
<li>
<p><code>POST /api/gene/add</code> - æ·»åŠ åŸºå› ï¼ˆéœ€è®¤è¯ï¼‰</p>
</li>
<li>
<p><strong>ä¸»é¢˜åˆ†æç«¯ç‚¹</strong>ï¼ˆ4ä¸ªï¼‰ï¼š</p>
</li>
<li><code>POST /api/ontology/analyze</code> - æ ‡å‡†å¯Œé›†åˆ†æ</li>
<li><code>POST /api/ontology/custom-analyze</code> - è‡ªå®šä¹‰ä¸»é¢˜åˆ†æ</li>
<li><code>POST /api/ontology/theme-chart</code> - ä¸»é¢˜è¯¦ç»†å›¾</li>
<li>
<p><code>POST /api/ontology/custom-summary-chart</code> - ä¸»é¢˜æ±‡æ€»å›¾</p>
</li>
<li>
<p><strong>IVCCAåˆ†æç«¯ç‚¹</strong>ï¼ˆ14ä¸ªï¼‰ï¼š</p>
</li>
<li><code>POST /api/ivcca/load-data</code> - åŠ è½½æ•°æ®</li>
<li><code>POST /api/ivcca/calculate-correlation</code> - è®¡ç®—ç›¸å…³æ€§</li>
<li><code>POST /api/ivcca/sort-matrix</code> - æ’åºçŸ©é˜µ</li>
<li><code>POST /api/ivcca/heatmap</code> - çƒ­å›¾</li>
<li><code>POST /api/ivcca/histogram</code> - ç›´æ–¹å›¾</li>
<li><code>POST /api/ivcca/optimal-clusters</code> - æœ€ä¼˜èšç±»æ•°</li>
<li><code>POST /api/ivcca/dendrogram</code> - ç³»ç»Ÿæ ‘å›¾</li>
<li><code>POST /api/ivcca/pca</code> - PCAåˆ†æ</li>
<li><code>POST /api/ivcca/tsne</code> - t-SNEåˆ†æ</li>
<li><code>POST /api/ivcca/single-pathway</code> - å•é€šè·¯åˆ†æ</li>
<li><code>POST /api/ivcca/compare-pathways</code> - é€šè·¯æ¯”è¾ƒ</li>
<li><code>POST /api/ivcca/gene-to-genes</code> - åŸºå› åˆ°åŸºå› </li>
<li><code>POST /api/ivcca/gene-to-pathways</code> - åŸºå› åˆ°é€šè·¯</li>
<li><code>POST /api/ivcca/multi-pathway</code> - å¤šé€šè·¯åˆ†æ</li>
<li><code>POST /api/ivcca/venn-diagram</code> - Vennå›¾</li>
<li>
<p><code>POST /api/ivcca/network-analysis</code> - ç½‘ç»œåˆ†æ</p>
</li>
<li>
<p><strong>å·¥å…·ç«¯ç‚¹</strong>ï¼š</p>
</li>
<li><code>GET /api/health</code> - å¥åº·æ£€æŸ¥</li>
<li><code>GET /api/test</code> - æµ‹è¯•ç«¯ç‚¹</li>
<li><code>GET /docs</code> - APIæ–‡æ¡£ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰</li>
</ol>
<p><strong>æ€»è®¡</strong>ï¼šçº¦ 40+ APIç«¯ç‚¹</p>
<h3 id="_12">ç¬¬ä¸‰å±‚ï¼šæ•°æ®æŒä¹…å±‚<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<h4 id="mongodb">MongoDB æ•°æ®åº“<a class="headerlink" href="#mongodb" title="Permanent link">&para;</a></h4>
<p><strong>è¿æ¥ç®¡ç†</strong>ï¼š</p>
<pre><code class="language-python"># è¿æ¥é…ç½®
MONGODB_URI = os.getenv('MONGODB_URI')
client = MongoClient(MONGODB_URI)
db = client.gene_search_db
collection = db.gene_data
</code></pre>
<p><strong>æ•°æ®æ¨¡å‹</strong>ï¼š</p>
<pre><code class="language-python"># æ–‡æ¡£ç»“æ„
{
    '_id': ObjectId,                    # MongoDBè‡ªåŠ¨ç”Ÿæˆ
    'organ': 'Heart',                   # ç»„ç»‡åç§°ï¼ˆ9ç§ï¼‰
    'gene_symbol': 'GAPDH',            # åŸºå› ç¬¦å·ï¼ˆç´¢å¼•å­—æ®µï¼‰
    'gene_name': 'Glyceraldehyde-3-phosphate dehydrogenase',
    'p_value_10_mgkg_vs_control': '0.001',
    'fdr_step_up_10_mgkg_vs_control': '0.05',
    'ratio_10_mgkg_vs_control': '1.5',
    'fold_change_10_mgkg_vs_control': '0.5',
    'lsmean_10mgkg_10_mgkg_vs_control': '10.5',
    'lsmean_control_10_mgkg_vs_control': '8.5'
}
</code></pre>
<p><strong>ç´¢å¼•è®¾è®¡</strong>ï¼š</p>
<pre><code class="language-python"># å•å­—æ®µç´¢å¼•ï¼ˆåŠ é€ŸæŸ¥è¯¢ï¼‰
collection.create_index([(&quot;gene_symbol&quot;, 1)])      # å‡åºç´¢å¼•
collection.create_index([(&quot;organ&quot;, 1)])

# å¤åˆå”¯ä¸€ç´¢å¼•ï¼ˆé˜²æ­¢é‡å¤ï¼‰
collection.create_index(
    [(&quot;organ&quot;, 1), (&quot;gene_symbol&quot;, 1)], 
    unique=True
)
</code></pre>
<h4 id="api_1">å¤–éƒ¨APIæœåŠ¡<a class="headerlink" href="#api_1" title="Permanent link">&para;</a></h4>
<p><strong>GProfiler API</strong>ï¼š</p>
<pre><code class="language-python"># åˆå§‹åŒ–
from gprofiler import GProfiler
gp = GProfiler(return_dataframe=True)

# å¯Œé›†åˆ†æè°ƒç”¨
df = gp.profile(
    organism=&quot;mmusculus&quot;,  # å°é¼ 
    query=genes_list       # åŸºå› åˆ—è¡¨
)
</code></pre>
<h4 id="_13">æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Excelæ–‡ä»¶</strong>ï¼š<code>backend/data/*.xlsx</code>ï¼ˆ9ä¸ªç»„ç»‡ï¼‰</li>
<li><strong>åŸºå› åˆ—è¡¨</strong>ï¼š<code>.txt</code>æ–‡ä»¶ï¼ˆé€šè·¯å®šä¹‰ã€åŸºå› åˆ—è¡¨ï¼‰</li>
<li><strong>ç”Ÿæˆçš„å›¾è¡¨</strong>ï¼šä¸´æ—¶å­˜å‚¨åœ¨å†…å­˜ï¼Œä»¥base64ç¼–ç è¿”å›</li>
</ul>
<hr />
<h2 id="_14">å‰ç«¯æ¶æ„è¯¦ç»†è®¾è®¡<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h2>
<h3 id="_15">ç»„ä»¶å±‚æ¬¡ç»“æ„<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<pre><code>RootLayout (layout.tsx)
â”œâ”€â”€ Navigation/Header (å„é¡µé¢å†…åµŒ)
â”œâ”€â”€ Page Components
â”‚   â”œâ”€â”€ GeneSearch (gene-search/page.tsx)
â”‚   â”‚   â”œâ”€â”€ SearchInput Component
â”‚   â”‚   â”œâ”€â”€ GeneList Component
â”‚   â”‚   â”œâ”€â”€ ResultsTable Component
â”‚   â”‚   â””â”€â”€ PlotDisplay Component
â”‚   â”‚
â”‚   â”œâ”€â”€ ThemeAnalysis (gene-ontology/*/page.tsx)
â”‚   â”‚   â”œâ”€â”€ FileUpload Component
â”‚   â”‚   â”œâ”€â”€ ThemeSelector Component
â”‚   â”‚   â”œâ”€â”€ ResultsDisplay Component
â”‚   â”‚   â””â”€â”€ ChartDisplay Component
â”‚   â”‚
â”‚   â””â”€â”€ IVCCA (ivcca/page.tsx)
â”‚       â”œâ”€â”€ DataUpload Component
â”‚       â”œâ”€â”€ AnalysisControls Component
â”‚       â”œâ”€â”€ CorrelationMatrix Component
â”‚       â”œâ”€â”€ VisualizationPanel Component
â”‚       â””â”€â”€ ResultsPanel Component
â””â”€â”€ Footer (å„é¡µé¢å†…åµŒ)
</code></pre>
<h3 id="_16">æ•°æ®æµï¼ˆå‰ç«¯è§†è§’ï¼‰<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p><strong>1. ç”¨æˆ·è¾“å…¥æµç¨‹</strong></p>
<pre><code>ç”¨æˆ·è¾“å…¥ â†’ çŠ¶æ€æ›´æ–°ï¼ˆuseStateï¼‰â†’ äº‹ä»¶å¤„ç†å‡½æ•° â†’ APIè°ƒç”¨ â†’ å“åº”å¤„ç† â†’ çŠ¶æ€æ›´æ–° â†’ UIæ›´æ–°
</code></pre>
<p><strong>2. APIè°ƒç”¨æµç¨‹</strong></p>
<pre><code class="language-typescript">// æ ‡å‡†æµç¨‹
async function handleApiCall() {
  setIsLoading(true);                    // 1. è®¾ç½®åŠ è½½çŠ¶æ€
  setError('');                          // 2. æ¸…é™¤é”™è¯¯

  try {
    const response = await fetch(...);    // 3. å‘èµ·è¯·æ±‚
    if (!response.ok) {                   // 4. æ£€æŸ¥å“åº”çŠ¶æ€
      throw new Error(...);
    }
    const data = await response.json();   // 5. è§£æJSON
    setResults(data);                     // 6. æ›´æ–°çŠ¶æ€
  } catch (error) {
    setError(error.message);              // 7. é”™è¯¯å¤„ç†
  } finally {
    setIsLoading(false);                  // 8. æ¸…é™¤åŠ è½½çŠ¶æ€
  }
}
</code></pre>
<p><strong>3. å¯è§†åŒ–æ•°æ®æµ</strong></p>
<pre><code class="language-typescript">// Plotlyå›¾è¡¨æ•°æ®æµ
APIè¿”å›æ•°æ® â†’ æ•°æ®è½¬æ¢ â†’ Plotly JSONé…ç½® â†’ React Plotlyç»„ä»¶ â†’ äº¤äº’å¼å›¾è¡¨

// é™æ€å›¾ç‰‡æ•°æ®æµ
APIè¿”å›base64 â†’ &lt;img src={`data:image/png;base64,${image}`} /&gt; â†’ æ˜¾ç¤ºå›¾ç‰‡
</code></pre>
<h3 id="_17">çŠ¶æ€ç®¡ç†æ¶æ„<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p><strong>æœ¬åœ°çŠ¶æ€ï¼ˆComponent Stateï¼‰</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>useState</code> Hookç®¡ç†ç»„ä»¶çº§çŠ¶æ€</li>
<li>æ¯ä¸ªé¡µé¢ç»„ä»¶ç‹¬ç«‹ç®¡ç†è‡ªå·±çš„çŠ¶æ€</li>
<li>çŠ¶æ€ç±»å‹ï¼š</li>
<li>ç”¨æˆ·è¾“å…¥ï¼ˆè¡¨å•æ•°æ®ï¼‰</li>
<li>APIå“åº”æ•°æ®</li>
<li>UIçŠ¶æ€ï¼ˆåŠ è½½ã€é”™è¯¯ã€å±•å¼€/æŠ˜å ï¼‰</li>
<li>å¯è§†åŒ–é…ç½®ï¼ˆå›¾è¡¨ç±»å‹ã€å‚æ•°ï¼‰</li>
</ul>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="language-typescript">// åŸºå› æœç´¢é¡µé¢çŠ¶æ€
const [searchTerm, setSearchTerm] = useState('');
const [searchResults, setSearchResults] = useState&lt;GeneData[]&gt;([]);
const [isLoading, setIsLoading] = useState(false);
const [error, setError] = useState('');
const [currentPlot, setCurrentPlot] = useState('');
</code></pre>
<p><strong>å…¨å±€çŠ¶æ€ï¼ˆApp Stateï¼‰</strong>ï¼š</p>
<ul>
<li>API URLï¼šé€šè¿‡ç¯å¢ƒå˜é‡ <code>NEXT_PUBLIC_API_URL</code></li>
<li>è®¤è¯Tokenï¼šå­˜å‚¨åœ¨ <code>localStorage</code></li>
<li>æ— å…¨å±€çŠ¶æ€ç®¡ç†åº“ï¼ˆRedux/Zustandï¼‰ï¼Œä¿æŒç®€å•</li>
</ul>
<h3 id="nextjs-app-router">è·¯ç”±æ¶æ„ï¼ˆNext.js App Routerï¼‰<a class="headerlink" href="#nextjs-app-router" title="Permanent link">&para;</a></h3>
<p><strong>æ–‡ä»¶ç³»ç»Ÿè·¯ç”±</strong>ï¼š</p>
<pre><code>app/
â”œâ”€â”€ page.tsx                 â†’ /
â”œâ”€â”€ gene-search/
â”‚   â””â”€â”€ page.tsx            â†’ /gene-search
â”œâ”€â”€ gene-ontology/
â”‚   â”œâ”€â”€ page.tsx            â†’ /gene-ontology
â”‚   â”œâ”€â”€ default-theme/
â”‚   â”‚   â””â”€â”€ page.tsx        â†’ /gene-ontology/default-theme
â”‚   â””â”€â”€ customize-theme/
â”‚       â””â”€â”€ page.tsx        â†’ /gene-ontology/customize-theme
â””â”€â”€ ivcca/
    â””â”€â”€ page.tsx            â†’ /ivcca
</code></pre>
<p><strong>å¯¼èˆªå®ç°</strong>ï¼š</p>
<pre><code class="language-typescript">// ä½¿ç”¨ Next.js Link ç»„ä»¶
import Link from 'next/link';

&lt;Link href=&quot;/gene-search&quot;&gt;åŸºå› æœç´¢&lt;/Link&gt;
&lt;Link href=&quot;/gene-ontology&quot;&gt;ä¸»é¢˜åˆ†æ&lt;/Link&gt;
&lt;Link href=&quot;/ivcca&quot;&gt;IVCCAåˆ†æ&lt;/Link&gt;
</code></pre>
<hr />
<h2 id="_18">åç«¯æ¶æ„è¯¦ç»†è®¾è®¡<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h2>
<h3 id="fastapi">FastAPI åº”ç”¨ç»“æ„<a class="headerlink" href="#fastapi" title="Permanent link">&para;</a></h3>
<h4 id="1">1. åº”ç”¨åˆå§‹åŒ–æµç¨‹<a class="headerlink" href="#1" title="Permanent link">&para;</a></h4>
<pre><code class="language-python"># Step 1: å¯¼å…¥ä¾èµ–
from fastapi import FastAPI, HTTPException, ...
from ivcca_core import IVCCAAnalyzer

# Step 2: åŠ è½½ç¯å¢ƒå˜é‡
load_dotenv(env_path)

# Step 3: è¿æ¥MongoDB
client = MongoClient(MONGODB_URI)
db = client.gene_search_db
collection = db.gene_data

# Step 4: åˆå§‹åŒ–APIç±»
gene_api = GeneSearchAPI()        # è‡ªåŠ¨åŠ è½½æ•°æ®åˆ°MongoDB
ontology_api = GeneOntologyAPI()  # åˆå§‹åŒ–GProfilerå®¢æˆ·ç«¯

# Step 5: åˆ›å»ºFastAPIåº”ç”¨
app = FastAPI(title=&quot;...&quot;, version=&quot;1.0.0&quot;)

# Step 6: é…ç½®ä¸­é—´ä»¶
app.add_middleware(CORSMiddleware, ...)

# Step 7: å®šä¹‰è·¯ç”±ç«¯ç‚¹
@app.get(&quot;/api/...&quot;)
async def endpoint(...):
    ...
</code></pre>
<h4 id="2">2. è¯·æ±‚å¤„ç†æµç¨‹ï¼ˆè¯¦ç»†æ­¥éª¤ï¼‰<a class="headerlink" href="#2" title="Permanent link">&para;</a></h4>
<p><strong>æ­¥éª¤1ï¼šHTTPè¯·æ±‚æ¥æ”¶</strong></p>
<pre><code>å®¢æˆ·ç«¯ â†’ HTTPè¯·æ±‚ â†’ FastAPI ASGIæœåŠ¡å™¨ â†’ è·¯ç”±åŒ¹é…
</code></pre>
<p><strong>æ­¥éª¤2ï¼šè¯·æ±‚éªŒè¯</strong></p>
<pre><code class="language-python"># FastAPIè‡ªåŠ¨éªŒè¯ï¼ˆåŸºäºPydanticæ¨¡å‹ï¼‰
@app.get(&quot;/api/gene/symbol/search&quot;)
async def search_gene_symbol(
    gene_symbol: str = Query(..., description=&quot;...&quot;)  # è‡ªåŠ¨éªŒè¯å‚æ•°
):
    # å¦‚æœéªŒè¯å¤±è´¥ï¼Œè‡ªåŠ¨è¿”å›422é”™è¯¯
</code></pre>
<p><strong>æ­¥éª¤3ï¼šä¸šåŠ¡é€»è¾‘å¤„ç†</strong></p>
<pre><code class="language-python"># è°ƒç”¨ç›¸åº”çš„APIç±»æ–¹æ³•
results = gene_api.search_gene_data(gene_symbol)
</code></pre>
<p><strong>æ­¥éª¤4ï¼šå“åº”ç”Ÿæˆ</strong></p>
<pre><code class="language-python"># è¿”å›JSONå“åº”ï¼ˆFastAPIè‡ªåŠ¨åºåˆ—åŒ–ï¼‰
return {&quot;gene_symbol&quot;: gene_symbol, &quot;data&quot;: results}
</code></pre>
<p><strong>æ­¥éª¤5ï¼šé”™è¯¯å¤„ç†</strong></p>
<pre><code class="language-python">try:
    # ä¸šåŠ¡é€»è¾‘
except Exception as e:
    raise HTTPException(status_code=500, detail=str(e))
</code></pre>
<h4 id="3-api">3. APIç±»è¯¦ç»†è®¾è®¡<a class="headerlink" href="#3-api" title="Permanent link">&para;</a></h4>
<p><strong>GeneSearchAPI ç±»</strong>ï¼š</p>
<pre><code class="language-python">class GeneSearchAPI:
    def __init__(self):
        # åˆå§‹åŒ–æ—¶æ‰§è¡Œ
        self.load_data_to_mongodb()  # åŠ è½½æ•°æ®åˆ°MongoDB
        self.all_genes = self.load_all_genes()  # åŠ è½½æ‰€æœ‰åŸºå› ç¬¦å·

    # æ•°æ®åŠ è½½æµç¨‹
    def load_data_to_mongodb(self):
        &quot;&quot;&quot;
        æ­¥éª¤1: æ‰«ædataç›®å½•ä¸‹çš„Excelæ–‡ä»¶
        æ­¥éª¤2: å¯¹æ¯ä¸ªæ–‡ä»¶ï¼š
            - è¯»å–Excel (pandas.read_excel)
            - æå–ç»„ç»‡åç§°ï¼ˆæ–‡ä»¶åï¼‰
            - éå†æ¯ä¸€è¡Œï¼š
                - æå–åŸºå› ç¬¦å·å’Œè¡¨è¾¾æ•°æ®
                - æ„å»ºMongoDBæ–‡æ¡£
                - æ·»åŠ åˆ°æ‰¹é‡æ“ä½œåˆ—è¡¨
        æ­¥éª¤3: æ‰§è¡Œæ‰¹é‡å†™å…¥ï¼ˆbulk_write with upsertï¼‰
        æ­¥éª¤4: åˆ›å»ºç´¢å¼•
        &quot;&quot;&quot;
        pass

    # æœç´¢æµç¨‹
    def search_gene_data(self, gene_symbol: str):
        &quot;&quot;&quot;
        æ­¥éª¤1: æ„å»ºæŸ¥è¯¢ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¤§å°å†™ä¸æ•æ„Ÿï¼‰
        æ­¥éª¤2: æ‰§è¡ŒMongoDBæŸ¥è¯¢ï¼ˆä½¿ç”¨ç´¢å¼•ï¼‰
        æ­¥éª¤3: éå†æŸ¥è¯¢ç»“æœ
        æ­¥éª¤4: æ ¼å¼åŒ–ä¸ºå“åº”æ ¼å¼
        æ­¥éª¤5: è¿”å›ç»“æœåˆ—è¡¨
        &quot;&quot;&quot;
        pass

    # å¯è§†åŒ–ç”Ÿæˆæµç¨‹
    def create_fold_change_plot(self, gene_symbol: str):
        &quot;&quot;&quot;
        æ­¥éª¤1: æŸ¥è¯¢åŸºå› æ•°æ®ï¼ˆè°ƒç”¨search_gene_dataï¼‰
        æ­¥éª¤2: æå–ç»„ç»‡å’ŒFold Changeå€¼
        æ­¥éª¤3: ä½¿ç”¨matplotlibåˆ›å»ºå›¾è¡¨
        æ­¥éª¤4: è½¬æ¢ä¸ºbase64ç¼–ç 
        æ­¥éª¤5: è¿”å›base64å­—ç¬¦ä¸²
        &quot;&quot;&quot;
        pass
</code></pre>
<p><strong>GeneOntologyAPI ç±»</strong>ï¼š</p>
<pre><code class="language-python">class GeneOntologyAPI:
    def __init__(self):
        # åˆå§‹åŒ–GProfilerå®¢æˆ·ç«¯
        self.gp = GProfiler(return_dataframe=True)
        # å®šä¹‰ä¸»é¢˜å…³é”®è¯æ˜ å°„
        self.themes = {
            'Inflammation &amp; immune signaling': ['inflammatory', ...],
            # ...
        }

    # å¯Œé›†åˆ†ææµç¨‹
    def enrich(self, genes: List[str]):
        &quot;&quot;&quot;
        æ­¥éª¤1: è°ƒç”¨GProfiler API
            df = self.gp.profile(organism=&quot;mmusculus&quot;, query=genes)
        æ­¥éª¤2: è¿‡æ»¤På€¼ï¼ˆp &lt; 0.01ï¼‰
        æ­¥éª¤3: è®¡ç®—Score = -log10(p_value)
        æ­¥éª¤4: è¿”å›DataFrame
        &quot;&quot;&quot;
        pass

    # ä¸»é¢˜åˆ†é…æµç¨‹
    def assign_theme(self, go_term_name: str):
        &quot;&quot;&quot;
        æ­¥éª¤1: å°†GOæœ¯è¯­åç§°è½¬ä¸ºå°å†™
        æ­¥éª¤2: éå†æ‰€æœ‰ä¸»é¢˜çš„å…³é”®è¯
        æ­¥éª¤3: æ£€æŸ¥å…³é”®è¯æ˜¯å¦åœ¨GOæœ¯è¯­åç§°ä¸­
        æ­¥éª¤4: è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä¸»é¢˜
        &quot;&quot;&quot;
        pass

    # ä¸»é¢˜èšåˆæµç¨‹
    def aggregate(self, df: pd.DataFrame):
        &quot;&quot;&quot;
        æ­¥éª¤1: ä¸ºæ¯ä¸ªGOæœ¯è¯­åˆ†é…ä¸»é¢˜ï¼ˆapply assign_themeï¼‰
        æ­¥éª¤2: è¿‡æ»¤æ‰æ— ä¸»é¢˜çš„GOæœ¯è¯­
        æ­¥éª¤3: æŒ‰ä¸»é¢˜åˆ†ç»„
        æ­¥éª¤4: èšåˆè®¡ç®—ï¼š
            - Score: ç´¯ç§¯åˆ†æ•°ï¼ˆsumï¼‰
            - Terms: æœ¯è¯­æ•°é‡ï¼ˆcountï¼‰
        æ­¥éª¤5: æŒ‰Scoreé™åºæ’åº
        &quot;&quot;&quot;
        pass
</code></pre>
<h4 id="4-ivcca">4. IVCCAæ ¸å¿ƒæ¨¡å—æ¶æ„<a class="headerlink" href="#4-ivcca" title="Permanent link">&para;</a></h4>
<p><strong>IVCCAAnalyzer ç±»ç»“æ„</strong>ï¼š</p>
<pre><code class="language-python">class IVCCAAnalyzer:
    def __init__(self):
        # æ•°æ®çŠ¶æ€
        self.data = None              # åŸå§‹æ•°æ®çŸ©é˜µ (samples Ã— genes)
        self.gene_names = None        # åŸºå› åç§°åˆ—è¡¨
        self.sample_names = None      # æ ·æœ¬åç§°åˆ—è¡¨
        self.correlation_matrix = None # ç›¸å…³æ€§çŸ©é˜µ (genes Ã— genes)

        # çŠ¶æ€æ ‡å¿—
        self.data_loaded = False
        self.correlation_calculated = False

    # æ•°æ®åŠ è½½æµç¨‹
    def load_data(self, file_path: str):
        &quot;&quot;&quot;
        æ­¥éª¤1: æ£€æµ‹æ–‡ä»¶ç±»å‹ï¼ˆ.xlsx, .csv, .tsvï¼‰
        æ­¥éª¤2: ä½¿ç”¨pandasè¯»å–æ–‡ä»¶
        æ­¥éª¤3: æå–æ ·æœ¬åç§°ï¼ˆç¬¬ä¸€åˆ—ï¼‰
        æ­¥éª¤4: æå–åŸºå› åç§°ï¼ˆé™¤ç¬¬ä¸€åˆ—å¤–çš„æ‰€æœ‰åˆ—ï¼‰
        æ­¥éª¤5: æå–æ•°å€¼æ•°æ®ï¼ˆè½¬æ¢ä¸ºnumpyæ•°ç»„ï¼‰
        æ­¥éª¤6: å¤„ç†ç¼ºå¤±å€¼ï¼ˆNaNï¼‰
        æ­¥éª¤7: è®¾ç½®çŠ¶æ€æ ‡å¿—
        &quot;&quot;&quot;
        pass

    # ç›¸å…³æ€§è®¡ç®—æµç¨‹
    def calculate_correlations(self, method: str = 'pearson'):
        &quot;&quot;&quot;
        æ­¥éª¤1: æ£€æŸ¥æ•°æ®æ˜¯å¦å·²åŠ è½½
        æ­¥éª¤2: å°†æ•°æ®è½¬æ¢ä¸ºDataFrame
        æ­¥éª¤3: è°ƒç”¨pandas.corr()æ–¹æ³•ï¼ˆæ ¹æ®methodå‚æ•°ï¼‰
        æ­¥éª¤4: å¤„ç†NaNå€¼ï¼ˆæ›¿æ¢ä¸º0ï¼‰
        æ­¥éª¤5: è®¡ç®—ç»Ÿè®¡ä¿¡æ¯ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ç­‰ï¼‰
        æ­¥éª¤6: è®¾ç½®çŠ¶æ€æ ‡å¿—
        &quot;&quot;&quot;
        pass

    # æ’åºæµç¨‹
    def sort_correlation_matrix(self):
        &quot;&quot;&quot;
        æ­¥éª¤1: è®¡ç®—æ¯ä¸ªåŸºå› çš„å¹³å‡ç»å¯¹ç›¸å…³æ€§
            Q_i = mean(|r_ij|) for j â‰  i
        æ­¥éª¤2: æŒ‰Q_ié™åºæ’åºï¼Œå¾—åˆ°æ’åºç´¢å¼•
        æ­¥éª¤3: ä½¿ç”¨æ’åºç´¢å¼•é‡æ–°æ’åˆ—ï¼š
            - ç›¸å…³æ€§çŸ©é˜µ
            - åŸºå› åç§°åˆ—è¡¨
        æ­¥éª¤4: è¿”å›æ’åºåçš„çŸ©é˜µå’ŒåŸºå› åç§°
        &quot;&quot;&quot;
        pass
</code></pre>
<hr />
<h2 id="_19">æ•°æ®æµä¸äº¤äº’æµç¨‹<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h2>
<h3 id="-_1">å®Œæ•´è¯·æ±‚-å“åº”æµç¨‹<a class="headerlink" href="#-_1" title="Permanent link">&para;</a></h3>
<h4 id="1_1">æµç¨‹1ï¼šåŸºå› æœç´¢å®Œæ•´æµç¨‹<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·     â”‚
â”‚ (æµè§ˆå™¨)  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ 1. è¾“å…¥åŸºå› ç¬¦å·&quot;GAPDH&quot;
     â”‚ 2. ç‚¹å‡»&quot;æœç´¢&quot;æŒ‰é’®
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: gene-search/page.tsx          â”‚
â”‚                                      â”‚
â”‚ handleSearch() å‡½æ•°ï¼š                â”‚
â”‚ 1. setIsLoading(true)               â”‚
â”‚ 2. æ„å»ºAPI URL                       â”‚
â”‚ 3. fetch(`${API_URL}/api/gene/      â”‚
â”‚          symbol/search?gene_symbol=  â”‚
â”‚          GAPDH`)                     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 3. HTTP GET è¯·æ±‚
     â”‚    URL: /api/gene/symbol/search?gene_symbol=GAPDH
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPI è·¯ç”±å¤„ç†                     â”‚
â”‚ @app.get(&quot;/api/gene/symbol/search&quot;) â”‚
â”‚                                      â”‚
â”‚ 1. æ¥æ”¶æŸ¥è¯¢å‚æ•° gene_symbol          â”‚
â”‚ 2. PydanticéªŒè¯ï¼ˆè‡ªåŠ¨ï¼‰              â”‚
â”‚ 3. è°ƒç”¨ gene_api.search_gene_data() â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GeneSearchAPI.search_gene_data()    â”‚
â”‚                                      â”‚
â”‚ 1. æ„å»ºMongoDBæŸ¥è¯¢ï¼š                 â”‚
â”‚    query = {&quot;gene_symbol&quot;: {        â”‚
â”‚        &quot;$regex&quot;: &quot;^GAPDH$&quot;,         â”‚
â”‚        &quot;$options&quot;: &quot;i&quot;              â”‚
â”‚    }}                                â”‚
â”‚ 2. collection.find(query)           â”‚
â”‚    ï¼ˆä½¿ç”¨gene_symbolç´¢å¼•ï¼ŒO(log n)ï¼‰ â”‚
â”‚ 3. éå†æŸ¥è¯¢ç»“æœ                      â”‚
â”‚ 4. æ ¼å¼åŒ–æ•°æ®                        â”‚
â”‚ 5. è¿”å›åˆ—è¡¨                          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MongoDB æ•°æ®åº“                       â”‚
â”‚                                      â”‚
â”‚ 1. ä½¿ç”¨ç´¢å¼•å¿«é€ŸæŸ¥æ‰¾                  â”‚
â”‚ 2. è¿”å›åŒ¹é…çš„æ–‡æ¡£åˆ—è¡¨                â”‚
â”‚    [                                â”‚
â”‚      {organ: &quot;Heart&quot;, gene_symbol:  â”‚
â”‚       &quot;GAPDH&quot;, ...},                â”‚
â”‚      {organ: &quot;Liver&quot;, gene_symbol:  â”‚
â”‚       &quot;GAPDH&quot;, ...},                â”‚
â”‚      ...                            â”‚
â”‚    ]                                â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 4. è¿”å›ç»“æœ
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPI å“åº”                        â”‚
â”‚                                      â”‚
â”‚ return {                            â”‚
â”‚   &quot;gene_symbol&quot;: &quot;GAPDH&quot;,           â”‚
â”‚   &quot;data&quot;: [...]                     â”‚
â”‚ }                                   â”‚
â”‚ ï¼ˆFastAPIè‡ªåŠ¨åºåˆ—åŒ–ä¸ºJSONï¼‰          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 5. HTTP 200 å“åº”
     â”‚    Content-Type: application/json
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: å¤„ç†å“åº”                       â”‚
â”‚                                      â”‚
â”‚ 1. response.json() è§£æJSON         â”‚
â”‚ 2. setSearchResults(data.data)      â”‚
â”‚ 3. setIsLoading(false)              â”‚
â”‚ 4. Reacté‡æ¸²æŸ“ â†’ æ˜¾ç¤ºç»“æœè¡¨æ ¼        â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·çœ‹åˆ° â”‚
â”‚ ç»“æœè¡¨æ ¼  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 id="2_1">æµç¨‹2ï¼šä¸»é¢˜åˆ†æå®Œæ•´æµç¨‹<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ 1. ä¸Šä¼ åŸºå› åˆ—è¡¨æ–‡ä»¶ (.txt)
     â”‚ 2. é€‰æ‹©ä¸»é¢˜
     â”‚ 3. ç‚¹å‡»&quot;åˆ†æ&quot;
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: customize-theme/page.tsx      â”‚
â”‚                                      â”‚
â”‚ handleAnalyze() å‡½æ•°ï¼š               â”‚
â”‚ 1. è¯»å–æ–‡ä»¶å†…å®¹                       â”‚
â”‚ 2. æ„å»ºFormData                      â”‚
â”‚ 3. fetch(`${API_URL}/api/ontology/  â”‚
â”‚          custom-analyze`, {          â”‚
â”‚    method: 'POST',                   â”‚
â”‚    body: formData                    â”‚
â”‚  })                                  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 2. HTTP POST è¯·æ±‚
     â”‚    Content-Type: multipart/form-data
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPI è·¯ç”±                        â”‚
â”‚ @app.post(&quot;/api/ontology/custom-    â”‚
â”‚          analyze&quot;)                   â”‚
â”‚                                      â”‚
â”‚ 1. æ¥æ”¶æ–‡ä»¶ (UploadFile)             â”‚
â”‚ 2. æ¥æ”¶selected_themes (Form)        â”‚
â”‚ 3. æ¥æ”¶custom_themes (Form, JSON)   â”‚
â”‚ 4. è°ƒç”¨ontology_apiæ–¹æ³•              â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GeneOntologyAPI                     â”‚
â”‚                                      â”‚
â”‚ Step 1: load_genes_from_file()      â”‚
â”‚    - è¯»å–æ–‡ä»¶å†…å®¹                     â”‚
â”‚    - æŒ‰è¡Œåˆ†å‰²                         â”‚
â”‚    - å»é™¤ç©ºç™½                         â”‚
â”‚    - è¿”å›åŸºå› åˆ—è¡¨                     â”‚
â”‚                                      â”‚
â”‚ Step 2: ä¸´æ—¶æ·»åŠ è‡ªå®šä¹‰ä¸»é¢˜           â”‚
â”‚    original_themes = self.themes     â”‚
â”‚    for custom_theme in custom_themes:â”‚
â”‚        self.themes[theme_name] =     â”‚
â”‚            keywords                  â”‚
â”‚                                      â”‚
â”‚ Step 3: enrich(genes)               â”‚
â”‚    - è°ƒç”¨GProfiler API               â”‚
â”‚    - è¿‡æ»¤På€¼                         â”‚
â”‚    - è®¡ç®—Score                       â”‚
â”‚                                      â”‚
â”‚ Step 4: assign_theme()              â”‚
â”‚    - ä¸ºæ¯ä¸ªGOæœ¯è¯­åˆ†é…ä¸»é¢˜             â”‚
â”‚                                      â”‚
â”‚ Step 5: aggregate()                 â”‚
â”‚    - æŒ‰ä¸»é¢˜èšåˆ                       â”‚
â”‚                                      â”‚
â”‚ Step 6: æ¢å¤åŸå§‹ä¸»é¢˜                 â”‚
â”‚    self.themes = original_themes     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GProfiler API (å¤–éƒ¨æœåŠ¡)             â”‚
â”‚                                      â”‚
â”‚ 1. æ¥æ”¶åŸºå› åˆ—è¡¨                       â”‚
â”‚ 2. æ‰§è¡Œè¶…å‡ ä½•æ£€éªŒ                     â”‚
â”‚ 3. è¿”å›å¯Œé›†ç»“æœï¼ˆDataFrameï¼‰          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯å¤„ç†ç»“æœ                         â”‚
â”‚                                      â”‚
â”‚ 1. è¿‡æ»¤æ˜¾è‘—ç»“æœ                       â”‚
â”‚ 2. åˆ†é…ä¸»é¢˜                           â”‚
â”‚ 3. èšåˆç»Ÿè®¡                           â”‚
â”‚ 4. ç”Ÿæˆå›¾è¡¨ï¼ˆå¯é€‰ï¼‰                   â”‚
â”‚ 5. è¿”å›JSONå“åº”                      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 3. HTTP 200 å“åº”
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: æ˜¾ç¤ºç»“æœ                       â”‚
â”‚                                      â”‚
â”‚ 1. è§£æå“åº”                           â”‚
â”‚ 2. æ˜¾ç¤ºç»“æœè¡¨æ ¼                       â”‚
â”‚ 3. æ˜¾ç¤ºæ±‡æ€»å›¾è¡¨                       â”‚
â”‚ 4. æ˜¾ç¤ºä¸»é¢˜è¯¦ç»†å›¾                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 id="3ivcca">æµç¨‹3ï¼šIVCCAåˆ†æå®Œæ•´æµç¨‹<a class="headerlink" href="#3ivcca" title="Permanent link">&para;</a></h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ 1. ä¸Šä¼ æ•°æ®æ–‡ä»¶ (.xlsx/.csv/.tsv)
     â”‚ 2. ç‚¹å‡»&quot;åŠ è½½æ•°æ®&quot;
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: ivcca/page.tsx                â”‚
â”‚                                      â”‚
â”‚ handleLoadData() å‡½æ•°ï¼š              â”‚
â”‚ 1. è¯»å–æ–‡ä»¶                          â”‚
â”‚ 2. æ„å»ºFormData                      â”‚
â”‚ 3. POST /api/ivcca/load-data        â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯: /api/ivcca/load-data          â”‚
â”‚                                      â”‚
â”‚ 1. åˆ›å»ºIVCCAAnalyzerå®ä¾‹            â”‚
â”‚    analyzer = IVCCAAnalyzer()       â”‚
â”‚ 2. è°ƒç”¨analyzer.load_data()         â”‚
â”‚ 3. ç”Ÿæˆå”¯ä¸€IDï¼ˆanalyzer_idï¼‰        â”‚
â”‚ 4. å­˜å‚¨åˆ°å†…å­˜ï¼ˆå­—å…¸ï¼‰                â”‚
â”‚    analyzers[analyzer_id] = analyzer â”‚
â”‚ 5. è¿”å›analyzer_id                  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ç‚¹å‡»&quot;è®¡ç®—ç›¸å…³æ€§&quot;                  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: POST /api/ivcca/              â”‚
â”‚       calculate-correlation          â”‚
â”‚                                      â”‚
â”‚ Body: {                             â”‚
â”‚   analyzer_id: &quot;...&quot;,                â”‚
â”‚   method: &quot;pearson&quot;                  â”‚
â”‚ }                                   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯å¤„ç†                             â”‚
â”‚                                      â”‚
â”‚ 1. ä»å†…å­˜è·å–analyzer                â”‚
â”‚    analyzer = analyzers[analyzer_id] â”‚
â”‚ 2. analyzer.calculate_correlations() â”‚
â”‚    - è®¡ç®—ç›¸å…³æ€§çŸ©é˜µ                  â”‚
â”‚    - è®¡ç®—ç»Ÿè®¡ä¿¡æ¯                    â”‚
â”‚ 3. è¿”å›ç»Ÿè®¡ä¿¡æ¯                      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·é€‰æ‹©&quot;ç”Ÿæˆçƒ­å›¾&quot;                    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: POST /api/ivcca/heatmap       â”‚
â”‚                                      â”‚
â”‚ Body: {                             â”‚
â”‚   analyzer_id: &quot;...&quot;,                â”‚
â”‚   sorted: false                      â”‚
â”‚ }                                   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯: analyzer.create_correlation_   â”‚
â”‚       heatmap()                      â”‚
â”‚                                      â”‚
â”‚ 1. è·å–ç›¸å…³æ€§çŸ©é˜µ                    â”‚
â”‚ 2. ä½¿ç”¨seabornç»˜åˆ¶çƒ­å›¾               â”‚
â”‚ 3. è½¬æ¢ä¸ºbase64                      â”‚
â”‚ 4. æˆ–ä½¿ç”¨Plotlyç”Ÿæˆäº¤äº’å¼å›¾è¡¨        â”‚
â”‚ 5. è¿”å›JSON: {                       â”‚
â”‚      type: &quot;plotly&quot;,                 â”‚
â”‚      content: {...}                  â”‚
â”‚    }                                â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: æ¸²æŸ“å›¾è¡¨                       â”‚
â”‚                                      â”‚
â”‚ if (type === &quot;plotly&quot;) {            â”‚
â”‚    &lt;Plot data={content} /&gt;          â”‚
â”‚ } else {                            â”‚
â”‚    &lt;img src={`data:image/...`} /&gt;   â”‚
â”‚ }                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="_20">çŠ¶æ€ç®¡ç†ï¼ˆåç«¯ï¼‰<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<p><strong>å†…å­˜çŠ¶æ€ç®¡ç†</strong>ï¼š</p>
<pre><code class="language-python"># IVCCAåˆ†æå™¨å®ä¾‹å­˜å‚¨ï¼ˆå†…å­˜ä¸­ï¼‰
analyzers: Dict[str, IVCCAAnalyzer] = {}

# ä½¿ç”¨analyzer_idä½œä¸ºé”®
analyzer_id = str(uuid.uuid4())
analyzers[analyzer_id] = IVCCAAnalyzer()
</code></pre>
<p><strong>MongoDBçŠ¶æ€</strong>ï¼š</p>
<ul>
<li>åŸºå› è¡¨è¾¾æ•°æ®æŒä¹…åŒ–å­˜å‚¨</li>
<li>ç´¢å¼•åŠ é€ŸæŸ¥è¯¢</li>
<li>æ”¯æŒå¹¶å‘è®¿é—®</li>
</ul>
<p><strong>æ— çŠ¶æ€APIè®¾è®¡</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªè¯·æ±‚ç‹¬ç«‹å¤„ç†</li>
<li>é€šè¿‡analyzer_idå…³è”åˆ†æä¼šè¯</li>
<li>æ”¯æŒå¤šä¸ªç”¨æˆ·åŒæ—¶åˆ†æ</li>
</ul>
<hr />
<h2 id="_21">æ ¸å¿ƒæ¨¡å—æ¶æ„<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h2>
<h3 id="1_2">æ¨¡å—1ï¼šåŸºå› æœç´¢ç³»ç»Ÿæ¶æ„<a class="headerlink" href="#1_2" title="Permanent link">&para;</a></h3>
<h4 id="_22">æ•°æ®æµæ¶æ„<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<pre><code>Excelæ–‡ä»¶ (data/*.xlsx)
    â”‚
    â–¼
[æ•°æ®åŠ è½½é˜¶æ®µ]
    â”œâ”€ pandas.read_excel()
    â”œâ”€ æ•°æ®æ¸…æ´—ï¼ˆå»é™¤ç©ºå€¼ã€ç±»å‹è½¬æ¢ï¼‰
    â””â”€ æ‰¹é‡å†™å…¥MongoDB
    â”‚
    â–¼
MongoDB (gene_data collection)
    â”‚
    â–¼
[æŸ¥è¯¢é˜¶æ®µ]
    â”œâ”€ ç”¨æˆ·è¾“å…¥åŸºå› ç¬¦å·
    â”œâ”€ MongoDBæŸ¥è¯¢ï¼ˆä½¿ç”¨ç´¢å¼•ï¼‰
    â””â”€ è¿”å›åŒ¹é…æ–‡æ¡£
    â”‚
    â–¼
[å¯è§†åŒ–é˜¶æ®µ]
    â”œâ”€ æå–æ•°æ®ï¼ˆorgan, fold_change, lsmeanï¼‰
    â”œâ”€ matplotlibç”Ÿæˆå›¾è¡¨
    â””â”€ base64ç¼–ç è¿”å›
</code></pre>
<h4 id="_23">ç»„ä»¶äº¤äº’<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h4>
<pre><code>ç”¨æˆ·ç•Œé¢ (React)
    â”‚
    â”œâ”€â†’ SearchInput â†’ handleSearch()
    â”‚                    â”‚
    â”‚                    â–¼
    â”‚              APIè°ƒç”¨ (fetch)
    â”‚                    â”‚
    â”œâ”€â†’ ResultsTable â†â”€ APIå“åº”
    â”‚                    â”‚
    â””â”€â†’ PlotDisplay â†â”€ å›¾è¡¨APIè°ƒç”¨
</code></pre>
<h3 id="2_2">æ¨¡å—2ï¼šä¸»é¢˜åˆ†æç³»ç»Ÿæ¶æ„<a class="headerlink" href="#2_2" title="Permanent link">&para;</a></h3>
<h4 id="_24">æ•°æ®æµæ¶æ„<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h4>
<pre><code>ç”¨æˆ·ä¸Šä¼ åŸºå› åˆ—è¡¨ (.txt)
    â”‚
    â–¼
[è§£æé˜¶æ®µ]
    â”œâ”€ æŒ‰è¡Œè¯»å–
    â”œâ”€ å»é™¤ç©ºç™½
    â””â”€ ç”ŸæˆåŸºå› åˆ—è¡¨
    â”‚
    â–¼
[å¯Œé›†åˆ†æé˜¶æ®µ]
    â”œâ”€ è°ƒç”¨GProfiler API
    â”œâ”€ è¶…å‡ ä½•æ£€éªŒ
    â””â”€ è¿”å›æ˜¾è‘—GOæœ¯è¯­
    â”‚
    â–¼
[ä¸»é¢˜åˆ†é…é˜¶æ®µ]
    â”œâ”€ å…³é”®è¯åŒ¹é…
    â”œâ”€ ä¸»é¢˜æ˜ å°„
    â””â”€ æ ‡è®°æ¯ä¸ªGOæœ¯è¯­çš„ä¸»é¢˜
    â”‚
    â–¼
[èšåˆé˜¶æ®µ]
    â”œâ”€ æŒ‰ä¸»é¢˜åˆ†ç»„
    â”œâ”€ è®¡ç®—ç´¯ç§¯åˆ†æ•°
    â””â”€ æ’åº
    â”‚
    â–¼
[å¯è§†åŒ–é˜¶æ®µ]
    â”œâ”€ ç”Ÿæˆæ±‡æ€»å›¾è¡¨
    â”œâ”€ ç”Ÿæˆä¸»é¢˜è¯¦ç»†å›¾
    â””â”€ base64ç¼–ç è¿”å›
</code></pre>
<h4 id="_25">ä¸»é¢˜åŒ¹é…ç®—æ³•æµç¨‹<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h4>
<pre><code>GOæœ¯è¯­åç§° (&quot;inflammatory response&quot;)
    â”‚
    â–¼
è½¬æ¢ä¸ºå°å†™ (&quot;inflammatory response&quot;)
    â”‚
    â–¼
éå†ä¸»é¢˜å…³é”®è¯ï¼š
    â”œâ”€ &quot;Inflammation &amp; immune signaling&quot;: 
    â”‚     [&quot;inflammatory&quot;, &quot;immune&quot;, ...]
    â”‚     â”‚
    â”‚     â–¼
    â”‚  æ£€æŸ¥ &quot;inflammatory&quot; in &quot;inflammatory response&quot; â†’ True
    â”‚     â”‚
    â”‚     â–¼
    â”‚  è¿”å›ä¸»é¢˜ &quot;Inflammation &amp; immune signaling&quot;
    â”‚
    â””â”€ å…¶ä»–ä¸»é¢˜ï¼ˆè·³è¿‡ï¼‰
</code></pre>
<h3 id="3ivcca_1">æ¨¡å—3ï¼šIVCCAåˆ†æç³»ç»Ÿæ¶æ„<a class="headerlink" href="#3ivcca_1" title="Permanent link">&para;</a></h3>
<h4 id="_26">åˆ†ææµç¨‹æ¶æ„<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h4>
<pre><code>æ•°æ®åŠ è½½
    â”‚
    â”œâ”€â†’ æ–‡ä»¶è¯»å– â†’ æ•°æ®çŸ©é˜µ (samples Ã— genes)
    â”‚
    â–¼
ç›¸å…³æ€§è®¡ç®—
    â”‚
    â”œâ”€â†’ Pearson/Spearman/Kendall â†’ ç›¸å…³æ€§çŸ©é˜µ (genes Ã— genes)
    â”‚
    â–¼
æ’åº/èšç±»
    â”‚
    â”œâ”€â†’ æ’åº â†’ æŒ‰ç›¸å…³æ€§å¼ºåº¦æ’åº
    â”œâ”€â†’ èšç±» â†’ Elbow/Silhouette â†’ K-means/å±‚æ¬¡èšç±»
    â”‚
    â–¼
é™ç»´åˆ†æ
    â”‚
    â”œâ”€â†’ PCA â†’ ä¸»æˆåˆ†åˆ†æ•°
    â””â”€â†’ t-SNE â†’ ä½ç»´åµŒå…¥
    â”‚
    â–¼
é€šè·¯åˆ†æ
    â”‚
    â”œâ”€â†’ å•é€šè·¯ â†’ PCI_A, PCI_Bè®¡ç®—
    â”œâ”€â†’ å¤šé€šè·¯ â†’ CECI, Z-scoreè®¡ç®—
    â””â”€â†’ é€šè·¯æ¯”è¾ƒ â†’ ä½™å¼¦ç›¸ä¼¼åº¦
    â”‚
    â–¼
ç½‘ç»œåˆ†æ
    â”‚
    â””â”€â†’ ç›¸å…³æ€§é˜ˆå€¼è¿‡æ»¤ â†’ ç½‘ç»œå›¾ï¼ˆ2D/3Dï¼‰
</code></pre>
<h4 id="ivcca">IVCCAç±»æ–¹æ³•è°ƒç”¨é“¾<a class="headerlink" href="#ivcca" title="Permanent link">&para;</a></h4>
<pre><code>load_data()
    â”‚
    â–¼
calculate_correlations()
    â”‚
    â”œâ”€â†’ sort_correlation_matrix()
    â”‚       â”‚
    â”‚       â””â”€â†’ create_correlation_heatmap()
    â”‚
    â”œâ”€â†’ calculate_optimal_clusters()
    â”‚       â”‚
    â”‚       â””â”€â†’ create_dendrogram()
    â”‚
    â”œâ”€â†’ perform_pca()
    â”‚       â”‚
    â”‚       â””â”€â†’ create_pca_3d_plot()
    â”‚
    â”œâ”€â†’ perform_tsne()
    â”‚       â”‚
    â”‚       â””â”€â†’ create_tsne_3d_plot()
    â”‚
    â”œâ”€â†’ analyze_single_pathway()
    â”‚
    â”œâ”€â†’ multi_pathway_analysis()
    â”‚
    â””â”€â†’ create_network_graph()
</code></pre>
<hr />
<h2 id="api_2">APIæ¥å£æ¶æ„<a class="headerlink" href="#api_2" title="Permanent link">&para;</a></h2>
<h3 id="restful-api">RESTful APIè®¾è®¡åŸåˆ™<a class="headerlink" href="#restful-api" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>èµ„æºå¯¼å‘</strong>ï¼šURLä»£è¡¨èµ„æº</li>
<li><code>/api/gene/symbol/search</code> - åŸºå› èµ„æº</li>
<li><code>/api/ontology/analyze</code> - æœ¬ä½“åˆ†æèµ„æº</li>
<li>
<p><code>/api/ivcca/load-data</code> - IVCCAæ•°æ®èµ„æº</p>
</li>
<li>
<p><strong>HTTPæ–¹æ³•è¯­ä¹‰</strong>ï¼š</p>
</li>
<li>GETï¼šè·å–èµ„æº</li>
<li>
<p>POSTï¼šåˆ›å»º/æ‰§è¡Œæ“ä½œ</p>
</li>
<li>
<p><strong>çŠ¶æ€ç ä½¿ç”¨</strong>ï¼š</p>
</li>
<li>200ï¼šæˆåŠŸ</li>
<li>400ï¼šå®¢æˆ·ç«¯é”™è¯¯</li>
<li>401ï¼šæœªè®¤è¯</li>
<li>404ï¼šèµ„æºä¸å­˜åœ¨</li>
<li>500ï¼šæœåŠ¡å™¨é”™è¯¯</li>
</ol>
<h3 id="api_3">APIç«¯ç‚¹è¯¦ç»†æ˜ å°„<a class="headerlink" href="#api_3" title="Permanent link">&para;</a></h3>
<h4 id="api_4">åŸºå› æœç´¢APIç«¯ç‚¹<a class="headerlink" href="#api_4" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ç«¯ç‚¹</th>
<th>æ–¹æ³•</th>
<th>è¾“å…¥</th>
<th>è¾“å‡º</th>
<th>å…³è”ç»„ä»¶</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/api/gene/symbols</code></td>
<td>GET</td>
<td>-</td>
<td><code>{gene_symbols: []}</code></td>
<td>GeneSearch â†’ MongoDB</td>
</tr>
<tr>
<td><code>/api/gene/symbol/search</code></td>
<td>GET</td>
<td><code>gene_symbol</code></td>
<td><code>{gene_symbol, data: []}</code></td>
<td>GeneSearch â†’ MongoDB</td>
</tr>
<tr>
<td><code>/api/gene/symbol/showFoldChange</code></td>
<td>GET</td>
<td><code>gene_symbol</code></td>
<td><code>{image_base64}</code></td>
<td>GeneSearch â†’ matplotlib</td>
</tr>
<tr>
<td><code>/api/gene/symbol/showLSMeanControl</code></td>
<td>GET</td>
<td><code>gene_symbol</code></td>
<td><code>{image_base64}</code></td>
<td>GeneSearch â†’ matplotlib</td>
</tr>
<tr>
<td><code>/api/gene/symbol/showLSMeanTenMgKg</code></td>
<td>GET</td>
<td><code>gene_symbol</code></td>
<td><code>{image_base64}</code></td>
<td>GeneSearch â†’ matplotlib</td>
</tr>
</tbody>
</table>
<p><strong>æ•°æ®æµ</strong>ï¼š</p>
<pre><code>å‰ç«¯ â†’ FastAPIè·¯ç”± â†’ GeneSearchAPI â†’ MongoDB â†’ æ•°æ®å¤„ç† â†’ å¯è§†åŒ– â†’ base64 â†’ å‰ç«¯
</code></pre>
<h4 id="api_5">ä¸»é¢˜åˆ†æAPIç«¯ç‚¹<a class="headerlink" href="#api_5" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ç«¯ç‚¹</th>
<th>æ–¹æ³•</th>
<th>è¾“å…¥</th>
<th>è¾“å‡º</th>
<th>å…³è”ç»„ä»¶</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/api/ontology/analyze</code></td>
<td>POST</td>
<td><code>file</code>, <code>selected_themes</code></td>
<td><code>{results: []}</code></td>
<td>ThemeAnalysis â†’ GProfiler</td>
</tr>
<tr>
<td><code>/api/ontology/custom-analyze</code></td>
<td>POST</td>
<td><code>file</code>, <code>selected_themes</code>, <code>custom_themes</code></td>
<td><code>{results: []}</code></td>
<td>ThemeAnalysis â†’ GProfiler</td>
</tr>
<tr>
<td><code>/api/ontology/theme-chart</code></td>
<td>POST</td>
<td><code>file</code>, <code>theme</code></td>
<td><code>{image_base64}</code></td>
<td>ThemeAnalysis â†’ matplotlib</td>
</tr>
<tr>
<td><code>/api/ontology/custom-summary-chart</code></td>
<td>POST</td>
<td><code>file</code>, <code>selected_themes</code>, <code>custom_themes</code></td>
<td><code>{image_base64}</code></td>
<td>ThemeAnalysis â†’ matplotlib</td>
</tr>
</tbody>
</table>
<p><strong>æ•°æ®æµ</strong>ï¼š</p>
<pre><code>å‰ç«¯ â†’ FastAPI â†’ GeneOntologyAPI â†’ GProfiler API â†’ å¯Œé›†ç»“æœ â†’ ä¸»é¢˜åˆ†é… â†’ èšåˆ â†’ å¯è§†åŒ– â†’ å‰ç«¯
</code></pre>
<h4 id="ivccaapi">IVCCAåˆ†æAPIç«¯ç‚¹<a class="headerlink" href="#ivccaapi" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ç«¯ç‚¹</th>
<th>æ–¹æ³•</th>
<th>è¾“å…¥</th>
<th>è¾“å‡º</th>
<th>å…³è”ç»„ä»¶</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/api/ivcca/load-data</code></td>
<td>POST</td>
<td><code>file</code></td>
<td><code>{analyzer_id, preview}</code></td>
<td>IVCCA â†’ IVCCAAnalyzer</td>
</tr>
<tr>
<td><code>/api/ivcca/calculate-correlation</code></td>
<td>POST</td>
<td><code>analyzer_id</code>, <code>method</code></td>
<td><code>{statistics}</code></td>
<td>IVCCA â†’ IVCCAAnalyzer</td>
</tr>
<tr>
<td><code>/api/ivcca/sort-matrix</code></td>
<td>POST</td>
<td><code>analyzer_id</code></td>
<td><code>{sorted_matrix, sorted_genes}</code></td>
<td>IVCCA â†’ IVCCAAnalyzer</td>
</tr>
<tr>
<td><code>/api/ivcca/heatmap</code></td>
<td>POST</td>
<td><code>analyzer_id</code>, <code>sorted</code></td>
<td><code>{type, content}</code></td>
<td>IVCCA â†’ IVCCAAnalyzer â†’ Plotly</td>
</tr>
<tr>
<td><code>/api/ivcca/pca</code></td>
<td>POST</td>
<td><code>analyzer_id</code>, <code>n_components</code></td>
<td><code>{scores, explained_variance, plots}</code></td>
<td>IVCCA â†’ IVCCAAnalyzer â†’ sklearn</td>
</tr>
<tr>
<td><code>/api/ivcca/tsne</code></td>
<td>POST</td>
<td><code>analyzer_id</code>, <code>n_components</code>, <code>perplexity</code></td>
<td><code>{scores, scatter_plot}</code></td>
<td>IVCCA â†’ IVCCAAnalyzer â†’ sklearn</td>
</tr>
<tr>
<td><code>/api/ivcca/multi-pathway</code></td>
<td>POST</td>
<td><code>analyzer_id</code>, <code>pathway_files</code></td>
<td><code>{pathways: [{ceci, z_score, ...}]}</code></td>
<td>IVCCA â†’ IVCCAAnalyzer</td>
</tr>
</tbody>
</table>
<p><strong>æ•°æ®æµ</strong>ï¼š</p>
<pre><code>å‰ç«¯ â†’ FastAPI â†’ å†…å­˜ä¸­çš„IVCCAAnalyzerå®ä¾‹ â†’ ç®—æ³•è®¡ç®— â†’ ç»“æœè¿”å› â†’ å‰ç«¯
</code></pre>
<h3 id="api_6">APIå“åº”æ ¼å¼<a class="headerlink" href="#api_6" title="Permanent link">&para;</a></h3>
<p><strong>æˆåŠŸå“åº”</strong>ï¼š</p>
<pre><code class="language-json">{
  &quot;status&quot;: &quot;success&quot;,
  &quot;data&quot;: {...},
  &quot;message&quot;: &quot;Operation completed successfully&quot;
}
</code></pre>
<p><strong>é”™è¯¯å“åº”</strong>ï¼š</p>
<pre><code class="language-json">{
  &quot;detail&quot;: &quot;Error message here&quot;
}
</code></pre>
<p><strong>åˆ†é¡µå“åº”</strong>ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼š</p>
<pre><code class="language-json">{
  &quot;status&quot;: &quot;success&quot;,
  &quot;data&quot;: [...],
  &quot;total&quot;: 100,
  &quot;page&quot;: 1,
  &quot;page_size&quot;: 20
}
</code></pre>
<hr />
<h2 id="_27">æ•°æ®åº“æ¶æ„<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h2>
<h3 id="mongodb_1">MongoDBæ•°æ®æ¨¡å‹<a class="headerlink" href="#mongodb_1" title="Permanent link">&para;</a></h3>
<h4 id="collectiongene_data">é›†åˆï¼ˆCollectionï¼‰ï¼š<code>gene_data</code><a class="headerlink" href="#collectiongene_data" title="Permanent link">&para;</a></h4>
<p><strong>æ–‡æ¡£ç»“æ„</strong>ï¼š</p>
<pre><code class="language-javascript">{
  &quot;_id&quot;: ObjectId(&quot;...&quot;),                    // MongoDBè‡ªåŠ¨ç”Ÿæˆ
  &quot;organ&quot;: &quot;Heart&quot;,                          // ç»„ç»‡åç§°ï¼ˆç´¢å¼•å­—æ®µï¼‰
  &quot;gene_symbol&quot;: &quot;GAPDH&quot;,                   // åŸºå› ç¬¦å·ï¼ˆç´¢å¼•å­—æ®µï¼‰
  &quot;gene_name&quot;: &quot;Glyceraldehyde-3-phosphate dehydrogenase&quot;,
  &quot;p_value_10_mgkg_vs_control&quot;: &quot;0.001&quot;,
  &quot;fdr_step_up_10_mgkg_vs_control&quot;: &quot;0.05&quot;,
  &quot;ratio_10_mgkg_vs_control&quot;: &quot;1.5&quot;,
  &quot;fold_change_10_mgkg_vs_control&quot;: &quot;0.5&quot;,
  &quot;lsmean_10mgkg_10_mgkg_vs_control&quot;: &quot;10.5&quot;,
  &quot;lsmean_control_10_mgkg_vs_control&quot;: &quot;8.5&quot;
}
</code></pre>
<p><strong>ç´¢å¼•è®¾è®¡</strong>ï¼š</p>
<pre><code class="language-python"># 1. å•å­—æ®µç´¢å¼•ï¼ˆåŠ é€Ÿå•æ¡ä»¶æŸ¥è¯¢ï¼‰
collection.create_index([(&quot;gene_symbol&quot;, 1)])  # å‡åºç´¢å¼•
# æŸ¥è¯¢æ€§èƒ½ï¼šO(log n)

# 2. å•å­—æ®µç´¢å¼•ï¼ˆæŒ‰ç»„ç»‡ç­›é€‰ï¼‰
collection.create_index([(&quot;organ&quot;, 1)])
# æŸ¥è¯¢æ€§èƒ½ï¼šO(log n)

# 3. å¤åˆå”¯ä¸€ç´¢å¼•ï¼ˆé˜²æ­¢é‡å¤æ•°æ®ï¼‰
collection.create_index(
    [(&quot;organ&quot;, 1), (&quot;gene_symbol&quot;, 1)], 
    unique=True
)
# ç¡®ä¿åŒä¸€ç»„ç»‡åŒä¸€åŸºå› åªæœ‰ä¸€æ¡è®°å½•
</code></pre>
<h4 id="_28">æ•°æ®åŠ è½½æµç¨‹ï¼ˆè¯¦ç»†æ­¥éª¤ï¼‰<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h4>
<p><strong>æ­¥éª¤1ï¼šæ–‡ä»¶æ‰«æ</strong></p>
<pre><code class="language-python">excel_files = glob.glob(os.path.join(&quot;data&quot;, &quot;*.xlsx&quot;))
# ç»“æœï¼š['data/BoneMarrow.xlsx', 'data/Cortex.xlsx', ...]
</code></pre>
<p><strong>æ­¥éª¤2ï¼šé€ä¸ªæ–‡ä»¶å¤„ç†</strong></p>
<pre><code class="language-python">for file_path in excel_files:
    # 2.1 æå–ç»„ç»‡åç§°
    organ_name = os.path.splitext(os.path.basename(file_path))[0]
    # ç»“æœï¼š'BoneMarrow'

    # 2.2 è¯»å–Excelæ–‡ä»¶
    df = pd.read_excel(file_path)
    # DataFrameç»“æ„ï¼š
    # | Gene_symbol | Gene_name | P_value_... | ... |
    # |-------------|-----------|-------------|-----|
    # | GAPDH       | ...       | 0.001       | ... |
    # | ACTB        | ...       | 0.002       | ... |

    # 2.3 éå†æ¯ä¸€è¡Œ
    for _, row in df.iterrows():
        gene_symbol = str(row.get('Gene_symbol', '')).strip()
        if not gene_symbol:  # è·³è¿‡ç©ºåŸºå› ç¬¦å·
            continue

        # 2.4 æ„å»ºMongoDBæ–‡æ¡£
        record = {
            'organ': organ_name,
            'gene_symbol': gene_symbol,
            'gene_name': str(row.get('Gene_name', '')),
            # ... å…¶ä»–å­—æ®µ
        }
        records.append(record)
</code></pre>
<p><strong>æ­¥éª¤3ï¼šæ‰¹é‡å†™å…¥</strong></p>
<pre><code class="language-python"># 3.1 æ„å»ºæ‰¹é‡æ“ä½œåˆ—è¡¨
operations = []
for record in records:
    operations.append({
        'replaceOne': {
            'filter': {
                'organ': record['organ'],
                'gene_symbol': record['gene_symbol']
            },
            'replacement': record,
            'upsert': True  # ä¸å­˜åœ¨åˆ™æ’å…¥ï¼Œå­˜åœ¨åˆ™æ›´æ–°
        }
    })

# 3.2 æ‰§è¡Œæ‰¹é‡æ“ä½œ
result = collection.bulk_write(operations)
# ç»“æœï¼š
# - result.upserted_count: æ–°æ’å…¥çš„æ–‡æ¡£æ•°
# - result.modified_count: æ›´æ–°çš„æ–‡æ¡£æ•°
</code></pre>
<p><strong>æ­¥éª¤4ï¼šåˆ›å»ºç´¢å¼•</strong></p>
<pre><code class="language-python"># 4.1 åˆ›å»ºå•å­—æ®µç´¢å¼•
collection.create_index([(&quot;gene_symbol&quot;, 1)])
collection.create_index([(&quot;organ&quot;, 1)])

# 4.2 åˆ›å»ºå¤åˆå”¯ä¸€ç´¢å¼•
collection.create_index(
    [(&quot;organ&quot;, 1), (&quot;gene_symbol&quot;, 1)], 
    unique=True
)
</code></pre>
<h4 id="_29">æŸ¥è¯¢ä¼˜åŒ–<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h4>
<p><strong>æŸ¥è¯¢1ï¼šç²¾ç¡®åŸºå› ç¬¦å·æœç´¢</strong></p>
<pre><code class="language-python">query = {&quot;gene_symbol&quot;: {&quot;$regex&quot;: f&quot;^{gene_symbol}$&quot;, &quot;$options&quot;: &quot;i&quot;}}
# ä½¿ç”¨ç´¢å¼•ï¼šgene_symbolç´¢å¼•
# æ€§èƒ½ï¼šO(log n)
</code></pre>
<p><strong>æŸ¥è¯¢2ï¼šè·å–æ‰€æœ‰å”¯ä¸€åŸºå› ç¬¦å·</strong></p>
<pre><code class="language-python">pipeline = [
    {&quot;$group&quot;: {&quot;_id&quot;: &quot;$gene_symbol&quot;}},  # åˆ†ç»„å»é‡
    {&quot;$sort&quot;: {&quot;_id&quot;: 1}}                  # æ’åº
]
genes = [doc[&quot;_id&quot;] for doc in collection.aggregate(pipeline)]
# ä½¿ç”¨ç´¢å¼•ï¼šgene_symbolç´¢å¼•
# æ€§èƒ½ï¼šO(n log n)
</code></pre>
<hr />
<h2 id="_30">éƒ¨ç½²æ¶æ„<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h2>
<h3 id="docker">Dockerå®¹å™¨åŒ–æ¶æ„<a class="headerlink" href="#docker" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Docker Compose                  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Frontend   â”‚    â”‚   Backend    â”‚  â”‚
â”‚  â”‚   Container  â”‚â—„â”€â”€â–ºâ”‚   Container  â”‚  â”‚
â”‚  â”‚              â”‚    â”‚              â”‚  â”‚
â”‚  â”‚ Next.js      â”‚    â”‚ FastAPI      â”‚  â”‚
â”‚  â”‚ Port: 3000   â”‚    â”‚ Port: 8000   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚          â”‚
â”‚                             â–¼          â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                      â”‚   MongoDB    â”‚  â”‚
â”‚                      â”‚   Container  â”‚  â”‚
â”‚                      â”‚   (å¯é€‰)     â”‚  â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      gene-search-network         â”‚  â”‚
â”‚  â”‚      (Bridge Network)            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="_31">éƒ¨ç½²æµç¨‹<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h3>
<p><strong>1. æ„å»ºé˜¶æ®µ</strong></p>
<pre><code class="language-bash"># Frontendæ„å»º
cd genegen
npm install
npm run build  # ç”Ÿæˆ.nextç›®å½•

# Backendå‡†å¤‡
cd backend
pip install -r requirements.txt
</code></pre>
<p><strong>2. Dockeré•œåƒæ„å»º</strong></p>
<pre><code class="language-dockerfile"># Dockerfile.backend
FROM python:3.9-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
CMD [&quot;uvicorn&quot;, &quot;server:app&quot;, &quot;--host&quot;, &quot;0.0.0.0&quot;, &quot;--port&quot;, &quot;8000&quot;]

# Dockerfile.frontend
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build
CMD [&quot;npm&quot;, &quot;start&quot;]
</code></pre>
<p><strong>3. å®¹å™¨å¯åŠ¨</strong></p>
<pre><code class="language-bash">docker-compose up -d
</code></pre>
<hr />
<h2 id="_32">æŠ€æœ¯æ ˆè¯¦è§£<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h2>
<h3 id="_33">å‰ç«¯æŠ€æœ¯æ ˆ<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŠ€æœ¯</th>
<th>ç‰ˆæœ¬</th>
<th>ç”¨é€”</th>
<th>å…³è”å…³ç³»</th>
</tr>
</thead>
<tbody>
<tr>
<td>Next.js</td>
<td>15.3.5</td>
<td>Reactæ¡†æ¶ï¼Œè·¯ç”±ï¼ŒSSR</td>
<td>æ„å»ºå‰ç«¯åº”ç”¨</td>
</tr>
<tr>
<td>React</td>
<td>19.0.0</td>
<td>UIç»„ä»¶åº“</td>
<td>Next.jsçš„åŸºç¡€</td>
</tr>
<tr>
<td>TypeScript</td>
<td>5.x</td>
<td>ç±»å‹å®‰å…¨</td>
<td>ç¼–è¯‘ä¸ºJavaScript</td>
</tr>
<tr>
<td>Tailwind CSS</td>
<td>4.x</td>
<td>æ ·å¼æ¡†æ¶</td>
<td>é€šè¿‡globals.csså¼•å…¥</td>
</tr>
<tr>
<td>Plotly.js</td>
<td>2.35.3</td>
<td>äº¤äº’å¼å›¾è¡¨</td>
<td>é€šè¿‡react-plotly.jsä½¿ç”¨</td>
</tr>
</tbody>
</table>
<p><strong>ä¾èµ–å…³ç³»</strong>ï¼š</p>
<pre><code>Next.js â†’ React â†’ React DOM
Next.js â†’ TypeScript Compiler
Next.js â†’ Tailwind CSS
React â†’ Plotly.js (åŠ¨æ€å¯¼å…¥)
</code></pre>
<h3 id="_34">åç«¯æŠ€æœ¯æ ˆ<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŠ€æœ¯</th>
<th>ç‰ˆæœ¬</th>
<th>ç”¨é€”</th>
<th>å…³è”å…³ç³»</th>
</tr>
</thead>
<tbody>
<tr>
<td>FastAPI</td>
<td>0.68.0</td>
<td>Webæ¡†æ¶</td>
<td>æ„å»ºAPIæœåŠ¡</td>
</tr>
<tr>
<td>Python</td>
<td>3.9+</td>
<td>ç¼–ç¨‹è¯­è¨€</td>
<td>FastAPIçš„åŸºç¡€</td>
</tr>
<tr>
<td>pandas</td>
<td>1.3.0+</td>
<td>æ•°æ®å¤„ç†</td>
<td>è¯»å–Excel/CSV</td>
</tr>
<tr>
<td>NumPy</td>
<td>1.21.0+</td>
<td>æ•°å€¼è®¡ç®—</td>
<td>çŸ©é˜µè¿ç®—</td>
</tr>
<tr>
<td>SciPy</td>
<td>-</td>
<td>ç§‘å­¦è®¡ç®—</td>
<td>ç»Ÿè®¡æ£€éªŒ</td>
</tr>
<tr>
<td>scikit-learn</td>
<td>-</td>
<td>æœºå™¨å­¦ä¹ </td>
<td>PCA, t-SNE, K-means</td>
</tr>
<tr>
<td>matplotlib</td>
<td>3.4.0+</td>
<td>å›¾è¡¨ç”Ÿæˆ</td>
<td>é™æ€å›¾ç‰‡</td>
</tr>
<tr>
<td>seaborn</td>
<td>0.11.0+</td>
<td>é«˜çº§å¯è§†åŒ–</td>
<td>çƒ­å›¾</td>
</tr>
<tr>
<td>GProfiler</td>
<td>1.0.0+</td>
<td>å¯Œé›†åˆ†æ</td>
<td>å¤–éƒ¨APIå®¢æˆ·ç«¯</td>
</tr>
<tr>
<td>pymongo</td>
<td>-</td>
<td>MongoDBé©±åŠ¨</td>
<td>æ•°æ®åº“è¿æ¥</td>
</tr>
</tbody>
</table>
<p><strong>ä¾èµ–å…³ç³»</strong>ï¼š</p>
<pre><code>FastAPI â†’ Pydantic (æ•°æ®éªŒè¯)
FastAPI â†’ Uvicorn (ASGIæœåŠ¡å™¨)
pandas â†’ NumPy (åº•å±‚æ•°ç»„)
scikit-learn â†’ NumPy, SciPy
matplotlib â†’ NumPy
seaborn â†’ matplotlib, pandas
</code></pre>
<hr />
<h2 id="_35">æ¨¡å—é—´å…³è”å…³ç³»<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h2>
<h3 id="_36">æ•°æ®å…±äº«<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h3>
<p><strong>1. åŸºå› åˆ—è¡¨å…±äº«</strong>ï¼š</p>
<pre><code>MongoDB (gene_data)
    â”‚
    â”œâ”€â†’ åŸºå› æœç´¢æ¨¡å—ï¼šæŸ¥è¯¢åŸºå› è¡¨è¾¾æ•°æ®
    â”‚
    â””â”€â†’ å…¶ä»–æ¨¡å—ï¼šå¯ä»¥ä½œä¸ºå‚è€ƒæ•°æ®æº
</code></pre>
<p><strong>2. åˆ†æç»“æœå…±äº«</strong>ï¼š</p>
<pre><code>IVCCAåˆ†æç»“æœï¼ˆç›¸å…³æ€§çŸ©é˜µï¼‰
    â”‚
    â””â”€â†’ å¯ç”¨äºé€šè·¯åˆ†æ
        â””â”€â†’ é€šè·¯åˆ†æç»“æœå¯ç”¨äºä¸»é¢˜åˆ†æ
</code></pre>
<h3 id="_37">åŠŸèƒ½ä¾èµ–å…³ç³»<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h3>
<pre><code>åŸºå› æœç´¢ â†â”€ ç‹¬ç«‹æ¨¡å—ï¼ˆä»…ä¾èµ–MongoDBï¼‰
    â”‚
ä¸»é¢˜åˆ†æ â†â”€ ä¾èµ–GProfiler API
    â”‚
IVCCAåˆ†æ â†â”€ ç‹¬ç«‹æ¨¡å—ï¼ˆç®—æ³•è‡ªåŒ…å«ï¼‰
</code></pre>
<h3 id="api_7">APIç«¯ç‚¹å…³è”<a class="headerlink" href="#api_7" title="Permanent link">&para;</a></h3>
<p><strong>åŒä¸€æ¨¡å—å†…çš„ç«¯ç‚¹å…³è”</strong>ï¼š</p>
<pre><code>/api/ivcca/load-data
    â†“ (è¿”å›analyzer_id)
/api/ivcca/calculate-correlation (éœ€è¦analyzer_id)
    â†“ (éœ€è¦å…ˆè®¡ç®—ç›¸å…³æ€§)
/api/ivcca/heatmap (éœ€è¦analyzer_id)
/api/ivcca/pca (éœ€è¦analyzer_id)
/api/ivcca/tsne (éœ€è¦analyzer_id)
</code></pre>
<hr />
<h2 id="_38">æ€§èƒ½ä¼˜åŒ–ç­–ç•¥<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h2>
<h3 id="_39">å‰ç«¯ä¼˜åŒ–<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>ä»£ç åˆ†å‰²</strong>ï¼š</li>
<li>Plotly.jsåŠ¨æ€å¯¼å…¥ï¼ˆ<code>dynamic import</code>ï¼‰</li>
<li>
<p>é¡µé¢çº§ä»£ç åˆ†å‰²ï¼ˆNext.jsè‡ªåŠ¨ï¼‰</p>
</li>
<li>
<p><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼š</p>
</li>
<li>åŸºå› ç¬¦å·åˆ—è¡¨ç¼“å­˜ï¼ˆlocalStorageï¼‰</li>
<li>
<p>APIå“åº”ç¼“å­˜ï¼ˆå¯é€‰ï¼‰</p>
</li>
<li>
<p><strong>æ‡’åŠ è½½</strong>ï¼š</p>
</li>
<li>å›¾è¡¨ç»„ä»¶æ‡’åŠ è½½</li>
<li>å›¾ç‰‡æ‡’åŠ è½½</li>
</ol>
<h3 id="_40">åç«¯ä¼˜åŒ–<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>æ•°æ®åº“ä¼˜åŒ–</strong>ï¼š</li>
<li>ç´¢å¼•åŠ é€ŸæŸ¥è¯¢</li>
<li>
<p>æ‰¹é‡æ“ä½œå‡å°‘IO</p>
</li>
<li>
<p><strong>è®¡ç®—ä¼˜åŒ–</strong>ï¼š</p>
</li>
<li>NumPyå‘é‡åŒ–è¿ç®—</li>
<li>
<p>ç›¸å…³æ€§çŸ©é˜µç¼“å­˜ï¼ˆå†…å­˜ä¸­ï¼‰</p>
</li>
<li>
<p><strong>å¹¶å‘å¤„ç†</strong>ï¼š</p>
</li>
<li>FastAPIå¼‚æ­¥å¤„ç†</li>
<li>å¤šä¸ªanalyzerå®ä¾‹ç‹¬ç«‹</li>
</ol>
<hr />
<h2 id="_41">å®‰å…¨æ¶æ„<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h2>
<h3 id="_42">è®¤è¯æœºåˆ¶<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h3>
<p><strong>Token-basedè®¤è¯</strong>ï¼š</p>
<pre><code class="language-python"># ç¯å¢ƒå˜é‡å­˜å‚¨æœ‰æ•ˆtoken
VALID_TOKENS = os.getenv('VALID_TOKENS', '').split(',')

# éªŒè¯å‡½æ•°
def verify_token(token: str) -&gt; bool:
    return token in VALID_TOKENS

# ä¿æŠ¤ç«¯ç‚¹
@app.post(&quot;/api/gene/add&quot;)
async def add_gene(..., token: str = Query(...)):
    if not verify_token(token):
        raise HTTPException(status_code=401)
</code></pre>
<h3 id="cors">CORSé…ç½®<a class="headerlink" href="#cors" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">app.add_middleware(
    CORSMiddleware,
    allow_origins=[&quot;*&quot;],  # å¼€å‘ç¯å¢ƒï¼Œç”Ÿäº§ç¯å¢ƒåº”é™åˆ¶
    allow_credentials=True,
    allow_methods=[&quot;*&quot;],
    allow_headers=[&quot;*&quot;],
)
</code></pre>
<h3 id="_43">æ•°æ®éªŒè¯<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h3>
<p><strong>Pydanticæ¨¡å‹éªŒè¯</strong>ï¼š</p>
<pre><code class="language-python">class GeneData(BaseModel):
    gene_symbol: str
    gene_name: str
    # ... è‡ªåŠ¨ç±»å‹éªŒè¯å’Œè½¬æ¢
</code></pre>
<hr />
<h2 id="_44">é”™è¯¯å¤„ç†æ¶æ„<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h2>
<h3 id="_45">å‰ç«¯é”™è¯¯å¤„ç†<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h3>
<pre><code class="language-typescript">try {
  const response = await fetch(...);
  if (!response.ok) {
    throw new Error(`HTTP ${response.status}`);
  }
  const data = await response.json();
} catch (error) {
  setError(error.message);  // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
  console.error(error);     // æ—¥å¿—è®°å½•
}
</code></pre>
<h3 id="_46">åç«¯é”™è¯¯å¤„ç†<a class="headerlink" href="#_46" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">try:
    # ä¸šåŠ¡é€»è¾‘
    result = process_data()
    return {&quot;status&quot;: &quot;success&quot;, &quot;data&quot;: result}
except ValueError as e:
    raise HTTPException(status_code=400, detail=str(e))
except Exception as e:
    raise HTTPException(status_code=500, detail=str(e))
</code></pre>
<hr />
<h2 id="_47">æ‰©å±•æ€§è®¾è®¡<a class="headerlink" href="#_47" title="Permanent link">&para;</a></h2>
<h3 id="_48">æ°´å¹³æ‰©å±•<a class="headerlink" href="#_48" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>å‰ç«¯</strong>ï¼šå¯ä»¥éƒ¨ç½²å¤šä¸ªå®ä¾‹ï¼Œä½¿ç”¨è´Ÿè½½å‡è¡¡</li>
<li><strong>åç«¯</strong>ï¼šæ— çŠ¶æ€è®¾è®¡ï¼Œæ”¯æŒå¤šå®ä¾‹éƒ¨ç½²</li>
<li><strong>æ•°æ®åº“</strong>ï¼šMongoDBæ”¯æŒåˆ†ç‰‡å’Œå‰¯æœ¬é›†</li>
</ul>
<h3 id="_49">åŠŸèƒ½æ‰©å±•<a class="headerlink" href="#_49" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>æ–°æ¨¡å—</strong>ï¼šå¯ä»¥æ·»åŠ æ–°çš„APIç±»å’Œæ–°ç«¯ç‚¹</li>
<li><strong>æ–°ç®—æ³•</strong>ï¼šå¯ä»¥åœ¨<code>ivcca_core.py</code>ä¸­æ·»åŠ æ–°æ–¹æ³•</li>
<li><strong>æ–°å¯è§†åŒ–</strong>ï¼šå¯ä»¥æ·»åŠ æ–°çš„å›¾è¡¨ç”Ÿæˆå‡½æ•°</li>
</ul>
<hr />
<p><strong>æ–‡æ¡£ç‰ˆæœ¬</strong>ï¼š1.0<br />
<strong>æœ€åæ›´æ–°</strong>ï¼š2024å¹´</p>
    
    <script>
        // Print hint
        window.onbeforeprint = function() {
            console.log("Print hint: Please select 'Save as PDF' or 'Print to PDF'");
        };
    </script>
</body>
</html>