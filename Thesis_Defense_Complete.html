<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç ”ç©¶ç”Ÿç­”è¾©å®Œæ•´æ–‡æ¡£ - GenoCorr å¹³å°</title>
    <style>
        @media print {
            @page {
                size: A4;
                margin: 2.5cm 2cm;
            }
            
            body {
                print-color-adjust: exact;
                -webkit-print-color-adjust: exact;
            }
            
            .no-print {
                display: none;
            }
            
            h1, h2, h3, h4, h5, h6 {
                page-break-after: avoid;
            }
            
            pre, blockquote, table {
                page-break-inside: avoid;
            }
        }
        
        body {
            font-family: "Microsoft YaHei", "SimHei", "Arial Unicode MS", "DejaVu Sans", Arial, sans-serif;
            line-height: 1.8;
            color: #333;
            font-size: 12pt;
            max-width: 210mm;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
        }
        
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #3498db;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14pt;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        .print-button:hover {
            background-color: #2980b9;
        }
        
        h1 {
            font-size: 28pt;
            font-weight: bold;
            color: #2c3e50;
            margin-top: 1.5em;
            margin-bottom: 0.8em;
            border-bottom: 3px solid #3498db;
            padding-bottom: 0.5em;
        }
        
        h2 {
            font-size: 22pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1.5em;
            margin-bottom: 0.6em;
            border-bottom: 2px solid #95a5a6;
            padding-bottom: 0.3em;
        }
        
        h3 {
            font-size: 18pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1.3em;
            margin-bottom: 0.5em;
        }
        
        h4 {
            font-size: 16pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1.2em;
            margin-bottom: 0.4em;
        }
        
        h5, h6 {
            font-size: 14pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1em;
            margin-bottom: 0.3em;
        }
        
        p {
            margin: 0.8em 0;
            text-align: justify;
        }
        
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", "Courier New", monospace;
            font-size: 10.5pt;
            color: #c7254e;
            border: 1px solid #e1e1e1;
        }
        
        pre {
            background-color: #f8f8f8;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border-left: 4px solid #3498db;
            margin: 1em 0;
        }
        
        pre code {
            background-color: transparent;
            padding: 0;
            border: none;
            color: #333;
            font-size: 10pt;
            display: block;
            white-space: pre;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 1.5em 0;
            font-size: 11pt;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
            text-align: center;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        ul, ol {
            margin: 0.8em 0;
            padding-left: 2em;
        }
        
        li {
            margin: 0.4em 0;
        }
        
        blockquote {
            border-left: 4px solid #3498db;
            margin: 1.5em 0;
            padding-left: 1.5em;
            padding-right: 1em;
            color: #555;
            font-style: italic;
            background-color: #f9f9f9;
            padding-top: 0.5em;
            padding-bottom: 0.5em;
        }
        
        hr {
            border: none;
            border-top: 2px solid #ddd;
            margin: 2em 0;
        }
        
        strong {
            font-weight: bold;
            color: #2c3e50;
        }
        
        em {
            font-style: italic;
            color: #555;
        }
        
        .toc {
            background-color: #f9f9f9;
            padding: 1.5em;
            margin: 1.5em 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 1em;
        }
        
        .toc li {
            margin: 0.3em 0;
        }
        
        .toc a {
            color: #3498db;
            text-decoration: none;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        /* æ•°å­¦å…¬å¼æ ·å¼ */
        .math {
            font-family: "Times New Roman", "STIX", serif;
            font-style: italic;
            margin: 0.5em 0;
            text-align: center;
        }
        
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 1.5em auto;
        }
    </style>
</head>
<body>
    <button class="print-button no-print" onclick="window.print()">
        ğŸ–¨ï¸ æ‰“å°ä¸º PDF
    </button>
    
    <h1 id="_1">ç ”ç©¶ç”Ÿç­”è¾©å®Œæ•´æ–‡æ¡£<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="genocorr">GenoCorr å¹³å°ï¼šåŸºå› è¡¨è¾¾åˆ†æä¸ç›¸å…³æ€§å¹³å°<a class="headerlink" href="#genocorr" title="Permanent link">&para;</a></h2>
<hr />
<h2 id="_2">ç›®å½•<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#é¡¹ç›®æ¦‚è¿°">é¡¹ç›®æ¦‚è¿°</a></li>
<li><a href="#æ¨¡å—ä¸€åŸºå› æœç´¢ç³»ç»Ÿ">æ¨¡å—ä¸€ï¼šåŸºå› æœç´¢ç³»ç»Ÿï¼ˆGene Search Systemï¼‰</a></li>
<li><a href="#æ¨¡å—äºŒä¸»é¢˜åˆ†æç³»ç»Ÿ">æ¨¡å—äºŒï¼šä¸»é¢˜åˆ†æç³»ç»Ÿï¼ˆTheme Analysis Systemï¼‰</a></li>
<li><a href="#æ¨¡å—ä¸‰ivccaåˆ†æç³»ç»Ÿ">æ¨¡å—ä¸‰ï¼šIVCCA åˆ†æç³»ç»Ÿï¼ˆInter-Variability Cross-Correlation Analysisï¼‰</a></li>
<li><a href="#æŠ€æœ¯æ¶æ„">æŠ€æœ¯æ¶æ„</a></li>
<li><a href="#é¡¹ç›®æ€»ç»“ä¸å±•æœ›">é¡¹ç›®æ€»ç»“ä¸å±•æœ›</a></li>
</ol>
<hr />
<h2 id="_3">é¡¹ç›®æ¦‚è¿°<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>GenoCorr å¹³å°æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„åŸºäºWebçš„ç”Ÿç‰©ä¿¡æ¯å­¦åˆ†æå¹³å°ï¼Œæ•´åˆäº†åŸºå› è¡¨è¾¾æ•°æ®æœç´¢ã€åŸºå› æœ¬ä½“å¯Œé›†åˆ†æå’Œè·¨å˜å¼‚æ€§ç›¸å…³æ€§åˆ†æä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½ã€‚è¯¥å¹³å°æ—¨åœ¨è§£å†³ç”Ÿç‰©åŒ»å­¦ç ”ç©¶ä¸­åŸºå› è¡¨è¾¾æ•°æ®åˆ†æ•£ã€åˆ†æå·¥å…·å¤æ‚ã€ç»“æœè§£è¯»å›°éš¾ç­‰é—®é¢˜ï¼Œä¸ºç ”ç©¶äººå‘˜æä¾›ä¸€ç«™å¼ã€æ˜“ç”¨çš„åŸºå› è¡¨è¾¾åˆ†æè§£å†³æ–¹æ¡ˆã€‚</p>
<h3 id="_4">ç ”ç©¶èƒŒæ™¯ä¸åŠ¨æœº<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>æ•°æ®åˆ†æ•£é—®é¢˜</strong>ï¼šåŸºå› è¡¨è¾¾æ•°æ®é€šå¸¸å­˜å‚¨åœ¨ä¸åŒçš„æ–‡ä»¶æˆ–æ•°æ®åº“ä¸­ï¼Œç¼ºä¹ç»Ÿä¸€çš„æŸ¥è¯¢æ¥å£</li>
<li><strong>å·¥å…·ä½¿ç”¨é—¨æ§›é«˜</strong>ï¼šç°æœ‰çš„ç”Ÿç‰©ä¿¡æ¯å­¦å·¥å…·å¾€å¾€éœ€è¦å‘½ä»¤è¡Œæ“ä½œæˆ–ç¼–ç¨‹æŠ€èƒ½ï¼Œé™åˆ¶äº†éè®¡ç®—èƒŒæ™¯ç ”ç©¶äººå‘˜çš„ä½¿ç”¨</li>
<li><strong>åˆ†ææµç¨‹å‰²è£‚</strong>ï¼šä¸åŒåˆ†ææ­¥éª¤éœ€è¦åˆ‡æ¢ä¸åŒå·¥å…·ï¼Œç¼ºä¹ç»Ÿä¸€çš„å¹³å°æ•´åˆ</li>
<li><strong>ç»“æœå¯è§†åŒ–ä¸è¶³</strong>ï¼šåˆ†æç»“æœå¾€å¾€ä»¥è¡¨æ ¼å½¢å¼å‘ˆç°ï¼Œç¼ºä¹ç›´è§‚çš„å¯è§†åŒ–å±•ç¤º</li>
</ol>
<h3 id="_5">é¡¹ç›®ç›®æ ‡<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>æ•°æ®æ•´åˆ</strong>ï¼šæ•´åˆå¤šä¸ªç»„ç»‡/å™¨å®˜çš„åŸºå› è¡¨è¾¾æ•°æ®ï¼Œæä¾›ç»Ÿä¸€çš„æœç´¢æ¥å£</li>
<li><strong>åŠŸèƒ½å¯Œé›†åˆ†æ</strong>ï¼šæä¾›åŸºäºä¸»é¢˜çš„åŸºå› æœ¬ä½“å¯Œé›†åˆ†æï¼Œå¸®åŠ©ç†è§£åŸºå› çš„ç”Ÿç‰©å­¦åŠŸèƒ½</li>
<li><strong>ç›¸å…³æ€§åˆ†æ</strong>ï¼šå®ç°è·¨æ ·æœ¬çš„ç›¸å…³æ€§åˆ†æï¼Œè¯†åˆ«å…±è¡¨è¾¾æ¨¡å¼å’Œè°ƒæ§ç½‘ç»œ</li>
<li><strong>æ˜“ç”¨æ€§</strong>ï¼šæä¾›ç›´è§‚çš„Webç•Œé¢ï¼Œé™ä½ä½¿ç”¨é—¨æ§›</li>
</ol>
<hr />
<h2 id="gene-search-system">æ¨¡å—ä¸€ï¼šåŸºå› æœç´¢ç³»ç»Ÿï¼ˆGene Search Systemï¼‰<a class="headerlink" href="#gene-search-system" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 è¿™æ˜¯ä»€ä¹ˆï¼Ÿ<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<p>åŸºå› æœç´¢ç³»ç»Ÿæ˜¯ä¸€ä¸ªå¤šç»„ç»‡åŸºå› è¡¨è¾¾æ•°æ®æŸ¥è¯¢ä¸åˆ†æå¹³å°ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡åŸºå› ç¬¦å·ï¼ˆGene Symbolï¼‰æœç´¢å¹¶è·å–è¯¥åŸºå› åœ¨å¤šä¸ªç»„ç»‡/å™¨å®˜ä¸­çš„è¡¨è¾¾æ•°æ®ã€‚ç³»ç»Ÿæ•´åˆäº†9ä¸ªç»„ç»‡çš„æ•°æ®ï¼šéª¨é«“ï¼ˆBone Marrowï¼‰ã€çš®å±‚ï¼ˆCortexï¼‰ã€èƒŒæ ¹ç¥ç»èŠ‚ï¼ˆDRGï¼‰ã€è„‚è‚ªï¼ˆFatï¼‰ã€å¿ƒè„ï¼ˆHeartï¼‰ã€ä¸‹ä¸˜è„‘ï¼ˆHypothalamusï¼‰ã€è‚¾è„ï¼ˆKidneysï¼‰ã€è‚è„ï¼ˆLiverï¼‰å’Œè‚Œè‚‰ï¼ˆMuscleï¼‰ã€‚</p>
<h3 id="12">1.2 èƒ½åšä»€ä¹ˆï¼Ÿ<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<h4 id="121">1.2.1 æ ¸å¿ƒåŠŸèƒ½<a class="headerlink" href="#121" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>åŸºå› æœç´¢</strong>ï¼š</li>
<li>é€šè¿‡åŸºå› ç¬¦å·æœç´¢ï¼ˆæ”¯æŒå¤§å°å†™ä¸æ•æ„Ÿï¼‰</li>
<li>è¿”å›è¯¥åŸºå› åœ¨æ‰€æœ‰ç»„ç»‡ä¸­çš„è¡¨è¾¾æ•°æ®</li>
<li>
<p>æ”¯æŒè‡ªåŠ¨è¡¥å…¨å’Œæ¨¡ç³ŠåŒ¹é…</p>
</li>
<li>
<p><strong>æ•°æ®å±•ç¤º</strong>ï¼š</p>
</li>
<li>
<p>æ˜¾ç¤ºæ¯ä¸ªç»„ç»‡ä¸­çš„ä»¥ä¸‹æ•°æ®ï¼š</p>
<ul>
<li><strong>På€¼</strong>ï¼ˆP-valueï¼‰ï¼šç»Ÿè®¡æ˜¾è‘—æ€§</li>
<li><strong>FDRæ ¡æ­£</strong>ï¼ˆFDR step-upï¼‰ï¼šå¤šé‡æ¯”è¾ƒæ ¡æ­£åçš„é”™è¯¯å‘ç°ç‡</li>
<li><strong>æ¯”ç‡</strong>ï¼ˆRatioï¼‰ï¼šå¤„ç†ç»„ä¸å¯¹ç…§ç»„çš„æ¯”å€¼</li>
<li><strong>å€æ•°å˜åŒ–</strong>ï¼ˆFold Changeï¼‰ï¼šè¡¨è¾¾é‡çš„å€æ•°å˜åŒ–</li>
<li><strong>æœ€å°äºŒä¹˜å‡å€¼</strong>ï¼ˆLSMeanï¼‰ï¼šå¤„ç†ç»„å’Œå¯¹ç…§ç»„çš„å‡å€¼</li>
</ul>
</li>
<li>
<p><strong>å¯è§†åŒ–</strong>ï¼š</p>
</li>
<li><strong>Fold Change æŸ±çŠ¶å›¾</strong>ï¼šå±•ç¤ºåŸºå› åœ¨å„ç»„ç»‡ä¸­çš„å€æ•°å˜åŒ–ï¼Œæ­£å€¼ä¸ºè“è‰²ï¼Œè´Ÿå€¼ä¸ºçº¢è‰²</li>
<li><strong>LSMean(Control) æŸ±çŠ¶å›¾</strong>ï¼šå±•ç¤ºå¯¹ç…§ç»„åœ¨å„ç»„ç»‡ä¸­çš„è¡¨è¾¾æ°´å¹³</li>
<li>
<p><strong>LSMean(10mg/kg) æŸ±çŠ¶å›¾</strong>ï¼šå±•ç¤ºå¤„ç†ç»„åœ¨å„ç»„ç»‡ä¸­çš„è¡¨è¾¾æ°´å¹³</p>
</li>
<li>
<p><strong>æ•°æ®ç®¡ç†</strong>ï¼š</p>
</li>
<li>æ”¯æŒæ·»åŠ æ–°åŸºå› æ•°æ®</li>
<li>æ•°æ®å»é‡å’ŒéªŒè¯</li>
<li>è‡ªåŠ¨ç´¢å¼•ä¼˜åŒ–</li>
</ol>
<h4 id="122">1.2.2 åº”ç”¨åœºæ™¯<a class="headerlink" href="#122" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>è¯ç‰©ç ”å‘</strong>ï¼šè¯„ä¼°è¯ç‰©å¯¹ç‰¹å®šåŸºå› åœ¨ä¸åŒç»„ç»‡ä¸­çš„è¡¨è¾¾å½±å“</li>
<li><strong>æ¯’æ€§ç ”ç©¶</strong>ï¼šè¯†åˆ«è¯ç‰©è¯±å¯¼çš„ç»„ç»‡ç‰¹å¼‚æ€§åŸºå› è¡¨è¾¾å˜åŒ–</li>
<li><strong>æ¯”è¾ƒç ”ç©¶</strong>ï¼šæ¯”è¾ƒåŒä¸€åŸºå› åœ¨ä¸åŒç»„ç»‡ä¸­çš„è¡¨è¾¾æ¨¡å¼</li>
<li><strong>ç”Ÿç‰©æ ‡å¿—ç‰©å‘ç°</strong>ï¼šè¯†åˆ«ç»„ç»‡ç‰¹å¼‚æ€§çš„ç”Ÿç‰©æ ‡å¿—ç‰©</li>
</ul>
<h3 id="13">1.3 ä¸ºä»€ä¹ˆè¦åšï¼Ÿ<a class="headerlink" href="#13" title="Permanent link">&para;</a></h3>
<h4 id="131">1.3.1 ç ”ç©¶éœ€æ±‚<a class="headerlink" href="#131" title="Permanent link">&para;</a></h4>
<p>åœ¨è¯ç‰©ç ”å‘å’Œæ¯’æ€§è¯„ä¼°ç ”ç©¶ä¸­ï¼Œç ”ç©¶äººå‘˜ç»å¸¸éœ€è¦ï¼š<br />
1. å¿«é€ŸæŸ¥è¯¢ç‰¹å®šåŸºå› åœ¨å¤šä¸ªç»„ç»‡ä¸­çš„è¡¨è¾¾æ•°æ®<br />
2. æ¯”è¾ƒåŒä¸€åŸºå› åœ¨ä¸åŒç»„ç»‡ä¸­çš„è¡¨è¾¾å·®å¼‚<br />
3. è¯„ä¼°è¯ç‰©å¤„ç†å¯¹åŸºå› è¡¨è¾¾çš„å½±å“<br />
4. è¯†åˆ«ç»„ç»‡ç‰¹å¼‚æ€§çš„è¡¨è¾¾æ¨¡å¼</p>
<h4 id="132">1.3.2 ç°æœ‰æ–¹æ¡ˆçš„ä¸è¶³<a class="headerlink" href="#132" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>æ•°æ®åˆ†æ•£</strong>ï¼šæ•°æ®å­˜å‚¨åœ¨ä¸åŒçš„Excelæ–‡ä»¶ä¸­ï¼ŒæŸ¥è¯¢å›°éš¾</li>
<li><strong>æ“ä½œç¹ç</strong>ï¼šéœ€è¦æ‰‹åŠ¨æ‰“å¼€å¤šä¸ªæ–‡ä»¶ï¼Œå¤åˆ¶ç²˜è´´æ•°æ®</li>
<li><strong>ç¼ºä¹å¯è§†åŒ–</strong>ï¼šæ•°æ®ä»¥è¡¨æ ¼å½¢å¼å‘ˆç°ï¼Œä¸ç›´è§‚</li>
<li><strong>éš¾ä»¥æ¯”è¾ƒ</strong>ï¼šè·¨ç»„ç»‡æ¯”è¾ƒéœ€è¦äººå·¥æ•´ç†æ•°æ®</li>
</ol>
<h4 id="133">1.3.3 æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆ<a class="headerlink" href="#133" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>ç»Ÿä¸€æ•°æ®å­˜å‚¨</strong>ï¼šä½¿ç”¨MongoDBæ•´åˆæ‰€æœ‰ç»„ç»‡çš„æ•°æ®</li>
<li><strong>å¿«é€Ÿæœç´¢</strong>ï¼šåŸºäºç´¢å¼•çš„å¿«é€ŸæŸ¥è¯¢ï¼ˆO(log n)å¤æ‚åº¦ï¼‰</li>
<li><strong>è‡ªåŠ¨å¯è§†åŒ–</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆä¸“ä¸šçš„æŸ±çŠ¶å›¾</li>
<li><strong>è·¨ç»„ç»‡æ¯”è¾ƒ</strong>ï¼šåœ¨ä¸€ä¸ªç•Œé¢ä¸­å±•ç¤ºæ‰€æœ‰ç»„ç»‡çš„æ•°æ®</li>
</ul>
<h3 id="14">1.4 å¦‚ä½•å®ç°ï¼Ÿ<a class="headerlink" href="#14" title="Permanent link">&para;</a></h3>
<h4 id="141">1.4.1 æ•°æ®æ¶æ„<a class="headerlink" href="#141" title="Permanent link">&para;</a></h4>
<p><strong>æ•°æ®å­˜å‚¨ç»“æ„</strong>ï¼š</p>
<pre><code class="language-python">{
    'organ': 'Heart',                    # ç»„ç»‡åç§°
    'gene_symbol': 'GAPDH',             # åŸºå› ç¬¦å·
    'gene_name': 'Glyceraldehyde-3-phosphate dehydrogenase',  # åŸºå› å…¨å
    'p_value_10_mgkg_vs_control': '0.001',      # På€¼
    'fdr_step_up_10_mgkg_vs_control': '0.05',   # FDRæ ¡æ­£
    'ratio_10_mgkg_vs_control': '1.5',          # æ¯”ç‡
    'fold_change_10_mgkg_vs_control': '0.5',    # å€æ•°å˜åŒ–
    'lsmean_10mgkg_10_mgkg_vs_control': '10.5', # å¤„ç†ç»„å‡å€¼
    'lsmean_control_10_mgkg_vs_control': '8.5'  # å¯¹ç…§ç»„å‡å€¼
}
</code></pre>
<p><strong>æ•°æ®åº“è®¾è®¡</strong>ï¼š<br />
- <strong>é›†åˆï¼ˆCollectionï¼‰</strong>ï¼š<code>gene_data</code><br />
- <strong>ç´¢å¼•</strong>ï¼š<br />
  - <code>gene_symbol</code>ï¼šå•å­—æ®µç´¢å¼•ï¼Œæ”¯æŒå¿«é€Ÿæœç´¢<br />
  - <code>organ</code>ï¼šå•å­—æ®µç´¢å¼•ï¼Œæ”¯æŒæŒ‰ç»„ç»‡ç­›é€‰<br />
  - <code>(organ, gene_symbol)</code>ï¼šå¤åˆå”¯ä¸€ç´¢å¼•ï¼Œé˜²æ­¢é‡å¤æ•°æ®</p>
<h4 id="142">1.4.2 æ ¸å¿ƒç®—æ³•<a class="headerlink" href="#142" title="Permanent link">&para;</a></h4>
<p><strong>1. æ•°æ®åŠ è½½ç®—æ³•</strong></p>
<pre><code class="language-python">def load_data_to_mongodb(self):
    &quot;&quot;&quot;åŠ è½½Excelæ–‡ä»¶åˆ°MongoDBï¼Œæ”¯æŒå»é‡&quot;&quot;&quot;
    for file_path in excel_files:
        df = pd.read_excel(file_path)  # è¯»å–Excel
        records = []
        for _, row in df.iterrows():
            record = {
                'organ': organ_name,
                'gene_symbol': row['Gene_symbol'],
                # ... å…¶ä»–å­—æ®µ
            }
            records.append(record)

        # æ‰¹é‡æ“ä½œï¼Œä½¿ç”¨upserté˜²æ­¢é‡å¤
        operations = []
        for record in records:
            operations.append({
                'replaceOne': {
                    'filter': {
                        'organ': record['organ'],
                        'gene_symbol': record['gene_symbol']
                    },
                    'replacement': record,
                    'upsert': True  # å­˜åœ¨åˆ™æ›´æ–°ï¼Œä¸å­˜åœ¨åˆ™æ’å…¥
                }
            })

        collection.bulk_write(operations)  # æ‰¹é‡å†™å…¥
</code></pre>
<p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œå…¶ä¸­nä¸ºè®°å½•æ•°<br />
<strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(n)</p>
<p><strong>2. åŸºå› æœç´¢ç®—æ³•</strong></p>
<pre><code class="language-python">def search_gene_data(self, gene_symbol: str) -&gt; List[Dict]:
    &quot;&quot;&quot;æœç´¢åŸºå› æ•°æ®ï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼‰&quot;&quot;&quot;
    # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å®ç°å¤§å°å†™ä¸æ•æ„Ÿæœç´¢
    query = {
        &quot;gene_symbol&quot;: {
            &quot;$regex&quot;: f&quot;^{gene_symbol}$&quot;,  # ç²¾ç¡®åŒ¹é…
            &quot;$options&quot;: &quot;i&quot;  # å¤§å°å†™ä¸æ•æ„Ÿ
        }
    }
    cursor = collection.find(query)  # ä½¿ç”¨ç´¢å¼•å¿«é€ŸæŸ¥è¯¢
    return list(cursor)
</code></pre>
<p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(log n)ï¼ˆåˆ©ç”¨ç´¢å¼•ï¼‰<br />
<strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(m)ï¼Œå…¶ä¸­mä¸ºåŒ¹é…ç»“æœæ•°</p>
<p><strong>3. å¯è§†åŒ–ç”Ÿæˆç®—æ³•</strong></p>
<pre><code class="language-python">def create_fold_change_plot(self, gene_symbol: str) -&gt; str:
    &quot;&quot;&quot;ç”ŸæˆFold ChangeæŸ±çŠ¶å›¾&quot;&quot;&quot;
    results = self.search_gene_data(gene_symbol)

    organs = []
    fold_changes = []
    colors = []

    for doc in results:
        fold_change = float(doc['fold_change_10_mgkg_vs_control'])
        organs.append(doc['organ'])
        fold_changes.append(fold_change)
        # æ ¹æ®ç¬¦å·é€‰æ‹©é¢œè‰²
        colors.append('blue' if fold_change &gt;= 0 else 'red')

    # ä½¿ç”¨matplotlibç”Ÿæˆå›¾è¡¨
    fig, ax = plt.subplots(figsize=(10, 6))
    ax.bar(organs, fold_changes, color=colors)
    ax.set_title(f'Fold Change for {gene_symbol}')
    # ... å…¶ä»–è®¾ç½®

    # è½¬æ¢ä¸ºbase64ç¼–ç çš„å›¾ç‰‡
    buffer = io.BytesIO()
    plt.savefig(buffer, format='jpg', dpi=300)
    return base64.b64encode(buffer.getvalue()).decode()
</code></pre>
<p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(m)ï¼Œå…¶ä¸­mä¸ºç»„ç»‡æ•°<br />
<strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(1)</p>
<h4 id="143">1.4.3 ä»£ç æ¶æ„<a class="headerlink" href="#143" title="Permanent link">&para;</a></h4>
<p><strong>ç±»ç»“æ„</strong>ï¼š</p>
<pre><code class="language-python">class GeneSearchAPI:
    def __init__(self):
        self.load_data_to_mongodb()  # åˆå§‹åŒ–æ—¶åŠ è½½æ•°æ®
        self.all_genes = self.load_all_genes()  # è·å–æ‰€æœ‰åŸºå› ç¬¦å·

    def load_data_to_mongodb(self):
        &quot;&quot;&quot;æ•°æ®åŠ è½½é€»è¾‘&quot;&quot;&quot;

    def load_all_genes(self) -&gt; List[str]:
        &quot;&quot;&quot;è·å–æ‰€æœ‰åŸºå› ç¬¦å·ï¼ˆç”¨äºè‡ªåŠ¨è¡¥å…¨ï¼‰&quot;&quot;&quot;

    def search_gene_data(self, gene_symbol: str) -&gt; List[Dict]:
        &quot;&quot;&quot;æœç´¢åŸºå› æ•°æ®&quot;&quot;&quot;

    def create_fold_change_plot(self, gene_symbol: str) -&gt; str:
        &quot;&quot;&quot;ç”ŸæˆFold Changeå›¾&quot;&quot;&quot;

    def create_lsmean_control_plot(self, gene_symbol: str) -&gt; str:
        &quot;&quot;&quot;ç”Ÿæˆå¯¹ç…§ç»„LSMeanå›¾&quot;&quot;&quot;

    def create_lsmean_10mgkg_plot(self, gene_symbol: str) -&gt; str:
        &quot;&quot;&quot;ç”Ÿæˆå¤„ç†ç»„LSMeanå›¾&quot;&quot;&quot;
</code></pre>
<p><strong>APIç«¯ç‚¹</strong>ï¼š<br />
- <code>GET /api/gene/symbol/search?gene_symbol=GAPDH</code>ï¼šæœç´¢åŸºå› <br />
- <code>GET /api/gene/symbols</code>ï¼šè·å–æ‰€æœ‰åŸºå› ç¬¦å·<br />
- <code>GET /api/gene/symbol/showFoldChange?gene_symbol=GAPDH</code>ï¼šè·å–Fold Changeå›¾<br />
- <code>GET /api/gene/symbol/showLSMeanControl?gene_symbol=GAPDH</code>ï¼šè·å–å¯¹ç…§ç»„å›¾<br />
- <code>GET /api/gene/symbol/showLSMeanTenMgKg?gene_symbol=GAPDH</code>ï¼šè·å–å¤„ç†ç»„å›¾</p>
<h3 id="15">1.5 å±€é™æ€§<a class="headerlink" href="#15" title="Permanent link">&para;</a></h3>
<h4 id="151">1.5.1 æ•°æ®å±€é™æ€§<a class="headerlink" href="#151" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>æ•°æ®æ¥æºå•ä¸€</strong>ï¼š</li>
<li>ç›®å‰ä»…åŒ…å«ç‰¹å®šå®éªŒæ¡ä»¶ä¸‹çš„æ•°æ®</li>
<li>æ•°æ®æ—¶é—´ç‚¹å›ºå®šï¼ˆ10mg/kgå¤„ç†ï¼‰</li>
<li>
<p>ç¼ºä¹æ—¶é—´åºåˆ—æ•°æ®</p>
</li>
<li>
<p><strong>ç»„ç»‡è¦†ç›–æœ‰é™</strong>ï¼š</p>
</li>
<li>ä»…åŒ…å«9ä¸ªç»„ç»‡/å™¨å®˜</li>
<li>ç¼ºä¹ç»†èƒç±»å‹ç‰¹å¼‚æ€§æ•°æ®</li>
<li>
<p>ç¼ºä¹å‘è‚²é˜¶æ®µç‰¹å¼‚æ€§æ•°æ®</p>
</li>
<li>
<p><strong>ç»Ÿè®¡æŒ‡æ ‡å›ºå®š</strong>ï¼š</p>
</li>
<li>ä»…åŒ…å«På€¼ã€FDRã€Fold Changeç­‰åŸºæœ¬æŒ‡æ ‡</li>
<li>ç¼ºä¹æ›´é«˜çº§çš„ç»Ÿè®¡æŒ‡æ ‡ï¼ˆå¦‚æ•ˆåº”é‡ã€ç½®ä¿¡åŒºé—´ç­‰ï¼‰</li>
</ol>
<h4 id="152">1.5.2 åŠŸèƒ½å±€é™æ€§<a class="headerlink" href="#152" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>æœç´¢åŠŸèƒ½</strong>ï¼š</li>
<li>ä»…æ”¯æŒç²¾ç¡®åŒ¹é…å’Œå¤§å°å†™ä¸æ•æ„ŸåŒ¹é…</li>
<li>ä¸æ”¯æŒæ¨¡ç³Šæœç´¢æˆ–åŒä¹‰è¯åŒ¹é…</li>
<li>
<p>ä¸æ”¯æŒæ‰¹é‡æœç´¢</p>
</li>
<li>
<p><strong>å¯è§†åŒ–</strong>ï¼š</p>
</li>
<li>å›¾è¡¨ç±»å‹å›ºå®šï¼ˆä»…æŸ±çŠ¶å›¾ï¼‰</li>
<li>ä¸æ”¯æŒäº¤äº’å¼å›¾è¡¨</li>
<li>
<p>ä¸æ”¯æŒæ•°æ®å¯¼å‡º</p>
</li>
<li>
<p><strong>æ¯”è¾ƒåˆ†æ</strong>ï¼š</p>
</li>
<li>ä¸æ”¯æŒå¤šåŸºå› åŒæ—¶æ¯”è¾ƒ</li>
<li>ä¸æ”¯æŒè·¨å®éªŒæ¡ä»¶æ¯”è¾ƒ</li>
<li>ç¼ºä¹ç»Ÿè®¡åˆ†æåŠŸèƒ½ï¼ˆå¦‚é…å¯¹tæ£€éªŒï¼‰</li>
</ol>
<h4 id="153">1.5.3 æŠ€æœ¯å±€é™æ€§<a class="headerlink" href="#153" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>æ€§èƒ½</strong>ï¼š</li>
<li>å¤§é‡æ•°æ®åŠ è½½æ—¶å¯èƒ½è¾ƒæ…¢</li>
<li>å›¾è¡¨ç”Ÿæˆéœ€è¦æ—¶é—´ï¼ˆç‰¹åˆ«æ˜¯é«˜åˆ†è¾¨ç‡å›¾ç‰‡ï¼‰</li>
<li>
<p>ç¼ºä¹ç¼“å­˜æœºåˆ¶</p>
</li>
<li>
<p><strong>å¯æ‰©å±•æ€§</strong>ï¼š</p>
</li>
<li>æ•°æ®æ¨¡å‹å›ºå®šï¼Œéš¾ä»¥æ‰©å±•æ–°å­—æ®µ</li>
<li>ç¼ºä¹ç‰ˆæœ¬æ§åˆ¶</li>
<li>
<p>ä¸æ”¯æŒæ•°æ®æ›´æ–°å†å²è¿½è¸ª</p>
</li>
<li>
<p><strong>æ•°æ®è´¨é‡</strong>ï¼š</p>
</li>
<li>ç¼ºä¹æ•°æ®éªŒè¯æœºåˆ¶</li>
<li>ç¼ºä¹å¼‚å¸¸å€¼æ£€æµ‹</li>
<li>ç¼ºä¹æ•°æ®å®Œæ•´æ€§æ£€æŸ¥</li>
</ol>
<hr />
<h2 id="theme-analysis-system">æ¨¡å—äºŒï¼šä¸»é¢˜åˆ†æç³»ç»Ÿï¼ˆTheme Analysis Systemï¼‰<a class="headerlink" href="#theme-analysis-system" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 è¿™æ˜¯ä»€ä¹ˆï¼Ÿ<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<p>ä¸»é¢˜åˆ†æç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºåŸºå› æœ¬ä½“ï¼ˆGene Ontology, GOï¼‰çš„åŠŸèƒ½å¯Œé›†åˆ†æå¹³å°ï¼Œé€šè¿‡ä¸»é¢˜ï¼ˆThemeï¼‰æ¦‚å¿µå¯¹GOæœ¯è¯­è¿›è¡Œåˆ†ç»„å’Œèšåˆåˆ†æã€‚ç³»ç»Ÿå°†ç”Ÿç‰©å­¦ç›¸å…³çš„GOæœ¯è¯­å½’ç±»åˆ°é¢„å®šä¹‰æˆ–ç”¨æˆ·è‡ªå®šä¹‰çš„ä¸»é¢˜ä¸­ï¼Œå¸®åŠ©ç ”ç©¶äººå‘˜ç†è§£åŸºå› é›†åˆçš„ç”Ÿç‰©å­¦åŠŸèƒ½ã€‚</p>
<h3 id="22">2.2 èƒ½åšä»€ä¹ˆï¼Ÿ<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<h4 id="221">2.2.1 æ ¸å¿ƒåŠŸèƒ½<a class="headerlink" href="#221" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>åŸºå› æœ¬ä½“å¯Œé›†åˆ†æ</strong>ï¼š</li>
<li>è¾“å…¥åŸºå› åˆ—è¡¨ï¼ˆ.txtæ–‡ä»¶ï¼‰</li>
<li>é€šè¿‡GProfiler APIè¿›è¡Œå¯Œé›†åˆ†æ</li>
<li>
<p>è¿”å›æ˜¾è‘—å¯Œé›†çš„GOæœ¯è¯­ï¼ˆBPã€MFã€CCï¼‰</p>
</li>
<li>
<p><strong>ä¸»é¢˜åˆ†é…</strong>ï¼š</p>
</li>
<li>åŸºäºå…³é”®è¯åŒ¹é…ï¼Œå°†GOæœ¯è¯­åˆ†é…åˆ°é¢„å®šä¹‰ä¸»é¢˜</li>
<li>
<p>æ”¯æŒä¸‰ä¸ªGOç±»åˆ«ï¼š</p>
<ul>
<li><strong>Biological Process (BP)</strong>ï¼šç”Ÿç‰©å­¦è¿‡ç¨‹</li>
<li><strong>Molecular Function (MF)</strong>ï¼šåˆ†å­åŠŸèƒ½</li>
<li><strong>Cellular Component (CC)</strong>ï¼šç»†èƒç»„åˆ†</li>
</ul>
</li>
<li>
<p><strong>ä¸»é¢˜èšåˆ</strong>ï¼š</p>
</li>
<li>å°†åŒä¸€ä¸»é¢˜å†…çš„GOæœ¯è¯­åˆ†æ•°èšåˆ</li>
<li>è®¡ç®—ç´¯ç§¯åˆ†æ•°ï¼ˆCumulative Scoreï¼‰</li>
<li>
<p>ç”Ÿæˆä¸»é¢˜æ±‡æ€»å›¾è¡¨</p>
</li>
<li>
<p><strong>å¯è§†åŒ–</strong>ï¼š</p>
</li>
<li><strong>ä¸»é¢˜æ±‡æ€»å›¾</strong>ï¼šå±•ç¤ºæ‰€æœ‰ä¸»é¢˜çš„ç´¯ç§¯åˆ†æ•°</li>
<li><strong>ä¸»é¢˜è¯¦ç»†å›¾</strong>ï¼šå±•ç¤ºç‰¹å®šä¸»é¢˜å†…æ‰€æœ‰GOæœ¯è¯­çš„åˆ†æ•°</li>
<li>
<p>æ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜é¢œè‰²å’Œæ ·å¼</p>
</li>
<li>
<p><strong>è‡ªå®šä¹‰ä¸»é¢˜</strong>ï¼š</p>
</li>
<li>ç”¨æˆ·å¯ä»¥æ·»åŠ è‡ªå®šä¹‰ä¸»é¢˜</li>
<li>å®šä¹‰ä¸»é¢˜åç§°ã€æè¿°å’Œå…³é”®è¯</li>
<li>å®æ—¶åº”ç”¨åˆ°åˆ†æä¸­</li>
</ol>
<h4 id="222">2.2.2 é¢„å®šä¹‰ä¸»é¢˜ç¤ºä¾‹<a class="headerlink" href="#222" title="Permanent link">&para;</a></h4>
<p><strong>Biological Process (BP)</strong>ï¼š<br />
- Inflammation &amp; immune signaling<br />
- Stress &amp; cytokine response<br />
- Cell-cycle &amp; Apoptosis<br />
- Metabolic re-wiring<br />
- Oxidative stress &amp; redox regulation<br />
- Neuronal Excitability &amp; Synapse</p>
<p><strong>Molecular Function (MF)</strong>ï¼š<br />
- Kinase activity<br />
- Transcription factor activity<br />
- Receptor binding<br />
- Enzyme activity<br />
- Ion channel activity</p>
<p><strong>Cellular Component (CC)</strong>ï¼š<br />
- Mitochondrion<br />
- Nucleus<br />
- Membrane<br />
- Cytoskeleton<br />
- Endoplasmic reticulum</p>
<h4 id="223">2.2.3 åº”ç”¨åœºæ™¯<a class="headerlink" href="#223" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>å·®å¼‚è¡¨è¾¾åŸºå› åˆ†æ</strong>ï¼šç†è§£å·®å¼‚è¡¨è¾¾åŸºå› å‚ä¸çš„ç”Ÿç‰©å­¦è¿‡ç¨‹</li>
<li><strong>é€šè·¯åˆ†æ</strong>ï¼šè¯†åˆ«æ˜¾è‘—æ¿€æ´»æˆ–æŠ‘åˆ¶çš„ä¿¡å·é€šè·¯</li>
<li><strong>åŠŸèƒ½é¢„æµ‹</strong>ï¼šé¢„æµ‹æœªçŸ¥åŸºå› çš„æ½œåœ¨åŠŸèƒ½</li>
<li><strong>ç–¾ç—…æœºåˆ¶ç ”ç©¶</strong>ï¼šç†è§£ç–¾ç—…ç›¸å…³çš„ç”Ÿç‰©å­¦è¿‡ç¨‹</li>
</ul>
<h3 id="23">2.3 ä¸ºä»€ä¹ˆè¦åšï¼Ÿ<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<h4 id="231">2.3.1 ç ”ç©¶éœ€æ±‚<a class="headerlink" href="#231" title="Permanent link">&para;</a></h4>
<p>åœ¨åŸºå› è¡¨è¾¾åˆ†æä¸­ï¼Œç ”ç©¶äººå‘˜ç»å¸¸é‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼š<br />
1. <strong>ç»“æœè§£è¯»å›°éš¾</strong>ï¼šGOå¯Œé›†åˆ†æè¿”å›å¤§é‡GOæœ¯è¯­ï¼Œéš¾ä»¥ç†è§£æ•´ä½“ç”Ÿç‰©å­¦æ„ä¹‰<br />
2. <strong>ä¿¡æ¯è¿‡è½½</strong>ï¼šæ•°ç™¾ä¸ªæ˜¾è‘—å¯Œé›†çš„GOæœ¯è¯­ï¼Œç¼ºä¹ä¼˜å…ˆçº§æ’åº<br />
3. <strong>ä¸»é¢˜è¯†åˆ«</strong>ï¼šéœ€è¦äººå·¥è¯†åˆ«å“ªäº›GOæœ¯è¯­å±äºåŒä¸€ç”Ÿç‰©å­¦ä¸»é¢˜<br />
4. <strong>ç»“æœå±•ç¤º</strong>ï¼šä¼ ç»Ÿçš„è¡¨æ ¼å±•ç¤ºä¸ç›´è§‚ï¼Œéš¾ä»¥å‘ä»–äººè§£é‡Š</p>
<h4 id="232">2.3.2 ç°æœ‰æ–¹æ¡ˆçš„ä¸è¶³<a class="headerlink" href="#232" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>GProfilerç­‰å·¥å…·</strong>ï¼š</li>
<li>è¿”å›å¤§é‡GOæœ¯è¯­ï¼Œç¼ºä¹èšåˆ</li>
<li>ç»“æœä»¥è¡¨æ ¼å½¢å¼å‘ˆç°ï¼Œä¸ç›´è§‚</li>
<li>
<p>éœ€è¦æ‰‹åŠ¨æ•´ç†å’Œè§£é‡Š</p>
</li>
<li>
<p><strong>DAVIDç­‰å·¥å…·</strong>ï¼š</p>
</li>
<li>åŠŸèƒ½æœ‰é™ï¼Œä¸»é¢˜åˆ†ç±»ä¸å¤Ÿçµæ´»</li>
<li>ä¸æ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜</li>
<li>å¯è§†åŒ–èƒ½åŠ›æœ‰é™</li>
</ol>
<h4 id="233">2.3.3 æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆ<a class="headerlink" href="#233" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>ä¸»é¢˜èšåˆ</strong>ï¼šå°†ç›¸å…³GOæœ¯è¯­å½’ç±»åˆ°ä¸»é¢˜ä¸­ï¼Œç®€åŒ–ç»“æœè§£è¯»</li>
<li><strong>å¯è§†åŒ–å¢å¼º</strong>ï¼šç”Ÿæˆä¸“ä¸šçš„å›¾è¡¨ï¼Œç›´è§‚å±•ç¤ºåˆ†æç»“æœ</li>
<li><strong>è‡ªå®šä¹‰ä¸»é¢˜</strong>ï¼šæ”¯æŒç”¨æˆ·æ ¹æ®ç ”ç©¶éœ€æ±‚å®šä¹‰ä¸»é¢˜</li>
<li><strong>åˆ†æ•°èšåˆ</strong>ï¼šç´¯ç§¯åˆ†æ•°å¸®åŠ©è¯†åˆ«æœ€é‡è¦çš„ç”Ÿç‰©å­¦ä¸»é¢˜</li>
</ul>
<h3 id="24">2.4 å¦‚ä½•å®ç°ï¼Ÿ<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<h4 id="241">2.4.1 æ•°å­¦æ–¹æ³•<a class="headerlink" href="#241" title="Permanent link">&para;</a></h4>
<p><strong>1. å¯Œé›†åˆ†æç»Ÿè®¡æ£€éªŒ</strong></p>
<p>ä½¿ç”¨è¶…å‡ ä½•åˆ†å¸ƒï¼ˆHypergeometric Distributionï¼‰è¿›è¡Œå¯Œé›†åˆ†æï¼š</p>
<p>è®¾ï¼š<br />
- $N$ = èƒŒæ™¯åŸºå› æ€»æ•°ï¼ˆå‚è€ƒåŸºå› ç»„ä¸­çš„åŸºå› æ•°ï¼‰<br />
- $M$ = èƒŒæ™¯ä¸­å±äºæŸä¸ªGOæœ¯è¯­çš„åŸºå› æ•°<br />
- $n$ = è¾“å…¥çš„åŸºå› åˆ—è¡¨é•¿åº¦<br />
- $k$ = è¾“å…¥çš„åŸºå› åˆ—è¡¨ä¸­å±äºè¯¥GOæœ¯è¯­çš„åŸºå› æ•°</p>
<p>åˆ™å¯Œé›†çš„På€¼è®¡ç®—ä¸ºï¼š</p>
<p>$$P(X \geq k) = \sum_{i=k}^{min(n, M)} \frac{\binom{M}{i} \binom{N-M}{n-i}}{\binom{N}{n}}$$</p>
<p>è¿™è¡¨ç¤ºéšæœºé€‰æ‹©$n$ä¸ªåŸºå› æ—¶ï¼Œè‡³å°‘æœ‰$k$ä¸ªå±äºè¯¥GOæœ¯è¯­çš„æ¦‚ç‡ã€‚</p>
<p><strong>2. å¤šé‡æ¯”è¾ƒæ ¡æ­£</strong></p>
<p>ä½¿ç”¨FDRï¼ˆFalse Discovery Rateï¼‰æ–¹æ³•è¿›è¡Œå¤šé‡æ¯”è¾ƒæ ¡æ­£ï¼š</p>
<p>$$FDR = \frac{FP}{FP + TP}$$</p>
<p>å…¶ä¸­ï¼š<br />
- $FP$ = å‡é˜³æ€§æ•°<br />
- $TP$ = çœŸé˜³æ€§æ•°</p>
<p>å¸¸ç”¨æ–¹æ³•åŒ…æ‹¬ï¼š<br />
- <strong>Benjamini-Hochberg (BH)</strong><br />
- <strong>Bonferroni</strong><br />
- <strong>FDR step-up</strong></p>
<p><strong>3. åˆ†æ•°è®¡ç®—</strong></p>
<p>å¯¹äºæ¯ä¸ªGOæœ¯è¯­ï¼Œè®¡ç®—åˆ†æ•°ï¼š</p>
<p>$$Score = -\log_{10}(p_value)$$</p>
<p>è¿™ä¸ªåˆ†æ•°è¶Šå¤§ï¼Œè¡¨ç¤ºå¯Œé›†è¶Šæ˜¾è‘—ã€‚</p>
<p><strong>4. ä¸»é¢˜èšåˆ</strong></p>
<p>å¯¹äºä¸»é¢˜$T$ï¼ŒåŒ…å«çš„GOæœ¯è¯­é›†åˆä¸º${GO_1, GO_2, ..., GO_n}$ï¼Œåˆ™ä¸»é¢˜çš„ç´¯ç§¯åˆ†æ•°ä¸ºï¼š</p>
<p>$$Cumulative_Score(T) = \sum_{i=1}^{n} Score(GO_i) = \sum_{i=1}^{n} -\log_{10}(p_i)$$</p>
<p>è¿™ç­‰ä»·äºï¼š</p>
<p>$$Cumulative_Score(T) = -\log_{10}\left(\prod_{i=1}^{n} p_i\right)$$</p>
<p>å› æ­¤ï¼Œç´¯ç§¯åˆ†æ•°åæ˜ äº†è¯¥ä¸»é¢˜æ•´ä½“å¯Œé›†çš„æ˜¾è‘—æ€§ã€‚</p>
<p><strong>5. å…³é”®è¯åŒ¹é…ç®—æ³•</strong></p>
<p>ä¸»é¢˜åˆ†é…åŸºäºå…³é”®è¯åŒ¹é…ï¼š</p>
<pre><code class="language-python">def assign_theme(self, go_term_name: str) -&gt; Optional[str]:
    &quot;&quot;&quot;åŸºäºå…³é”®è¯åŒ¹é…åˆ†é…ä¸»é¢˜&quot;&quot;&quot;
    go_term_lower = go_term_name.lower()

    for theme_name, keywords in themes.items():
        for keyword in keywords:
            if keyword.lower() in go_term_lower:
                return theme_name  # è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä¸»é¢˜

    return None  # æ— åŒ¹é…
</code></pre>
<p><strong>åŒ¹é…è§„åˆ™</strong>ï¼š<br />
- å¤§å°å†™ä¸æ•æ„Ÿ<br />
- å­å­—ç¬¦ä¸²åŒ¹é…ï¼ˆä¸æ˜¯ç²¾ç¡®åŒ¹é…ï¼‰<br />
- å¤šä¸ªåŒ¹é…æ—¶è¿”å›ç¬¬ä¸€ä¸ªï¼ˆä¼˜å…ˆçº§ï¼‰</p>
<h4 id="242">2.4.2 ä»£ç å®ç°<a class="headerlink" href="#242" title="Permanent link">&para;</a></h4>
<p><strong>1. æ ¸å¿ƒç±»ç»“æ„</strong></p>
<pre><code class="language-python">class GeneOntologyAPI:
    def __init__(self):
        self.gp = GProfiler(return_dataframe=True)  # GProfilerå®¢æˆ·ç«¯
        self.themes = {
            'Inflammation &amp; immune signaling': [
                'inflammatory', 'immune', 'interleukin', 'cytokine',
                'chemokine', 'toll-like', 'nf-kappa', 'tnf', 'ifn'
            ],
            # ... æ›´å¤šä¸»é¢˜
        }

    def load_genes_from_file(self, file_content: str) -&gt; List[str]:
        &quot;&quot;&quot;ä»æ–‡ä»¶å†…å®¹ä¸­åŠ è½½åŸºå› åˆ—è¡¨&quot;&quot;&quot;
        genes = []
        for line in file_content.strip().split('\n'):
            gene = line.strip()
            if gene:
                genes.append(gene)
        return genes

    def enrich(self, genes: List[str], p_thresh: float = 1e-2) -&gt; pd.DataFrame:
        &quot;&quot;&quot;æ‰§è¡Œå¯Œé›†åˆ†æ&quot;&quot;&quot;
        # è°ƒç”¨GProfiler API
        df = self.gp.profile(
            organism=&quot;mmusculus&quot;,  # å°é¼ 
            query=genes
        )

        # è¿‡æ»¤På€¼
        df = df[df[&quot;p_value&quot;] &lt; p_thresh].sort_values(&quot;p_value&quot;)

        # è®¡ç®—åˆ†æ•°
        df[&quot;Score&quot;] = -np.log10(df[&quot;p_value&quot;])

        return df

    def assign_theme(self, name: str) -&gt; Optional[str]:
        &quot;&quot;&quot;åˆ†é…ä¸»é¢˜&quot;&quot;&quot;
        low = name.lower()
        for theme, keywords in self.themes.items():
            for kw in keywords:
                if kw.lower() in low:
                    return theme
        return None

    def aggregate(self, df: pd.DataFrame) -&gt; pd.DataFrame:
        &quot;&quot;&quot;ä¸»é¢˜èšåˆ&quot;&quot;&quot;
        # åˆ†é…ä¸»é¢˜
        df[&quot;Theme&quot;] = df[&quot;name&quot;].apply(self.assign_theme)

        # è¿‡æ»¤æœ‰ä¸»é¢˜çš„GOæœ¯è¯­
        themed_df = df.dropna(subset=[&quot;Theme&quot;])

        # æŒ‰ä¸»é¢˜èšåˆ
        aggregated = themed_df.groupby(&quot;Theme&quot;).agg(
            Score=(&quot;Score&quot;, &quot;sum&quot;),  # ç´¯ç§¯åˆ†æ•°
            Terms=(&quot;Theme&quot;, &quot;count&quot;)  # GOæœ¯è¯­æ•°é‡
        ).sort_values(&quot;Score&quot;, ascending=False)

        return aggregated
</code></pre>
<p><strong>2. å¯è§†åŒ–å®ç°</strong></p>
<pre><code class="language-python">def create_summary_chart(self, themed_df: pd.DataFrame) -&gt; str:
    &quot;&quot;&quot;åˆ›å»ºä¸»é¢˜æ±‡æ€»å›¾&quot;&quot;&quot;
    # è®¡ç®—å›¾è¡¨å°ºå¯¸
    fig_width = 12
    fig_height = max(8, 0.4 * len(themed_df))

    fig, ax = plt.subplots(figsize=(fig_width, fig_height))

    # æ’åº
    themed_df_sorted = themed_df.sort_values(&quot;Score&quot;, ascending=True)

    # å®šä¹‰é¢œè‰²
    colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', ...]  # 20ç§é¢œè‰²

    # ç»˜åˆ¶æ°´å¹³æŸ±çŠ¶å›¾
    bars = ax.barh(
        themed_df_sorted.index,
        themed_df_sorted[&quot;Score&quot;],
        color=colors[:len(themed_df_sorted)],
        alpha=0.9,
        height=0.7
    )

    # æ·»åŠ æ•°å€¼æ ‡ç­¾
    for i, (theme, score) in enumerate(zip(themed_df_sorted.index, themed_df_sorted[&quot;Score&quot;])):
        ax.text(score + 1, i, f'{score:.1f}', va='center', fontweight='bold')

    ax.set_xlabel(&quot;Cumulative Score (-log10(p-value))&quot;)
    ax.set_title(&quot;Gene Ontology Analysis Summary by Theme&quot;)

    # è½¬æ¢ä¸ºbase64
    buffer = io.BytesIO()
    plt.savefig(buffer, format='png', dpi=300, bbox_inches='tight')
    return base64.b64encode(buffer.getvalue()).decode()
</code></pre>
<p><strong>3. è‡ªå®šä¹‰ä¸»é¢˜å®ç°</strong></p>
<pre><code class="language-python">@app.post(&quot;/api/ontology/custom-analyze&quot;)
async def custom_analyze(
    file: UploadFile = File(...),
    selected_themes: str = Form(...),
    custom_themes: Optional[str] = Form(None)  # JSONå­—ç¬¦ä¸²
):
    &quot;&quot;&quot;æ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜çš„åˆ†æ&quot;&quot;&quot;
    # è§£æè‡ªå®šä¹‰ä¸»é¢˜
    if custom_themes:
        custom_theme_data = json.loads(custom_themes)

        # ä¿å­˜åŸå§‹ä¸»é¢˜
        original_themes = ontology_api.themes.copy()

        # ä¸´æ—¶æ·»åŠ è‡ªå®šä¹‰ä¸»é¢˜
        for custom_theme in custom_theme_data:
            theme_name = custom_theme.get('name')
            keywords = custom_theme.get('keywords', [])
            ontology_api.themes[theme_name] = keywords

    # æ‰§è¡Œåˆ†æ
    try:
        # ... åˆ†æé€»è¾‘
        pass
    finally:
        # æ¢å¤åŸå§‹ä¸»é¢˜
        if custom_themes:
            ontology_api.themes = original_themes
</code></pre>
<h4 id="243-api">2.4.3 APIç«¯ç‚¹<a class="headerlink" href="#243-api" title="Permanent link">&para;</a></h4>
<ul>
<li><code>POST /api/ontology/analyze</code>ï¼šæ ‡å‡†å¯Œé›†åˆ†æ</li>
<li><code>POST /api/ontology/custom-analyze</code>ï¼šæ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜çš„åˆ†æ</li>
<li><code>POST /api/ontology/custom-summary-chart</code>ï¼šç”Ÿæˆè‡ªå®šä¹‰ä¸»é¢˜æ±‡æ€»å›¾</li>
<li><code>POST /api/ontology/theme-chart</code>ï¼šç”Ÿæˆç‰¹å®šä¸»é¢˜çš„è¯¦ç»†å›¾</li>
</ul>
<h3 id="25">2.5 å±€é™æ€§<a class="headerlink" href="#25" title="Permanent link">&para;</a></h3>
<h4 id="251">2.5.1 æ–¹æ³•å­¦å±€é™æ€§<a class="headerlink" href="#251" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>ä¸»é¢˜åˆ†é…çš„å‡†ç¡®æ€§</strong>ï¼š</li>
<li>åŸºäºå…³é”®è¯åŒ¹é…ï¼Œå¯èƒ½äº§ç”Ÿè¯¯åˆ†é…</li>
<li>åŒä¸€ä¸ªGOæœ¯è¯­å¯èƒ½åŒ¹é…å¤šä¸ªä¸»é¢˜ï¼ˆä½†åªè¿”å›ç¬¬ä¸€ä¸ªï¼‰</li>
<li>
<p>æŸäº›GOæœ¯è¯­å¯èƒ½æ— æ³•åŒ¹é…åˆ°ä»»ä½•ä¸»é¢˜</p>
</li>
<li>
<p><strong>åˆ†æ•°èšåˆçš„åˆç†æ€§</strong>ï¼š</p>
</li>
<li>ç´¯ç§¯åˆ†æ•°å‡è®¾æ‰€æœ‰GOæœ¯è¯­åŒç­‰é‡è¦</li>
<li>ä¸è€ƒè™‘GOæœ¯è¯­ä¹‹é—´çš„å±‚æ¬¡å…³ç³»</li>
<li>
<p>ä¸»é¢˜å†…GOæœ¯è¯­æ•°é‡ä¸åŒï¼Œå¯èƒ½äº§ç”Ÿåå·®</p>
</li>
<li>
<p><strong>ç»Ÿè®¡æ£€éªŒçš„å±€é™æ€§</strong>ï¼š</p>
</li>
<li>å‡è®¾åŸºå› é—´ç›¸äº’ç‹¬ç«‹ï¼ˆå®é™…ä¸Šå¯èƒ½ç›¸å…³ï¼‰</li>
<li>èƒŒæ™¯åŸºå› é›†çš„é€‰æ‹©å½±å“ç»“æœ</li>
<li>På€¼é˜ˆå€¼çš„é€‰æ‹©ä¸»è§‚</li>
</ol>
<h4 id="252">2.5.2 åŠŸèƒ½å±€é™æ€§<a class="headerlink" href="#252" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>ä¸»é¢˜å®šä¹‰</strong>ï¼š</li>
<li>é¢„å®šä¹‰ä¸»é¢˜å¯èƒ½ä¸é€‚åˆæ‰€æœ‰ç ”ç©¶åœºæ™¯</li>
<li>å…³é”®è¯åˆ—è¡¨éœ€è¦äººå·¥ç»´æŠ¤å’Œæ›´æ–°</li>
<li>
<p>ç¼ºä¹ä¸»é¢˜éªŒè¯æœºåˆ¶</p>
</li>
<li>
<p><strong>å¯è§†åŒ–</strong>ï¼š</p>
</li>
<li>å›¾è¡¨ç±»å‹å›ºå®šï¼ˆä»…æ°´å¹³æŸ±çŠ¶å›¾ï¼‰</li>
<li>ä¸æ”¯æŒäº¤äº’å¼æ¢ç´¢</li>
<li>
<p>ä¸æ”¯æŒGOå±‚æ¬¡ç»“æ„å¯è§†åŒ–</p>
</li>
<li>
<p><strong>ç»“æœå¯¼å‡º</strong>ï¼š</p>
</li>
<li>ä»…æ”¯æŒå›¾ç‰‡å¯¼å‡º</li>
<li>ä¸æ”¯æŒæ•°æ®è¡¨æ ¼å¯¼å‡º</li>
<li>ç¼ºä¹è¯¦ç»†çš„ç»Ÿè®¡æŠ¥å‘Š</li>
</ol>
<h4 id="253">2.5.3 æŠ€æœ¯å±€é™æ€§<a class="headerlink" href="#253" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>GProfilerä¾èµ–</strong>ï¼š</li>
<li>ä¾èµ–å¤–éƒ¨APIï¼Œç½‘ç»œé—®é¢˜å¯èƒ½å½±å“åˆ†æ</li>
<li>APIè°ƒç”¨æœ‰é¢‘ç‡é™åˆ¶</li>
<li>
<p>ç»“æœæ ¼å¼å›ºå®šï¼Œéš¾ä»¥å®šåˆ¶</p>
</li>
<li>
<p><strong>æ€§èƒ½</strong>ï¼š</p>
</li>
<li>å¤§é‡åŸºå› åˆ—è¡¨ï¼ˆ&gt;1000ï¼‰åˆ†æè¾ƒæ…¢</li>
<li>ä¸»é¢˜åŒ¹é…ç®—æ³•æ•ˆç‡å¯ä»¥ä¼˜åŒ–ï¼ˆç›®å‰O(n<em>m</em>k)ï¼‰</li>
<li>
<p>ç¼ºä¹ç¼“å­˜æœºåˆ¶</p>
</li>
<li>
<p><strong>å¯æ‰©å±•æ€§</strong>ï¼š</p>
</li>
<li>ä¸»é¢˜æ•°æ®ç¡¬ç¼–ç åœ¨ä»£ç ä¸­</li>
<li>ç¼ºä¹ä¸»é¢˜ç®¡ç†ç•Œé¢</li>
<li>ä¸æ”¯æŒä¸»é¢˜å¯¼å…¥/å¯¼å‡º</li>
</ol>
<hr />
<h2 id="ivcca-inter-variability-cross-correlation-analysis">æ¨¡å—ä¸‰ï¼šIVCCA åˆ†æç³»ç»Ÿï¼ˆInter-Variability Cross-Correlation Analysisï¼‰<a class="headerlink" href="#ivcca-inter-variability-cross-correlation-analysis" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 è¿™æ˜¯ä»€ä¹ˆï¼Ÿ<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<p>IVCCAï¼ˆInter-Variability Cross-Correlation Analysisï¼Œè·¨å˜å¼‚æ€§äº¤å‰ç›¸å…³åˆ†æï¼‰æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„åŸºå› ç›¸å…³æ€§åˆ†æå¹³å°ï¼Œç”¨äºè¯†åˆ«åŸºå› é—´çš„å…±è¡¨è¾¾æ¨¡å¼ã€æ„å»ºåŸºå› è°ƒæ§ç½‘ç»œã€åˆ†æä¿¡å·é€šè·¯æ¿€æ´»ï¼Œå¹¶å‘ç°æ½œåœ¨çš„ç”Ÿç‰©å­¦è¿‡ç¨‹ã€‚è¯¥å¹³å°æ˜¯MATLABç‰ˆæœ¬IVCCAçš„Pythonå®ç°ï¼Œæä¾›äº†å®Œæ•´çš„ç›¸å…³æ€§åˆ†æå·¥å…·å¥—ä»¶ã€‚</p>
<h3 id="32">3.2 èƒ½åšä»€ä¹ˆï¼Ÿ<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<h4 id="321">3.2.1 æ ¸å¿ƒåŠŸèƒ½<a class="headerlink" href="#321" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>ç›¸å…³æ€§çŸ©é˜µè®¡ç®—</strong>ï¼š</li>
<li>æ”¯æŒPearsonã€Spearmanã€Kendallç›¸å…³ç³»æ•°</li>
<li>ç”Ÿæˆå®Œæ•´çš„åŸºå› é—´ç›¸å…³æ€§çŸ©é˜µ</li>
<li>
<p>è®¡ç®—På€¼å¹¶è¿›è¡Œç»Ÿè®¡æ£€éªŒ</p>
</li>
<li>
<p><strong>æ•°æ®å¯è§†åŒ–</strong>ï¼š</p>
</li>
<li><strong>ç›¸å…³æ€§çƒ­å›¾</strong>ï¼šå±•ç¤ºç›¸å…³æ€§çŸ©é˜µï¼Œæ”¯æŒæ’åºå’Œèšç±»</li>
<li><strong>ç›¸å…³æ€§åˆ†å¸ƒç›´æ–¹å›¾</strong>ï¼šå±•ç¤ºæ‰€æœ‰åŸºå› å¯¹çš„ç›¸å…³æ€§åˆ†å¸ƒ</li>
<li>
<p><strong>æ’åºçƒ­å›¾</strong>ï¼šæŒ‰ç›¸å…³æ€§å¼ºåº¦æ’åºåçš„çƒ­å›¾</p>
</li>
<li>
<p><strong>èšç±»åˆ†æ</strong>ï¼š</p>
</li>
<li><strong>æœ€ä¼˜èšç±»æ•°ç¡®å®š</strong>ï¼šElbowæ–¹æ³•å’ŒSilhouetteåˆ†æ</li>
<li><strong>å±‚æ¬¡èšç±»</strong>ï¼šç”Ÿæˆç³»ç»Ÿæ ‘å›¾ï¼ˆDendrogramï¼‰</li>
<li>
<p><strong>K-meansèšç±»</strong>ï¼šåŸºäºç›¸å…³æ€§è·ç¦»çš„K-meansèšç±»</p>
</li>
<li>
<p><strong>é™ç»´åˆ†æ</strong>ï¼š</p>
</li>
<li><strong>ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰</strong>ï¼šé™ç»´å¹¶å¯è§†åŒ–åŸºå› èšç±»</li>
<li>
<p><strong>t-SNE</strong>ï¼šéçº¿æ€§é™ç»´ï¼Œæ›´å¥½åœ°ä¿ç•™å±€éƒ¨ç»“æ„</p>
</li>
<li>
<p><strong>é€šè·¯åˆ†æ</strong>ï¼š</p>
</li>
<li><strong>å•é€šè·¯åˆ†æ</strong>ï¼šåˆ†æé€šè·¯å†…åŸºå› çš„ç›¸å…³æ€§</li>
<li><strong>å¤šé€šè·¯åˆ†æ</strong>ï¼šæ‰¹é‡åˆ†æå¤šä¸ªé€šè·¯ï¼Œè®¡ç®—CECIå’ŒZ-score</li>
<li><strong>é€šè·¯æ¯”è¾ƒ</strong>ï¼šè®¡ç®—é€šè·¯é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦</li>
<li>
<p><strong>Vennå›¾</strong>ï¼šå¯è§†åŒ–é€šè·¯é—´çš„åŸºå› é‡å </p>
</li>
<li>
<p><strong>ç½‘ç»œåˆ†æ</strong>ï¼š</p>
</li>
<li><strong>2D/3Dç½‘ç»œå›¾</strong>ï¼šå¯è§†åŒ–åŸºå› å…±è¡¨è¾¾ç½‘ç»œ</li>
<li><strong>èŠ‚ç‚¹åº¦åˆ†æ</strong>ï¼šè¯†åˆ«é«˜è¿æ¥åº¦çš„HubåŸºå› </li>
<li><strong>ç›¸å…³æ€§é˜ˆå€¼è¿‡æ»¤</strong>ï¼šåªæ˜¾ç¤ºå¼ºç›¸å…³è¿æ¥</li>
</ol>
<h4 id="322">3.2.2 åº”ç”¨åœºæ™¯<a class="headerlink" href="#322" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>å…±è¡¨è¾¾ç½‘ç»œæ„å»º</strong>ï¼šè¯†åˆ«å…±åŒè°ƒæ§çš„åŸºå› ç¾¤</li>
<li><strong>é€šè·¯æ¿€æ´»åˆ†æ</strong>ï¼šè¯„ä¼°ä¿¡å·é€šè·¯çš„æ¿€æ´»ç¨‹åº¦</li>
<li><strong>HubåŸºå› è¯†åˆ«</strong>ï¼šå‘ç°è°ƒæ§ç½‘ç»œä¸­çš„å…³é”®åŸºå› </li>
<li><strong>è¯ç‰©é¶ç‚¹å‘ç°</strong>ï¼šè¯†åˆ«è¯ç‰©è¯±å¯¼çš„ç›¸å…³æ€§å˜åŒ–</li>
<li><strong>ç–¾ç—…æœºåˆ¶ç ”ç©¶</strong>ï¼šç†è§£ç–¾ç—…ç›¸å…³çš„åŸºå› è°ƒæ§ç½‘ç»œ</li>
</ul>
<h3 id="33">3.3 ä¸ºä»€ä¹ˆè¦åšï¼Ÿ<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<h4 id="331">3.3.1 ç ”ç©¶èƒŒæ™¯<a class="headerlink" href="#331" title="Permanent link">&para;</a></h4>
<p>åœ¨åŸºå› è¡¨è¾¾ç ”ç©¶ä¸­ï¼Œä¼ ç»Ÿçš„å·®å¼‚è¡¨è¾¾åˆ†æåªèƒ½è¯†åˆ«å•ä¸ªåŸºå› çš„å˜åŒ–ï¼Œæ— æ³•æ­ç¤ºåŸºå› é—´çš„ç›¸äº’ä½œç”¨å’Œè°ƒæ§å…³ç³»ã€‚ç›¸å…³æ€§åˆ†æå¯ä»¥å¸®åŠ©ï¼š</p>
<ol>
<li><strong>å‘ç°å…±è¡¨è¾¾æ¨¡å—</strong>ï¼šè¯†åˆ«å…±åŒè¡¨è¾¾çš„åŸºå› ç¾¤ï¼Œå¯èƒ½ä»£è¡¨åŠŸèƒ½æ¨¡å—</li>
<li><strong>æ„å»ºè°ƒæ§ç½‘ç»œ</strong>ï¼šé€šè¿‡ç›¸å…³æ€§æ¨æ–­åŸºå› é—´çš„è°ƒæ§å…³ç³»</li>
<li><strong>ç†è§£é€šè·¯æ¿€æ´»</strong>ï¼šé€šè¿‡é€šè·¯å†…åŸºå› çš„ç›¸å…³æ€§è¯„ä¼°é€šè·¯çŠ¶æ€</li>
<li><strong>è¯†åˆ«å…³é”®åŸºå› </strong>ï¼šé«˜è¿æ¥åº¦çš„åŸºå› å¯èƒ½åœ¨è°ƒæ§ç½‘ç»œä¸­èµ·å…³é”®ä½œç”¨</li>
</ol>
<h4 id="332">3.3.2 ç°æœ‰å·¥å…·çš„ä¸è¶³<a class="headerlink" href="#332" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>MATLAB IVCCA</strong>ï¼š</li>
<li>éœ€è¦MATLABç¯å¢ƒï¼Œä½¿ç”¨é—¨æ§›é«˜</li>
<li>ç¼ºä¹Webç•Œé¢ï¼Œéš¾ä»¥åˆ†äº«å’Œåä½œ</li>
<li>
<p>åŠŸèƒ½åˆ†æ•£ï¼Œç¼ºä¹æ•´åˆ</p>
</li>
<li>
<p><strong>å…¶ä»–å·¥å…·</strong>ï¼š</p>
</li>
<li>WGCNAï¼šåŠŸèƒ½å¼ºå¤§ä½†ä½¿ç”¨å¤æ‚</li>
<li>Cytoscapeï¼šä¸»è¦ç”¨äºç½‘ç»œå¯è§†åŒ–ï¼Œç¼ºä¹åˆ†æåŠŸèƒ½</li>
<li>GSEAï¼šä¸“æ³¨äºé€šè·¯åˆ†æï¼Œç¼ºä¹ç›¸å…³æ€§åˆ†æ</li>
</ol>
<h4 id="333">3.3.3 æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆ<a class="headerlink" href="#333" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Pythonå®ç°</strong>ï¼šæ›´æ˜“éƒ¨ç½²å’Œé›†æˆ</li>
<li><strong>Webç•Œé¢</strong>ï¼šé™ä½ä½¿ç”¨é—¨æ§›ï¼Œæé«˜å¯è®¿é—®æ€§</li>
<li><strong>åŠŸèƒ½æ•´åˆ</strong>ï¼šå°†ç›¸å…³æ€§åˆ†æã€èšç±»ã€é™ç»´ã€é€šè·¯åˆ†ææ•´åˆåœ¨ä¸€ä¸ªå¹³å°</li>
<li><strong>ç®—æ³•ä¿æŒ</strong>ï¼šä¿æŒä¸MATLABç‰ˆæœ¬ç®—æ³•çš„ä¸€è‡´æ€§</li>
</ul>
<h3 id="34">3.4 å¦‚ä½•å®ç°ï¼Ÿ<a class="headerlink" href="#34" title="Permanent link">&para;</a></h3>
<h4 id="341">3.4.1 æ•°å­¦æ–¹æ³•<a class="headerlink" href="#341" title="Permanent link">&para;</a></h4>
<p><strong>1. Pearsonç›¸å…³ç³»æ•°</strong></p>
<p>å¯¹äºä¸¤ä¸ªåŸºå› è¡¨è¾¾å‘é‡ $X = (x_1, x_2, ..., x_n)$ å’Œ $Y = (y_1, y_2, ..., y_n)$ï¼ŒPearsonç›¸å…³ç³»æ•°å®šä¹‰ä¸ºï¼š</p>
<p>$$r_{XY} = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i - \bar{x})^2 \sum_{i=1}^{n}(y_i - \bar{y})^2}}$$</p>
<p>å…¶ä¸­ï¼š<br />
- $\bar{x} = \frac{1}{n}\sum_{i=1}^{n}x_i$ï¼ˆXçš„å‡å€¼ï¼‰<br />
- $\bar{y} = \frac{1}{n}\sum_{i=1}^{n}y_i$ï¼ˆYçš„å‡å€¼ï¼‰</p>
<p><strong>æ€§è´¨</strong>ï¼š<br />
- $r_{XY} \in [-1, 1]$<br />
- $r_{XY} = 1$ï¼šå®Œå…¨æ­£ç›¸å…³<br />
- $r_{XY} = -1$ï¼šå®Œå…¨è´Ÿç›¸å…³<br />
- $r_{XY} = 0$ï¼šæ— çº¿æ€§ç›¸å…³</p>
<p><strong>2. På€¼è®¡ç®—</strong></p>
<p>å¯¹äºPearsonç›¸å…³ç³»æ•°ï¼Œä½¿ç”¨tç»Ÿè®¡é‡è¿›è¡Œæ˜¾è‘—æ€§æ£€éªŒï¼š</p>
<p>$$t = r \sqrt{\frac{n-2}{1-r^2}}$$</p>
<p>tç»Ÿè®¡é‡æœä»è‡ªç”±åº¦ä¸º$(n-2)$çš„tåˆ†å¸ƒï¼Œå¯ä»¥è®¡ç®—På€¼ã€‚</p>
<p><strong>3. ç›¸å…³æ€§çŸ©é˜µæ’åº</strong></p>
<p>è®¡ç®—æ¯ä¸ªåŸºå› çš„å¹³å‡ç»å¯¹ç›¸å…³æ€§ï¼š</p>
<p>$$Q_i = \frac{1}{m-1}\sum_{j=1, j \neq i}^{m} |r_{ij}|$$</p>
<p>å…¶ä¸­$m$ä¸ºåŸºå› æ€»æ•°ã€‚ç„¶åæŒ‰$Q_i$é™åºæ’åºã€‚</p>
<p><strong>4. é€šè·¯ç›¸å…³æ€§æŒ‡æ•°ï¼ˆPCIï¼‰</strong></p>
<p><strong>PCI_Aï¼ˆé€šè·¯å†…ç›¸å…³æ€§ï¼‰</strong>ï¼š</p>
<p>å¯¹äºé€šè·¯$P$ï¼ŒåŒ…å«$k$ä¸ªåŸºå› ï¼Œè®¡ç®—æ¯ä¸ªåŸºå› åœ¨é€šè·¯å†…çš„å¹³å‡ç»å¯¹ç›¸å…³æ€§ï¼š</p>
<p>$$Q_i^{(A)} = \frac{1}{k-1}\sum_{j \in P, j \neq i} |r_{ij}|$$</p>
<p>é€šè·¯å†…å¹³å‡ç›¸å…³æ€§æŒ‡æ•°ï¼š</p>
<p>$$PCI_A = \frac{1}{k}\sum_{i \in P} Q_i^{(A)}$$</p>
<p><strong>PCI_Bï¼ˆå…¨å±€ç›¸å…³æ€§ï¼‰</strong>ï¼š</p>
<p>ä»å…¨å±€æ’åºçš„ç›¸å…³æ€§çŸ©é˜µä¸­æå–é€šè·¯åŸºå› çš„å¹³å‡ç›¸å…³æ€§ï¼š</p>
<p>$$PCI_B = \frac{1}{k}\sum_{i \in P} Q_i^{(global)}$$</p>
<p>å…¶ä¸­$Q_i^{(global)}$æ˜¯åŸºå› $i$åœ¨å…¨å±€æ•°æ®é›†ä¸­çš„å¹³å‡ç»å¯¹ç›¸å…³æ€§ã€‚</p>
<p><strong>5. CECIï¼ˆç›¸å…³æ€§-è¡¨è¾¾å¤åˆæŒ‡æ•°ï¼‰</strong></p>
<p>$$CECI = PAI \times PCI_B \times 100$$</p>
<p>å…¶ä¸­$PAI$ï¼ˆPathway Activation Indexï¼‰ä¸ºï¼š</p>
<p>$$PAI = \frac{k_{found}}{k_{total}}$$</p>
<ul>
<li>$k_{found}$ï¼šæ•°æ®é›†ä¸­å‘ç°çš„é€šè·¯åŸºå› æ•°</li>
<li>$k_{total}$ï¼šé€šè·¯æ€»åŸºå› æ•°</li>
</ul>
<p><strong>6. Z-scoreè®¡ç®—</strong></p>
<p>$$Z = \frac{CECI - \mu_{random}}{\sigma_{random}}$$</p>
<p>å…¶ä¸­ï¼š<br />
- $\mu_{random}$ï¼šéšæœºåŸºå› é›†çš„CECIå‡å€¼ï¼ˆé»˜è®¤7.908ï¼‰<br />
- $\sigma_{random}$ï¼šéšæœºåŸºå› é›†çš„CECIæ ‡å‡†å·®ï¼ˆé»˜è®¤2.0605ï¼‰</p>
<p>å¦‚æœ$|Z| &gt; 1.96$ï¼ˆÎ±=0.05ï¼‰ï¼Œåˆ™è®¤ä¸ºé€šè·¯æ˜¾è‘—æ¿€æ´»æˆ–æŠ‘åˆ¶ã€‚</p>
<p><strong>7. ä½™å¼¦ç›¸ä¼¼åº¦</strong></p>
<p>å¯¹äºä¸¤ä¸ªé€šè·¯$A$å’Œ$B$ï¼Œè®¡ç®—ç›¸å…³æ€§å‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦ï¼š</p>
<p>$$cosine_similarity = \frac{\sum_{i \in A, j \in B} r_{ij}^2}{\sqrt{|A|} \times \sqrt{|B|}}$$</p>
<p>è€ƒè™‘é‡å åŸºå› åï¼š</p>
<p>$$adjusted_cosine = \frac{cosine_similarity + |A \cap B|}{|A \cap B| + 1}$$</p>
<p><strong>8. èšç±»åˆ†æ</strong></p>
<p><strong>K-meansèšç±»</strong>ï¼š</p>
<p>å°†ç›¸å…³æ€§çŸ©é˜µè½¬æ¢ä¸ºè·ç¦»çŸ©é˜µï¼š</p>
<p>$$d_{ij} = 1 - |r_{ij}|$$</p>
<p>ç„¶åä½¿ç”¨K-meansç®—æ³•è¿›è¡Œèšç±»ã€‚</p>
<p><strong>Elbowæ–¹æ³•</strong>ï¼š</p>
<p>è®¡ç®—ä¸åŒKå€¼ä¸‹çš„ç±»å†…å¹³æ–¹å’Œï¼ˆWCSSï¼‰ï¼š</p>
<p>$$WCSS = \sum_{i=1}^{K}\sum_{x \in C_i} ||x - \mu_i||^2$$</p>
<p>é€‰æ‹©WCSSä¸‹é™æœ€å¿«çš„Kå€¼ã€‚</p>
<p><strong>Silhouetteåˆ†æ</strong>ï¼š</p>
<p>å¯¹äºæ¯ä¸ªåŸºå› $i$ï¼š</p>
<p>$$s(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}$$</p>
<p>å…¶ä¸­ï¼š<br />
- $a(i)$ï¼šåŸºå› $i$åˆ°åŒä¸€èšç±»å†…å…¶ä»–åŸºå› çš„å¹³å‡è·ç¦»<br />
- $b(i)$ï¼šåŸºå› $i$åˆ°æœ€è¿‘å…¶ä»–èšç±»çš„æœ€å°å¹³å‡è·ç¦»</p>
<p>é€‰æ‹©å¹³å‡Silhouetteåˆ†æ•°æœ€é«˜çš„Kå€¼ã€‚</p>
<p><strong>9. PCAï¼ˆä¸»æˆåˆ†åˆ†æï¼‰</strong></p>
<p>å¯¹ç›¸å…³æ€§çŸ©é˜µè¿›è¡ŒPCAï¼š</p>
<ol>
<li>æ ‡å‡†åŒ–æ•°æ®ï¼ˆå¦‚æœéœ€è¦ï¼‰</li>
<li>è®¡ç®—åæ–¹å·®çŸ©é˜µ</li>
<li>è®¡ç®—ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡</li>
<li>é€‰æ‹©å‰$k$ä¸ªä¸»æˆåˆ†</li>
</ol>
<p><strong>10. t-SNEï¼ˆt-Distributed Stochastic Neighbor Embeddingï¼‰</strong></p>
<p>t-SNEä½¿ç”¨tåˆ†å¸ƒæ¥å»ºæ¨¡ä½ç»´ç©ºé—´ä¸­çš„ç›¸ä¼¼æ€§ï¼š</p>
<p>$$p_{j|i} = \frac{\exp(-||x_i - x_j||^2 / 2\sigma_i^2)}{\sum_{k \neq i}\exp(-||x_i - x_k||^2 / 2\sigma_i^2)}$$</p>
<p>$$q_{j|i} = \frac{(1 + ||y_i - y_j||^2)^{-1}}{\sum_{k \neq i}(1 + ||y_i - y_k||^2)^{-1}}$$</p>
<p>é€šè¿‡æœ€å°åŒ–KLæ•£åº¦æ¥ä¼˜åŒ–ï¼š</p>
<p>$$KL(P||Q) = \sum_i \sum_j p_{j|i} \log \frac{p_{j|i}}{q_{j|i}}$$</p>
<h4 id="342">3.4.2 ä»£ç å®ç°<a class="headerlink" href="#342" title="Permanent link">&para;</a></h4>
<p><strong>1. æ ¸å¿ƒç±»ç»“æ„</strong></p>
<pre><code class="language-python">class IVCCAAnalyzer:
    def __init__(self):
        self.data = None
        self.gene_names = None
        self.sample_names = None
        self.correlation_matrix = None

    def load_data(self, file_path: str) -&gt; Dict:
        &quot;&quot;&quot;åŠ è½½æ•°æ®ï¼ˆExcel/CSV/TSVï¼‰&quot;&quot;&quot;
        # è¯»å–æ–‡ä»¶
        # æå–åŸºå› åç§°å’Œæ ·æœ¬åç§°
        # è½¬æ¢ä¸ºæ•°å€¼çŸ©é˜µ
        pass

    def calculate_correlations(self, method: str = 'pearson') -&gt; Dict:
        &quot;&quot;&quot;è®¡ç®—ç›¸å…³æ€§çŸ©é˜µ&quot;&quot;&quot;
        # ä½¿ç”¨pandasçš„corræ–¹æ³•
        # å¤„ç†NaNå€¼
        # è®¡ç®—ç»Ÿè®¡ä¿¡æ¯
        pass

    def sort_correlation_matrix(self) -&gt; Dict:
        &quot;&quot;&quot;æ’åºç›¸å…³æ€§çŸ©é˜µ&quot;&quot;&quot;
        # è®¡ç®—æ¯ä¸ªåŸºå› çš„å¹³å‡ç»å¯¹ç›¸å…³æ€§
        # æ’åº
        # è¿”å›æ’åºåçš„çŸ©é˜µå’Œç´¢å¼•
        pass

    def perform_pca(self, n_components: int = 3) -&gt; Dict:
        &quot;&quot;&quot;æ‰§è¡ŒPCA&quot;&quot;&quot;
        # ä½¿ç”¨sklearnçš„PCA
        # è®¡ç®—ä¸»æˆåˆ†
        # ç”Ÿæˆå¯è§†åŒ–
        pass

    def perform_tsne(self, n_components: int = 2) -&gt; Dict:
        &quot;&quot;&quot;æ‰§è¡Œt-SNE&quot;&quot;&quot;
        # ä½¿ç”¨sklearnçš„TSNE
        # å¯é€‰çš„PCAåˆå§‹åŒ–
        # ç”Ÿæˆå¯è§†åŒ–
        pass

    def multi_pathway_analysis(self, pathway_files: List[str]) -&gt; Dict:
        &quot;&quot;&quot;å¤šé€šè·¯åˆ†æ&quot;&quot;&quot;
        # åŠ è½½é€šè·¯åŸºå› åˆ—è¡¨
        # è®¡ç®—PCI_Aå’ŒPCI_B
        # è®¡ç®—CECIå’ŒZ-score
        # è¿”å›æ’åºåçš„ç»“æœ
        pass
</code></pre>
<p><strong>2. ç›¸å…³æ€§è®¡ç®—å®ç°</strong></p>
<pre><code class="language-python">def calculate_correlations(self, method: str = 'pearson') -&gt; Dict:
    &quot;&quot;&quot;è®¡ç®—ç›¸å…³æ€§çŸ©é˜µ&quot;&quot;&quot;
    if method == 'pearson':
        self.correlation_matrix = pd.DataFrame(self.data).corr(method='pearson').values
    elif method == 'spearman':
        self.correlation_matrix = pd.DataFrame(self.data).corr(method='spearman').values
    else:  # kendall
        self.correlation_matrix = pd.DataFrame(self.data).corr(method='kendall').values

    # å¤„ç†NaN
    self.correlation_matrix = np.nan_to_num(self.correlation_matrix, nan=0.0)

    # è®¡ç®—ç»Ÿè®¡ä¿¡æ¯
    corr_values = self.correlation_matrix[np.triu_indices_from(self.correlation_matrix, k=1)]
    stats = {
        &quot;mean&quot;: float(np.mean(corr_values)),
        &quot;std&quot;: float(np.std(corr_values)),
        &quot;min&quot;: float(np.min(corr_values)),
        &quot;max&quot;: float(np.max(corr_values))
    }

    return {&quot;status&quot;: &quot;success&quot;, &quot;statistics&quot;: stats}
</code></pre>
<p><strong>3. é€šè·¯åˆ†æå®ç°</strong></p>
<pre><code class="language-python">def multi_pathway_analysis(self, pathway_files: List[str], 
                          sorted_genes: List[str] = None,
                          sorted_correlations: List[float] = None) -&gt; Dict:
    &quot;&quot;&quot;å¤šé€šè·¯åˆ†æ&quot;&quot;&quot;
    results = []

    for pathway_file, pathway_genes in zip(pathway_files, pathway_genes_list):
        # æ‰¾åˆ°é€šè·¯åŸºå› åœ¨æ•°æ®é›†ä¸­çš„ç´¢å¼•
        pathway_indices = [i for i, gene in enumerate(self.gene_names) 
                          if gene in pathway_genes]

        if len(pathway_indices) &lt; min_genes_threshold:
            continue

        # è®¡ç®—PCI_Aï¼ˆé€šè·¯å†…ç›¸å…³æ€§ï¼‰
        pathway_corr = self.correlation_matrix[np.ix_(pathway_indices, pathway_indices)]
        abs_pathway_corr = np.abs(pathway_corr)
        np.fill_diagonal(abs_pathway_corr, 0)
        sum_abs_correlations = np.sum(abs_pathway_corr, axis=1)
        avg_abs_correlation = sum_abs_correlations / (len(pathway_indices) - 1)
        pci_a = float(np.mean(avg_abs_correlation))

        # è®¡ç®—PCI_Bï¼ˆä»å…¨å±€æ’åºä¸­æå–ï¼‰
        if sorted_genes and sorted_correlations:
            pci_b_values = []
            for gene in pathway_genes:
                if gene in sorted_genes:
                    idx = sorted_genes.index(gene)
                    pci_b_values.append(sorted_correlations[idx])
            pci_b = float(np.mean(pci_b_values)) if pci_b_values else None
        else:
            pci_b = None

        # è®¡ç®—PAI
        pai = len(pathway_indices) / len(pathway_genes)

        # è®¡ç®—CECI
        if pci_b is not None:
            ceci = pai * pci_b * 100
        else:
            ceci = pai * pci_a * 100

        # è®¡ç®—Z-score
        z_score = (ceci - 7.908) / 2.0605

        results.append({
            &quot;pathway_file&quot;: pathway_file,
            &quot;pci_a&quot;: pci_a,
            &quot;pci_b&quot;: pci_b,
            &quot;ceci&quot;: float(ceci),
            &quot;z_score&quot;: float(z_score)
        })

    # æŒ‰CECIæ’åº
    results.sort(key=lambda x: x[&quot;ceci&quot;], reverse=True)
    return {&quot;status&quot;: &quot;success&quot;, &quot;pathways&quot;: results}
</code></pre>
<p><strong>4. å¯è§†åŒ–å®ç°</strong></p>
<pre><code class="language-python">def create_correlation_heatmap(self, sorted: bool = False) -&gt; Dict:
    &quot;&quot;&quot;åˆ›å»ºç›¸å…³æ€§çƒ­å›¾&quot;&quot;&quot;
    if sorted:
        sort_result = self.sort_correlation_matrix()
        matrix = np.array(sort_result[&quot;sorted_matrix&quot;])
        gene_names = sort_result[&quot;sorted_gene_names&quot;]
    else:
        matrix = self.correlation_matrix
        gene_names = self.gene_names

    # åˆ›å»ºmaskï¼ˆåªæ˜¾ç¤ºä¸‹ä¸‰è§’ï¼‰
    mask = np.triu(np.ones_like(matrix, dtype=bool), k=1)

    # ä½¿ç”¨seabornç»˜åˆ¶çƒ­å›¾
    fig, ax = plt.subplots(figsize=(12, 10))
    sns.heatmap(
        matrix, mask=mask,
        cmap='RdYlBu_r', center=0,
        vmin=-1, vmax=1,
        square=True, linewidths=0.5,
        xticklabels=gene_names[:50],  # é™åˆ¶æ˜¾ç¤º
        yticklabels=gene_names[:50]
    )

    # è½¬æ¢ä¸ºbase64
    buffer = io.BytesIO()
    plt.savefig(buffer, format='png', dpi=300)
    return base64.b64encode(buffer.getvalue()).decode()
</code></pre>
<h4 id="343-api">3.4.3 APIç«¯ç‚¹<a class="headerlink" href="#343-api" title="Permanent link">&para;</a></h4>
<ul>
<li><code>POST /api/ivcca/load-data</code>ï¼šåŠ è½½æ•°æ®</li>
<li><code>POST /api/ivcca/calculate-correlations</code>ï¼šè®¡ç®—ç›¸å…³æ€§çŸ©é˜µ</li>
<li><code>POST /api/ivcca/sort-matrix</code>ï¼šæ’åºçŸ©é˜µ</li>
<li><code>POST /api/ivcca/heatmap</code>ï¼šç”Ÿæˆçƒ­å›¾</li>
<li><code>POST /api/ivcca/pca</code>ï¼šæ‰§è¡ŒPCA</li>
<li><code>POST /api/ivcca/tsne</code>ï¼šæ‰§è¡Œt-SNE</li>
<li><code>POST /api/ivcca/pathway-analysis</code>ï¼šé€šè·¯åˆ†æ</li>
<li><code>POST /api/ivcca/network</code>ï¼šç½‘ç»œåˆ†æ</li>
</ul>
<h3 id="35">3.5 å±€é™æ€§<a class="headerlink" href="#35" title="Permanent link">&para;</a></h3>
<h4 id="351">3.5.1 æ–¹æ³•å­¦å±€é™æ€§<a class="headerlink" href="#351" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>ç›¸å…³æ€§ä¸ä»£è¡¨å› æœå…³ç³»</strong>ï¼š</li>
<li>é«˜ç›¸å…³æ€§å¯èƒ½æ˜¯ç”±äºå…±åŒçš„ä¸Šæ¸¸è°ƒæ§å› å­</li>
<li>
<p>æ— æ³•åŒºåˆ†ç›´æ¥å’Œé—´æ¥ç›¸å…³</p>
</li>
<li>
<p><strong>çº¿æ€§ç›¸å…³å‡è®¾</strong>ï¼š</p>
</li>
<li>Pearsonç›¸å…³ç³»æ•°åªèƒ½æ£€æµ‹çº¿æ€§ç›¸å…³</li>
<li>
<p>éçº¿æ€§ç›¸å…³å¯èƒ½è¢«é—æ¼</p>
</li>
<li>
<p><strong>æ ·æœ¬é‡è¦æ±‚</strong>ï¼š</p>
</li>
<li>å°æ ·æœ¬é‡å¯èƒ½å¯¼è‡´ç›¸å…³æ€§ä¼°è®¡ä¸å‡†ç¡®</li>
<li>
<p>å»ºè®®æ ·æœ¬é‡ â‰¥ 30</p>
</li>
<li>
<p><strong>å¤šé‡æ¯”è¾ƒé—®é¢˜</strong>ï¼š</p>
</li>
<li>å¤§é‡åŸºå› å¯¹æ¯”è¾ƒéœ€è¦è¿›è¡Œå¤šé‡æ¯”è¾ƒæ ¡æ­£</li>
<li>å½“å‰å®ç°æœªåŒ…å«FDRæ ¡æ­£</li>
</ol>
<h4 id="352">3.5.2 åŠŸèƒ½å±€é™æ€§<a class="headerlink" href="#352" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>é€šè·¯åˆ†æ</strong>ï¼š</li>
<li>ä¾èµ–é€šè·¯æ•°æ®åº“çš„å®Œæ•´æ€§å’Œå‡†ç¡®æ€§</li>
<li>é€šè·¯è¾¹ç•Œå®šä¹‰å¯èƒ½ä¸ç²¾ç¡®</li>
<li>
<p>CECIå€¼çš„è§£é‡Šéœ€è¦ç”Ÿç‰©å­¦èƒŒæ™¯</p>
</li>
<li>
<p><strong>èšç±»åˆ†æ</strong>ï¼š</p>
</li>
<li>K-meanså‡è®¾èšç±»æ˜¯çƒå½¢çš„</li>
<li>æœ€ä¼˜Kå€¼å¯èƒ½ä¸å”¯ä¸€</li>
<li>
<p>åˆå§‹åŒ–æ•æ„Ÿæ€§</p>
</li>
<li>
<p><strong>é™ç»´åˆ†æ</strong>ï¼š</p>
</li>
<li>PCAåªèƒ½æ•è·çº¿æ€§å…³ç³»</li>
<li>t-SNEç»“æœå¯èƒ½ä¸ç¨³å®šï¼ˆéšæœºæ€§ï¼‰</li>
</ol>
<h4 id="353">3.5.3 æŠ€æœ¯å±€é™æ€§<a class="headerlink" href="#353" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>æ•°æ®è§„æ¨¡</strong>ï¼š</li>
<li>å¤§å‹æ•°æ®é›†ï¼ˆ&gt;10000åŸºå› ï¼‰è®¡ç®—æ—¶é—´è¾ƒé•¿</li>
<li>
<p>å†…å­˜å ç”¨è¾ƒå¤§ï¼ˆç›¸å…³æ€§çŸ©é˜µO(nÂ²)ï¼‰</p>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
</li>
<li>æœªå®ç°å¹¶è¡Œè®¡ç®—</li>
<li>ç¼ºä¹ç¼“å­˜æœºåˆ¶</li>
<li>
<p>æŸäº›æ“ä½œå¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–</p>
</li>
<li>
<p><strong>å¹³å°ä¾èµ–</strong>ï¼š</p>
</li>
<li>éœ€è¦Pythonç¯å¢ƒ</li>
<li>ä¾èµ–å¤šä¸ªç§‘å­¦è®¡ç®—åº“</li>
<li>æŸäº›åŠŸèƒ½éœ€è¦é¢å¤–å®‰è£…</li>
</ol>
<hr />
<h2 id="_6">æŠ€æœ¯æ¶æ„<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<h3 id="_7">ç³»ç»Ÿæ¶æ„<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚
â”‚  (Next.js/React)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ HTTP/REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend       â”‚
â”‚  (FastAPI/Python)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”
â”‚MongoDBâ”‚ â”‚GProfilerâ”‚
â”‚       â”‚ â”‚  API   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="_8">æŠ€æœ¯æ ˆ<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p><strong>å‰ç«¯</strong>ï¼š<br />
- Next.js 15.3.5<br />
- React + TypeScript<br />
- Tailwind CSS<br />
- Plotly.jsï¼ˆäº¤äº’å¼å›¾è¡¨ï¼‰</p>
<p><strong>åç«¯</strong>ï¼š<br />
- FastAPI 0.68.0<br />
- Python 3.9+<br />
- pandas, NumPy, SciPy<br />
- scikit-learn<br />
- matplotlib, seaborn<br />
- GProfiler Pythonå®¢æˆ·ç«¯</p>
<p><strong>æ•°æ®åº“</strong>ï¼š<br />
- MongoDBï¼ˆåŸºå› è¡¨è¾¾æ•°æ®ï¼‰<br />
- ç´¢å¼•ä¼˜åŒ–</p>
<p><strong>éƒ¨ç½²</strong>ï¼š<br />
- Dockerå®¹å™¨åŒ–<br />
- Nginxåå‘ä»£ç†<br />
- æ”¯æŒäº‘éƒ¨ç½²</p>
<h3 id="_9">æ•°æ®æµ<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>åŸºå› æœç´¢</strong>ï¼š<br />
<code>ç”¨æˆ·è¾“å…¥ â†’ APIè¯·æ±‚ â†’ MongoDBæŸ¥è¯¢ â†’ æ•°æ®å¤„ç† â†’ JSONå“åº” â†’ å‰ç«¯å±•ç¤º</code></p>
</li>
<li>
<p><strong>ä¸»é¢˜åˆ†æ</strong>ï¼š<br />
<code>ç”¨æˆ·ä¸Šä¼ åŸºå› åˆ—è¡¨ â†’ åç«¯è§£æ â†’ GProfiler API â†’ å¯Œé›†ç»“æœ â†’ ä¸»é¢˜åˆ†é… â†’ èšåˆ â†’ å¯è§†åŒ– â†’ è¿”å›å›¾ç‰‡</code></p>
</li>
<li>
<p><strong>IVCCAåˆ†æ</strong>ï¼š<br />
<code>ç”¨æˆ·ä¸Šä¼ æ•°æ® â†’ æ•°æ®åŠ è½½ â†’ ç›¸å…³æ€§è®¡ç®— â†’ åˆ†æï¼ˆèšç±»/é™ç»´/é€šè·¯ï¼‰ â†’ å¯è§†åŒ– â†’ è¿”å›ç»“æœ</code></p>
</li>
</ol>
<hr />
<h2 id="_10">é¡¹ç›®æ€»ç»“ä¸å±•æœ›<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<h3 id="_11">ä¸»è¦è´¡çŒ®<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>æ•°æ®æ•´åˆ</strong>ï¼šæ•´åˆäº†9ä¸ªç»„ç»‡çš„åŸºå› è¡¨è¾¾æ•°æ®ï¼Œæä¾›ç»Ÿä¸€çš„æœç´¢æ¥å£</li>
<li><strong>åŠŸèƒ½åˆ›æ–°</strong>ï¼šå¼•å…¥äº†ä¸»é¢˜èšåˆæ¦‚å¿µï¼Œç®€åŒ–äº†GOå¯Œé›†åˆ†æç»“æœçš„è§£è¯»</li>
<li><strong>ç®—æ³•è½¬æ¢</strong>ï¼šæˆåŠŸå°†MATLAB IVCCAè½¬æ¢ä¸ºPythonå®ç°ï¼Œä¿æŒäº†ç®—æ³•ä¸€è‡´æ€§</li>
<li><strong>å¹³å°æ•´åˆ</strong>ï¼šå°†ä¸‰ä¸ªç‹¬ç«‹çš„åŠŸèƒ½æ¨¡å—æ•´åˆåœ¨ä¸€ä¸ªå¹³å°ä¸­</li>
</ol>
<h3 id="_12">æŠ€æœ¯äº®ç‚¹<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>WebåŒ–</strong>ï¼šå°†å‘½ä»¤è¡Œå·¥å…·è½¬æ¢ä¸ºæ˜“ç”¨çš„Webåº”ç”¨</li>
<li><strong>å¯è§†åŒ–å¢å¼º</strong>ï¼šæä¾›ä¸°å¯Œçš„å›¾è¡¨å’Œäº¤äº’å¼å¯è§†åŒ–</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šä½¿ç”¨ç´¢å¼•ã€å‘é‡åŒ–è®¡ç®—ç­‰æŠ€æœ¯æé«˜æ€§èƒ½</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ·»åŠ æ–°åŠŸèƒ½</li>
</ol>
<h3 id="_13">æœªæ¥æ”¹è¿›æ–¹å‘<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>æ•°æ®æ‰©å±•</strong>ï¼š</li>
<li>æ”¯æŒæ›´å¤šç»„ç»‡/å™¨å®˜</li>
<li>æ”¯æŒæ—¶é—´åºåˆ—æ•°æ®</li>
<li>
<p>æ”¯æŒå•ç»†èƒæ•°æ®</p>
</li>
<li>
<p><strong>åŠŸèƒ½å¢å¼º</strong>ï¼š</p>
</li>
<li>æ‰¹é‡åŸºå› æœç´¢</li>
<li>æ›´å¤šç»Ÿè®¡æ£€éªŒæ–¹æ³•</li>
<li>
<p>æœºå™¨å­¦ä¹ é¢„æµ‹åŠŸèƒ½</p>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
</li>
<li>å¹¶è¡Œè®¡ç®—æ”¯æŒ</li>
<li>ç¼“å­˜æœºåˆ¶</li>
<li>
<p>å¢é‡æ›´æ–°</p>
</li>
<li>
<p><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼š</p>
</li>
<li>ç»“æœå¯¼å‡ºåŠŸèƒ½</li>
<li>æŠ¥å‘Šç”Ÿæˆ</li>
<li>åä½œåŠŸèƒ½</li>
</ol>
<h3 id="_14">åº”ç”¨ä»·å€¼<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<p>è¯¥å¹³å°å·²åœ¨ä»¥ä¸‹åœºæ™¯ä¸­åº”ç”¨ï¼š<br />
- è¯ç‰©æ¯’æ€§è¯„ä¼°<br />
- ç–¾ç—…æœºåˆ¶ç ”ç©¶<br />
- ç”Ÿç‰©æ ‡å¿—ç‰©å‘ç°<br />
- é€šè·¯æ¿€æ´»åˆ†æ</p>
<hr />
<h2 id="_15">é™„å½•ï¼šå…³é”®å…¬å¼æ±‡æ€»<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h2>
<h3 id="_16">åŸºå› æœç´¢<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>æ— å¤æ‚æ•°å­¦å…¬å¼ï¼Œä¸»è¦ä½¿ç”¨æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–ã€‚</p>
<h3 id="_17">ä¸»é¢˜åˆ†æ<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>å¯Œé›†åˆ†æPå€¼</strong>ï¼ˆè¶…å‡ ä½•åˆ†å¸ƒï¼‰ï¼š<br />
   $$P(X \geq k) = \sum_{i=k}^{min(n, M)} \frac{\binom{M}{i} \binom{N-M}{n-i}}{\binom{N}{n}}$$</p>
</li>
<li>
<p><strong>åˆ†æ•°è®¡ç®—</strong>ï¼š<br />
   $$Score = -\log_{10}(p_value)$$</p>
</li>
<li>
<p><strong>ä¸»é¢˜ç´¯ç§¯åˆ†æ•°</strong>ï¼š<br />
   $$Cumulative_Score(T) = \sum_{i=1}^{n} Score(GO_i)$$</p>
</li>
</ol>
<h3 id="ivcca">IVCCA<a class="headerlink" href="#ivcca" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Pearsonç›¸å…³ç³»æ•°</strong>ï¼š<br />
   $$r_{XY} = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i - \bar{x})^2 \sum_{i=1}^{n}(y_i - \bar{y})^2}}$$</p>
</li>
<li>
<p><strong>PCI_A</strong>ï¼š<br />
   $$PCI_A = \frac{1}{k}\sum_{i \in P} \frac{1}{k-1}\sum_{j \in P, j \neq i} |r_{ij}|$$</p>
</li>
<li>
<p><strong>CECI</strong>ï¼š<br />
   $$CECI = \frac{k_{found}}{k_{total}} \times PCI_B \times 100$$</p>
</li>
<li>
<p><strong>Z-score</strong>ï¼š<br />
   $$Z = \frac{CECI - 7.908}{2.0605}$$</p>
</li>
<li>
<p><strong>ä½™å¼¦ç›¸ä¼¼åº¦</strong>ï¼š<br />
   $$cosine_similarity = \frac{\sum_{i \in A, j \in B} r_{ij}^2}{\sqrt{|A|} \times \sqrt{|B|}}$$</p>
</li>
</ol>
<hr />
<p><strong>æ–‡æ¡£ç‰ˆæœ¬</strong>ï¼š1.0<br />
<strong>æœ€åæ›´æ–°</strong>ï¼š2024å¹´<br />
<strong>ä½œè€…</strong>ï¼šåŸºäºGenoCorrå¹³å°å¼€å‘æ–‡æ¡£æ•´ç†</p>
    
    <script>
        // æ‰“å°æ—¶çš„æç¤º
        window.onbeforeprint = function() {
            console.log("æ‰“å°æç¤ºï¼šè¯·é€‰æ‹©'å¦å­˜ä¸ºPDF'æˆ–'ä¿å­˜ä¸ºPDF'");
        };
    </script>
</body>
</html>