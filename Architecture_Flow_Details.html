<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç³»ç»Ÿæ¶æ„è¯¦ç»†æµç¨‹å›¾ä¸ç»„ä»¶äº¤äº’ - GenoCorr Platform System Architecture</title>
    <style>
        @media print {
            @page {
                size: A4;
                margin: 2.5cm 2cm;
            }
            
            body {
                print-color-adjust: exact;
                -webkit-print-color-adjust: exact;
            }
            
            .no-print {
                display: none;
            }
            
            h1, h2, h3, h4, h5, h6 {
                page-break-after: avoid;
            }
            
            pre, blockquote, table {
                page-break-inside: avoid;
            }
            
            .flow-diagram {
                page-break-inside: avoid;
            }
        }
        
        body {
            font-family: "Microsoft YaHei", "SimHei", "Arial Unicode MS", "DejaVu Sans", Arial, sans-serif;
            line-height: 1.8;
            color: #333;
            font-size: 12pt;
            max-width: 210mm;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
        }
        
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #3498db;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14pt;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        .print-button:hover {
            background-color: #2980b9;
        }
        
        h1 {
            font-size: 28pt;
            font-weight: bold;
            color: #2c3e50;
            margin-top: 1.5em;
            margin-bottom: 0.8em;
            border-bottom: 3px solid #3498db;
            padding-bottom: 0.5em;
        }
        
        h2 {
            font-size: 22pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1.5em;
            margin-bottom: 0.6em;
            border-bottom: 2px solid #95a5a6;
            padding-bottom: 0.3em;
        }
        
        h3 {
            font-size: 18pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1.3em;
            margin-bottom: 0.5em;
        }
        
        h4 {
            font-size: 16pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1.2em;
            margin-bottom: 0.4em;
        }
        
        h5, h6 {
            font-size: 14pt;
            font-weight: bold;
            color: #34495e;
            margin-top: 1em;
            margin-bottom: 0.3em;
        }
        
        p {
            margin: 0.8em 0;
            text-align: justify;
        }
        
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", "Courier New", monospace;
            font-size: 10.5pt;
            color: #c7254e;
            border: 1px solid #e1e1e1;
        }
        
        pre {
            background-color: #f8f8f8;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border-left: 4px solid #3498db;
            margin: 1em 0;
            font-family: "Consolas", "Monaco", "Courier New", monospace;
            font-size: 10pt;
            line-height: 1.5;
        }
        
        pre code {
            background-color: transparent;
            padding: 0;
            border: none;
            color: #333;
            font-size: 10pt;
            display: block;
            white-space: pre;
            overflow-x: auto;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 1.5em 0;
            font-size: 11pt;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
            text-align: center;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        ul, ol {
            margin: 0.8em 0;
            padding-left: 2em;
        }
        
        li {
            margin: 0.4em 0;
        }
        
        blockquote {
            border-left: 4px solid #3498db;
            margin: 1.5em 0;
            padding-left: 1.5em;
            padding-right: 1em;
            color: #555;
            font-style: italic;
            background-color: #f9f9f9;
            padding-top: 0.5em;
            padding-bottom: 0.5em;
        }
        
        hr {
            border: none;
            border-top: 2px solid #ddd;
            margin: 2em 0;
        }
        
        strong {
            font-weight: bold;
            color: #2c3e50;
        }
        
        em {
            font-style: italic;
            color: #555;
        }
        
        .toc {
            background-color: #f9f9f9;
            padding: 1.5em;
            margin: 1.5em 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 1em;
        }
        
        .toc li {
            margin: 0.3em 0;
        }
        
        .toc a {
            color: #3498db;
            text-decoration: none;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        /* æµç¨‹å›¾æ ·å¼ */
        .flow-diagram {
            background-color: #f8f8f8;
            padding: 15px;
            border-radius: 5px;
            margin: 1.5em 0;
            border: 1px solid #ddd;
            font-family: "Consolas", "Monaco", "Courier New", monospace;
            font-size: 10pt;
            overflow-x: auto;
            white-space: pre;
        }
        
        /* ä»£ç å—ä¸­çš„ç‰¹æ®Šå­—ç¬¦ */
        pre.highlight, pre code {
            white-space: pre;
            word-wrap: normal;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <button class="print-button no-print" onclick="window.print()">
        ğŸ–¨ï¸ Print to PDF
    </button>
    
    <h1 id="_1">ç³»ç»Ÿæ¶æ„è¯¦ç»†æµç¨‹å›¾ä¸ç»„ä»¶äº¤äº’<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>æœ¬æ–‡æ¡£æä¾›ç³»ç»Ÿæ¶æ„ä¸­æ¯ä¸€æ­¥çš„è¯¦ç»†æµç¨‹å’Œç»„ä»¶é—´çš„äº¤äº’å…³ç³»ã€‚</p>
<hr />
<h2 id="_2">ä¸€ã€ç³»ç»Ÿå¯åŠ¨æµç¨‹<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 åç«¯å¯åŠ¨æµç¨‹<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<pre><code>Step 1: åŠ è½½ç¯å¢ƒå˜é‡
    â”‚
    â”œâ”€â†’ è¯»å– .env æ–‡ä»¶
    â”œâ”€â†’ MONGODB_URI
    â”œâ”€â†’ VALID_TOKENS
    â””â”€â†’ å…¶ä»–é…ç½®
    â”‚
Step 2: è¿æ¥MongoDB
    â”‚
    â”œâ”€â†’ MongoClient(MONGODB_URI)
    â”œâ”€â†’ client.admin.command('ping')  # æµ‹è¯•è¿æ¥
    â”œâ”€â†’ db = client.gene_search_db
    â””â”€â†’ collection = db.gene_data
    â”‚
Step 3: åˆå§‹åŒ–APIç±»
    â”‚
    â”œâ”€â†’ gene_api = GeneSearchAPI()
    â”‚     â”‚
    â”‚     â”œâ”€â†’ load_data_to_mongodb()
    â”‚     â”‚     â”‚
    â”‚     â”‚     â”œâ”€â†’ æ‰«æ data/*.xlsx æ–‡ä»¶
    â”‚     â”‚     â”œâ”€â†’ è¯»å–æ¯ä¸ªæ–‡ä»¶
    â”‚     â”‚     â”œâ”€â†’ æ•°æ®æ¸…æ´—å’Œè½¬æ¢
    â”‚     â”‚     â”œâ”€â†’ æ‰¹é‡å†™å…¥MongoDB
    â”‚     â”‚     â””â”€â†’ åˆ›å»ºç´¢å¼•
    â”‚     â”‚
    â”‚     â””â”€â†’ load_all_genes()
    â”‚           â”‚
    â”‚           â”œâ”€â†’ MongoDBèšåˆæŸ¥è¯¢
    â”‚           â”œâ”€â†’ $group å»é‡
    â”‚           â””â”€â†’ è¿”å›åŸºå› ç¬¦å·åˆ—è¡¨
    â”‚
    â”œâ”€â†’ ontology_api = GeneOntologyAPI()
    â”‚     â”‚
    â”‚     â”œâ”€â†’ gp = GProfiler(return_dataframe=True)
    â”‚     â””â”€â†’ themes = {...}  # å®šä¹‰ä¸»é¢˜å…³é”®è¯
    â”‚
Step 4: åˆ›å»ºFastAPIåº”ç”¨
    â”‚
    â”œâ”€â†’ app = FastAPI(...)
    â”œâ”€â†’ app.add_middleware(CORSMiddleware, ...)
    â””â”€â†’ å®šä¹‰æ‰€æœ‰APIè·¯ç”±
    â”‚
Step 5: å¯åŠ¨UvicornæœåŠ¡å™¨
    â”‚
    â””â”€â†’ uvicorn.run(app, host=&quot;0.0.0.0&quot;, port=8000)
</code></pre>
<h3 id="12">1.2 å‰ç«¯å¯åŠ¨æµç¨‹<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<pre><code>Step 1: åŠ è½½ç¯å¢ƒå˜é‡
    â”‚
    â””â”€â†’ NEXT_PUBLIC_API_URL = process.env.NEXT_PUBLIC_API_URL
    â”‚
Step 2: ç¼–è¯‘TypeScript
    â”‚
    â””â”€â†’ TypeScript â†’ JavaScript
    â”‚
Step 3: Next.jså¯åŠ¨
    â”‚
    â”œâ”€â†’ åˆå§‹åŒ–Reactåº”ç”¨
    â”œâ”€â†’ åŠ è½½è·¯ç”±é…ç½®
    â””â”€â†’ å¯åŠ¨å¼€å‘æœåŠ¡å™¨ (port 3000)
    â”‚
Step 4: é¡µé¢åŠ è½½
    â”‚
    â”œâ”€â†’ layout.tsx (æ ¹å¸ƒå±€)
    â””â”€â†’ page.tsx (é¦–é¡µ)
</code></pre>
<hr />
<h2 id="_3">äºŒã€åŸºå› æœç´¢æ¨¡å—è¯¦ç»†æµç¨‹<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="21-mongodb">2.1 æ•°æ®åŠ è½½åˆ°MongoDBçš„å®Œæ•´æµç¨‹<a class="headerlink" href="#21-mongodb" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œ: GeneSearchAPI.__init__()            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: æ£€æŸ¥MongoDBæ˜¯å¦å·²æœ‰æ•°æ®                     â”‚
â”‚                                                      â”‚
â”‚ existing_count = collection.count_documents({})     â”‚
â”‚ if existing_count &gt; 0:                              â”‚
â”‚     print(&quot;æ•°æ®å·²å­˜åœ¨ï¼Œè·³è¿‡åŠ è½½&quot;)                    â”‚
â”‚     return                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: æ‰«ææ•°æ®æ–‡ä»¶ç›®å½•                            â”‚
â”‚                                                      â”‚
â”‚ excel_files = glob.glob(&quot;data/*.xlsx&quot;)              â”‚
â”‚ # ç»“æœ: ['data/BoneMarrow.xlsx', ...]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: éå†æ¯ä¸ªExcelæ–‡ä»¶                           â”‚
â”‚                                                      â”‚
â”‚ for file_path in excel_files:                       â”‚
â”‚     # å¤„ç†å•ä¸ªæ–‡ä»¶                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: è¯»å–Excelæ–‡ä»¶                               â”‚
â”‚                                                      â”‚
â”‚ df = pd.read_excel(file_path)                       â”‚
â”‚ # DataFrameç»“æ„:                                    â”‚
â”‚ # Columns: Gene_symbol, Gene_name, P_value_...,    â”‚
â”‚ #          FDR_..., Ratio_..., Fold_change_...,    â”‚
â”‚ #          LSMean10mgkg_..., LSMeancontrol_...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: æå–ç»„ç»‡åç§°                                â”‚
â”‚                                                      â”‚
â”‚ organ_name = os.path.splitext(                      â”‚
â”‚     os.path.basename(file_path)                     â”‚
â”‚ )[0]                                                â”‚
â”‚ # ç»“æœ: 'BoneMarrow', 'Cortex', etc.               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: éå†DataFrameçš„æ¯ä¸€è¡Œ                       â”‚
â”‚                                                      â”‚
â”‚ for index, row in df.iterrows():                    â”‚
â”‚     # å¤„ç†å•è¡Œæ•°æ®                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 7: æå–å’ŒéªŒè¯åŸºå› ç¬¦å·                          â”‚
â”‚                                                      â”‚
â”‚ gene_symbol = str(row.get('Gene_symbol', '')).strip()â”‚
â”‚ if not gene_symbol:                                 â”‚
â”‚     continue  # è·³è¿‡ç©ºåŸºå› ç¬¦å·                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 8: æ„å»ºMongoDBæ–‡æ¡£                             â”‚
â”‚                                                      â”‚
â”‚ record = {                                          â”‚
â”‚     'organ': organ_name,                            â”‚
â”‚     'gene_symbol': gene_symbol,                     â”‚
â”‚     'gene_name': str(row.get('Gene_name', '')),    â”‚
â”‚     'p_value_10_mgkg_vs_control':                   â”‚
â”‚         str(row.get('P_value_10_mgkg_vs_control', '')),â”‚
â”‚     # ... å…¶ä»–7ä¸ªå­—æ®µ                                â”‚
â”‚ }                                                   â”‚
â”‚ records.append(record)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 9: æ‰¹é‡æ„å»ºå†™å…¥æ“ä½œ                            â”‚
â”‚                                                      â”‚
â”‚ operations = []                                     â”‚
â”‚ for record in records:                              â”‚
â”‚     operations.append({                             â”‚
â”‚         'replaceOne': {                             â”‚
â”‚             'filter': {                             â”‚
â”‚                 'organ': record['organ'],           â”‚
â”‚                 'gene_symbol': record['gene_symbol']â”‚
â”‚             },                                      â”‚
â”‚             'replacement': record,                  â”‚
â”‚             'upsert': True  # ä¸å­˜åœ¨åˆ™æ’å…¥ï¼Œå­˜åœ¨åˆ™æ›´æ–°â”‚
â”‚         }                                           â”‚
â”‚     })                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 10: æ‰§è¡Œæ‰¹é‡å†™å…¥                               â”‚
â”‚                                                      â”‚
â”‚ result = collection.bulk_write(operations)          â”‚
â”‚ # ç»“æœç»Ÿè®¡:                                         â”‚
â”‚ # - result.upserted_count: æ–°æ’å…¥æ•°                 â”‚
â”‚ # - result.modified_count: æ›´æ–°æ•°                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 11: åˆ›å»ºç´¢å¼•                                   â”‚
â”‚                                                      â”‚
â”‚ collection.create_index([(&quot;gene_symbol&quot;, 1)])       â”‚
â”‚ collection.create_index([(&quot;organ&quot;, 1)])             â”‚
â”‚ collection.create_index(                            â”‚
â”‚     [(&quot;organ&quot;, 1), (&quot;gene_symbol&quot;, 1)],             â”‚
â”‚     unique=True                                     â”‚
â”‚ )                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®Œæˆï¼šæ•°æ®å·²åŠ è½½åˆ°MongoDB                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="22">2.2 åŸºå› æœç´¢æŸ¥è¯¢æµç¨‹<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·åœ¨å‰ç«¯è¾“å…¥&quot;GAPDH&quot;å¹¶ç‚¹å‡»æœç´¢                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: gene-search/page.tsx                          â”‚
â”‚                                                      â”‚
â”‚ const handleSearch = async () =&gt; {                  â”‚
â”‚     setIsLoading(true)                              â”‚
â”‚     setError('')                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ„å»ºAPIè¯·æ±‚                                          â”‚
â”‚                                                      â”‚
â”‚ const url = `${API_BASE_URL}/api/gene/             â”‚
â”‚              symbol/search?gene_symbol=GAPDH`       â”‚
â”‚                                                      â”‚
â”‚ fetch(url, {                                        â”‚
â”‚     method: 'GET',                                  â”‚
â”‚     headers: {'Content-Type': 'application/json'}   â”‚
â”‚ })                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ HTTP GET è¯·æ±‚
    â”‚ URL: http://localhost:8000/api/gene/symbol/search?gene_symbol=GAPDH
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPIè·¯ç”±: @app.get(&quot;/api/gene/symbol/search&quot;)   â”‚
â”‚                                                      â”‚
â”‚ async def search_gene_symbol(                       â”‚
â”‚     gene_symbol: str = Query(...)                   â”‚
â”‚ ):                                                  â”‚
â”‚     # FastAPIè‡ªåŠ¨è§£ææŸ¥è¯¢å‚æ•°                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è°ƒç”¨ä¸šåŠ¡é€»è¾‘: gene_api.search_gene_data()           â”‚
â”‚                                                      â”‚
â”‚ def search_gene_data(self, gene_symbol: str):       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: æ„å»ºMongoDBæŸ¥è¯¢                             â”‚
â”‚                                                      â”‚
â”‚ query = {                                           â”‚
â”‚     &quot;gene_symbol&quot;: {                                â”‚
â”‚         &quot;$regex&quot;: &quot;^GAPDH$&quot;,  # ç²¾ç¡®åŒ¹é…            â”‚
â”‚         &quot;$options&quot;: &quot;i&quot;          # å¤§å°å†™ä¸æ•æ„Ÿ      â”‚
â”‚     }                                               â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: æ‰§è¡ŒMongoDBæŸ¥è¯¢                             â”‚
â”‚                                                      â”‚
â”‚ cursor = collection.find(query)                     â”‚
â”‚ # MongoDBä½¿ç”¨gene_symbolç´¢å¼•åŠ é€ŸæŸ¥è¯¢                â”‚
â”‚ # æŸ¥è¯¢å¤æ‚åº¦: O(log n)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: éå†æŸ¥è¯¢ç»“æœ                                â”‚
â”‚                                                      â”‚
â”‚ results = []                                        â”‚
â”‚ for doc in cursor:                                  â”‚
â”‚     # docæ˜¯MongoDBæ–‡æ¡£                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: æ ¼å¼åŒ–æ•°æ®                                  â”‚
â”‚                                                      â”‚
â”‚ results.append({                                    â”‚
â”‚     'organ': doc.get('organ', ''),                  â”‚
â”‚     'gene_symbol': doc.get('gene_symbol', ''),      â”‚
â”‚     'gene_name': doc.get('gene_name', ''),          â”‚
â”‚     'p_value': doc.get('p_value_10_mgkg_vs_control', ''),â”‚
â”‚     # ... å…¶ä»–å­—æ®µ                                   â”‚
â”‚ })                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: è¿”å›ç»“æœåˆ—è¡¨                                â”‚
â”‚                                                      â”‚
â”‚ return results  # List[Dict]                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPIè‡ªåŠ¨åºåˆ—åŒ–ä¸ºJSON                             â”‚
â”‚                                                      â”‚
â”‚ return {                                            â”‚
â”‚     &quot;gene_symbol&quot;: &quot;GAPDH&quot;,                         â”‚
â”‚     &quot;data&quot;: [                                       â”‚
â”‚         {                                           â”‚
â”‚             &quot;organ&quot;: &quot;Heart&quot;,                       â”‚
â”‚             &quot;gene_symbol&quot;: &quot;GAPDH&quot;,                 â”‚
â”‚             ...                                     â”‚
â”‚         },                                          â”‚
â”‚         {                                           â”‚
â”‚             &quot;organ&quot;: &quot;Liver&quot;,                       â”‚
â”‚             &quot;gene_symbol&quot;: &quot;GAPDH&quot;,                 â”‚
â”‚             ...                                     â”‚
â”‚         }                                           â”‚
â”‚     ]                                               â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ HTTP 200 Response
    â”‚ Content-Type: application/json
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: å¤„ç†å“åº”                                       â”‚
â”‚                                                      â”‚
â”‚ const data = await response.json()                  â”‚
â”‚ setSearchResults(data.data)  # æ›´æ–°çŠ¶æ€             â”‚
â”‚ setIsLoading(false)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Reacté‡æ¸²æŸ“                                         â”‚
â”‚                                                      â”‚
â”‚ ResultsTableç»„ä»¶æ˜¾ç¤ºæ•°æ®                             â”‚
â”‚ - éå†searchResults                                 â”‚
â”‚ - æ¸²æŸ“è¡¨æ ¼è¡Œ                                         â”‚
â”‚ - æ˜¾ç¤ºæ¯ä¸ªç»„ç»‡çš„è¡¨è¾¾æ•°æ®                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="23">2.3 å¯è§†åŒ–ç”Ÿæˆæµç¨‹<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ç‚¹å‡»&quot;æ˜¾ç¤ºFold Changeå›¾&quot;æŒ‰é’®                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: è°ƒç”¨API                                        â”‚
â”‚                                                      â”‚
â”‚ fetch(`${API_BASE_URL}/api/gene/symbol/            â”‚
â”‚       showFoldChange?gene_symbol=GAPDH`)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯: create_fold_change_plot()                     â”‚
â”‚                                                      â”‚
â”‚ Step 1: æŸ¥è¯¢åŸºå› æ•°æ®                                 â”‚
â”‚     results = search_gene_data(gene_symbol)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: æå–æ•°æ®                                     â”‚
â”‚                                                      â”‚
â”‚ organs = []                                         â”‚
â”‚ fold_changes = []                                   â”‚
â”‚ colors = []                                         â”‚
â”‚                                                      â”‚
â”‚ for doc in results:                                 â”‚
â”‚     fold_change = float(doc['fold_change_...'])     â”‚
â”‚     organs.append(doc['organ'])                     â”‚
â”‚     fold_changes.append(fold_change)                â”‚
â”‚     colors.append('blue' if fold_change &gt;= 0        â”‚
â”‚                    else 'red')                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: åˆ›å»ºmatplotlibå›¾è¡¨                          â”‚
â”‚                                                      â”‚
â”‚ fig, ax = plt.subplots(figsize=(10, 6))            â”‚
â”‚ ax.bar(organs, fold_changes, color=colors)         â”‚
â”‚ ax.set_title(f'Fold Change for {gene_symbol}')     â”‚
â”‚ ax.set_xlabel('Organ')                              â”‚
â”‚ ax.set_ylabel('Fold Change')                        â”‚
â”‚ plt.tight_layout()                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: è½¬æ¢ä¸ºbase64                                â”‚
â”‚                                                      â”‚
â”‚ buffer = io.BytesIO()                               â”‚
â”‚ plt.savefig(buffer, format='jpg', dpi=300)         â”‚
â”‚ buffer.seek(0)                                      â”‚
â”‚ image_base64 = base64.b64encode(                    â”‚
â”‚     buffer.getvalue()                               â”‚
â”‚ ).decode()                                          â”‚
â”‚ plt.close()                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: è¿”å›å“åº”                                     â”‚
â”‚                                                      â”‚
â”‚ return {                                            â”‚
â”‚     &quot;gene_symbol&quot;: &quot;GAPDH&quot;,                         â”‚
â”‚     &quot;image_base64&quot;: &quot;iVBORw0KGgoAAAANSUhEUg...&quot;    â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: æ˜¾ç¤ºå›¾ç‰‡                                       â”‚
â”‚                                                      â”‚
â”‚ &lt;img src={`data:image/jpeg;base64,${image_base64}`} â”‚
â”‚      alt=&quot;Fold Change Chart&quot; /&gt;                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2 id="_4">ä¸‰ã€ä¸»é¢˜åˆ†ææ¨¡å—è¯¦ç»†æµç¨‹<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 å®Œæ•´åˆ†ææµç¨‹<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ä¸Šä¼ åŸºå› åˆ—è¡¨æ–‡ä»¶ (.txt)                          â”‚
â”‚                                                      â”‚
â”‚ æ–‡ä»¶å†…å®¹ç¤ºä¾‹:                                        â”‚
â”‚ GAPDH                                               â”‚
â”‚ ACTB                                                â”‚
â”‚ TUBB                                                â”‚
â”‚ ...                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: è¯»å–æ–‡ä»¶å†…å®¹                                    â”‚
â”‚                                                      â”‚
â”‚ const fileContent = await file.text()               â”‚
â”‚ # ç»“æœ: &quot;GAPDH\nACTB\nTUBB\n...&quot;                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ„å»ºFormData                                         â”‚
â”‚                                                      â”‚
â”‚ const formData = new FormData()                     â”‚
â”‚ formData.append('file', file)                       â”‚
â”‚ formData.append('selected_themes', JSON.stringify(  â”‚
â”‚     ['Inflammation &amp; immune signaling', ...]        â”‚
â”‚ ))                                                  â”‚
â”‚ formData.append('custom_themes', JSON.stringify([   â”‚
â”‚     {name: 'DNA Repair', keywords: [...]}           â”‚
â”‚ ]))                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ HTTP POST
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯: /api/ontology/custom-analyze                  â”‚
â”‚                                                      â”‚
â”‚ async def custom_analyze(                           â”‚
â”‚     file: UploadFile,                               â”‚
â”‚     selected_themes: str = Form(...),               â”‚
â”‚     custom_themes: str = Form(None)                 â”‚
â”‚ ):                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: è§£æè¯·æ±‚å‚æ•°                                 â”‚
â”‚                                                      â”‚
â”‚ file_content = await file.read()                    â”‚
â”‚ file_content = file_content.decode('utf-8')         â”‚
â”‚                                                      â”‚
â”‚ selected_theme_names = json.loads(selected_themes)  â”‚
â”‚ custom_theme_data = json.loads(custom_themes) if custom_themes else []â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: åŠ è½½åŸºå› åˆ—è¡¨                                 â”‚
â”‚                                                      â”‚
â”‚ genes = ontology_api.load_genes_from_file(          â”‚
â”‚     file_content                                    â”‚
â”‚ )                                                   â”‚
â”‚ # å®ç°:                                             â”‚
â”‚ # genes = []                                        â”‚
â”‚ # for line in file_content.strip().split('\n'):    â”‚
â”‚ #     gene = line.strip()                           â”‚
â”‚ #     if gene:                                      â”‚
â”‚ #         genes.append(gene)                        â”‚
â”‚ # return genes                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: ä¸´æ—¶æ·»åŠ è‡ªå®šä¹‰ä¸»é¢˜                           â”‚
â”‚                                                      â”‚
â”‚ original_themes = ontology_api.themes.copy()        â”‚
â”‚                                                      â”‚
â”‚ for custom_theme in custom_theme_data:              â”‚
â”‚     theme_name = custom_theme.get('name')           â”‚
â”‚     keywords = custom_theme.get('keywords', [])     â”‚
â”‚     ontology_api.themes[theme_name] = keywords      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: æ‰§è¡Œå¯Œé›†åˆ†æ                                 â”‚
â”‚                                                      â”‚
â”‚ enr_df = ontology_api.enrich(genes, p_thresh=1e-2) â”‚
â”‚                                                      â”‚
â”‚ # enrich() å†…éƒ¨æµç¨‹:                                â”‚
â”‚ # 1. è°ƒç”¨GProfiler API:                             â”‚
â”‚ #    df = self.gp.profile(                          â”‚
â”‚ #        organism=&quot;mmusculus&quot;,                      â”‚
â”‚ #        query=genes                                â”‚
â”‚ #    )                                              â”‚
â”‚ # 2. è¿‡æ»¤På€¼:                                       â”‚
â”‚ #    df = df[df[&quot;p_value&quot;] &lt; p_thresh]             â”‚
â”‚ # 3. è®¡ç®—Score:                                     â”‚
â”‚ #    df[&quot;Score&quot;] = -np.log10(df[&quot;p_value&quot;])        â”‚
â”‚ # 4. æ’åº:                                          â”‚
â”‚ #    df = df.sort_values(&quot;p_value&quot;)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ GProfiler APIè°ƒç”¨ï¼ˆå¤–éƒ¨æœåŠ¡ï¼‰
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GProfileræœåŠ¡å™¨å¤„ç†                                  â”‚
â”‚                                                      â”‚
â”‚ 1. æ¥æ”¶åŸºå› åˆ—è¡¨                                      â”‚
â”‚ 2. æŸ¥è¯¢GOæ•°æ®åº“                                      â”‚
â”‚ 3. å¯¹æ¯ä¸ªGOæœ¯è¯­æ‰§è¡Œè¶…å‡ ä½•æ£€éªŒ:                       â”‚
â”‚    P(X â‰¥ k) = Î£ C(M,i) Ã— C(N-M,n-i) / C(N,n)      â”‚
â”‚    (iä»kåˆ°min(n,M))                                 â”‚
â”‚ 4. è®¡ç®—FDRæ ¡æ­£                                       â”‚
â”‚ 5. è¿”å›DataFrame                                     â”‚
â”‚    Columns: name, p_value, term_size, ...          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ è¿”å›DataFrame
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: åˆ†é…ä¸»é¢˜                                     â”‚
â”‚                                                      â”‚
â”‚ enr_df[&quot;Theme&quot;] = enr_df[&quot;name&quot;].apply(             â”‚
â”‚     ontology_api.assign_theme                       â”‚
â”‚ )                                                   â”‚
â”‚                                                      â”‚
â”‚ # assign_theme() å†…éƒ¨:                              â”‚
â”‚ # 1. go_term_lower = name.lower()                   â”‚
â”‚ # 2. for theme, keywords in themes.items():         â”‚
â”‚ #    for keyword in keywords:                       â”‚
â”‚ #        if keyword.lower() in go_term_lower:       â”‚
â”‚ #            return theme                           â”‚
â”‚ # 3. return None                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: è¿‡æ»¤é€‰å®šçš„ä¸»é¢˜                               â”‚
â”‚                                                      â”‚
â”‚ if selected_theme_names:                            â”‚
â”‚     enr_df = enr_df[                                â”‚
â”‚         enr_df[&quot;Theme&quot;].isin(selected_theme_names)  â”‚
â”‚     ]                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 7: èšåˆä¸»é¢˜                                     â”‚
â”‚                                                      â”‚
â”‚ themed_df = ontology_api.aggregate(enr_df)          â”‚
â”‚                                                      â”‚
â”‚ # aggregate() å†…éƒ¨:                                 â”‚
â”‚ # 1. ç§»é™¤æ— ä¸»é¢˜çš„GOæœ¯è¯­:                            â”‚
â”‚ #    themed = df.dropna(subset=[&quot;Theme&quot;])           â”‚
â”‚ # 2. æŒ‰ä¸»é¢˜åˆ†ç»„:                                    â”‚
â”‚ #    grouped = themed.groupby(&quot;Theme&quot;)              â”‚
â”‚ # 3. èšåˆè®¡ç®—:                                      â”‚
â”‚ #    aggregated = grouped.agg(                      â”‚
â”‚ #        Score=(&quot;Score&quot;, &quot;sum&quot;),                    â”‚
â”‚ #        Terms=(&quot;Theme&quot;, &quot;count&quot;)                   â”‚
â”‚ #    )                                              â”‚
â”‚ # 4. æ’åº:                                          â”‚
â”‚ #    aggregated = aggregated.sort_values(           â”‚
â”‚ #        &quot;Score&quot;, ascending=False                   â”‚
â”‚ #    )                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 8: æ¢å¤åŸå§‹ä¸»é¢˜                                 â”‚
â”‚                                                      â”‚
â”‚ ontology_api.themes = original_themes               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 9: å‡†å¤‡å“åº”æ•°æ®                                 â”‚
â”‚                                                      â”‚
â”‚ results = []                                        â”‚
â”‚ for theme_name, row in themed_df.iterrows():        â”‚
â”‚     theme_go_terms = enr_df[                        â”‚
â”‚         enr_df[&quot;Theme&quot;] == theme_name               â”‚
â”‚     ]                                               â”‚
â”‚     results.append({                                â”‚
â”‚         &quot;theme&quot;: theme_name,                        â”‚
â”‚         &quot;score&quot;: float(row[&quot;Score&quot;]),               â”‚
â”‚         &quot;terms_count&quot;: int(row[&quot;Terms&quot;]),           â”‚
â”‚         &quot;go_terms&quot;: theme_go_terms.to_dict('records')â”‚
â”‚     })                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 10: è¿”å›JSONå“åº”                                â”‚
â”‚                                                      â”‚
â”‚ return {                                            â”‚
â”‚     &quot;results&quot;: results,                             â”‚
â”‚     &quot;message&quot;: &quot;Analysis completed&quot;                 â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ HTTP 200 Response
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: æ˜¾ç¤ºç»“æœ                                       â”‚
â”‚                                                      â”‚
â”‚ setResults(data.results)                            â”‚
â”‚ # æ¸²æŸ“ç»“æœè¡¨æ ¼                                       â”‚
â”‚ # æ˜¾ç¤ºä¸»é¢˜ã€åˆ†æ•°ã€GOæœ¯è¯­æ•°é‡                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="32">3.2 ä¸»é¢˜åŒ¹é…ç®—æ³•è¯¦ç»†æµç¨‹<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<pre><code>è¾“å…¥: GOæœ¯è¯­åç§° &quot;inflammatory response&quot;

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: è½¬æ¢ä¸ºå°å†™                                   â”‚
â”‚                                                      â”‚
â”‚ go_term_lower = &quot;inflammatory response&quot;             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: éå†æ‰€æœ‰ä¸»é¢˜                                 â”‚
â”‚                                                      â”‚
â”‚ for theme_name, keywords in themes.items():         â”‚
â”‚     # theme_name: &quot;Inflammation &amp; immune signaling&quot; â”‚
â”‚     # keywords: [&quot;inflammatory&quot;, &quot;immune&quot;, ...]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: éå†ä¸»é¢˜çš„å…³é”®è¯                             â”‚
â”‚                                                      â”‚
â”‚ for keyword in keywords:                            â”‚
â”‚     # keyword: &quot;inflammatory&quot;                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: æ£€æŸ¥å…³é”®è¯æ˜¯å¦åœ¨GOæœ¯è¯­åç§°ä¸­                 â”‚
â”‚                                                      â”‚
â”‚ if keyword.lower() in go_term_lower:                â”‚
â”‚     # &quot;inflammatory&quot; in &quot;inflammatory response&quot;      â”‚
â”‚     # â†’ True                                        â”‚
â”‚     return theme_name  # è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä¸»é¢˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿”å›: &quot;Inflammation &amp; immune signaling&quot;             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¦‚æœæ²¡æœ‰åŒ¹é…:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿”å›: None                                          â”‚
â”‚ (è¯¥GOæœ¯è¯­åœ¨èšåˆé˜¶æ®µä¼šè¢«è¿‡æ»¤æ‰)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2 id="ivcca">å››ã€IVCCAåˆ†ææ¨¡å—è¯¦ç»†æµç¨‹<a class="headerlink" href="#ivcca" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 æ•°æ®åŠ è½½æµç¨‹<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ä¸Šä¼ æ•°æ®æ–‡ä»¶ (.xlsx/.csv/.tsv)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: POST /api/ivcca/load-data                     â”‚
â”‚                                                      â”‚
â”‚ const formData = new FormData()                     â”‚
â”‚ formData.append('file', file)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯å¤„ç†                                             â”‚
â”‚                                                      â”‚
â”‚ Step 1: åˆ›å»ºIVCCAAnalyzerå®ä¾‹                       â”‚
â”‚     analyzer = IVCCAAnalyzer()                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: è°ƒç”¨analyzer.load_data(file_path)           â”‚
â”‚                                                      â”‚
â”‚ def load_data(self, file_path: str):                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: æ£€æµ‹æ–‡ä»¶ç±»å‹                                 â”‚
â”‚                                                      â”‚
â”‚ if file_path.endswith('.xlsx'):                     â”‚
â”‚     df = pd.read_excel(file_path)                   â”‚
â”‚ elif file_path.endswith('.csv'):                    â”‚
â”‚     df = pd.read_csv(file_path)                     â”‚
â”‚ elif file_path.endswith('.tsv'):                    â”‚
â”‚     df = pd.read_csv(file_path, sep='\t')           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: æå–æ•°æ®ç»“æ„                                 â”‚
â”‚                                                      â”‚
â”‚ sample_col = df.columns[0]                          â”‚
â”‚ self.sample_names = df[sample_col].tolist()         â”‚
â”‚ # ç»“æœ: ['Sample1', 'Sample2', ...]                â”‚
â”‚                                                      â”‚
â”‚ self.gene_names = [col for col in df.columns[1:]]   â”‚
â”‚ # ç»“æœ: ['Gene1', 'Gene2', ...]                    â”‚
â”‚                                                      â”‚
â”‚ self.data = df.iloc[:, 1:].values                   â”‚
â”‚ # ç»“æœ: numpyæ•°ç»„ (samples Ã— genes)                 â”‚
â”‚ # [[val11, val12, ...],                            â”‚
â”‚ #  [val21, val22, ...],                             â”‚
â”‚ #  ...]                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: æ•°æ®ç±»å‹è½¬æ¢å’ŒéªŒè¯                           â”‚
â”‚                                                      â”‚
â”‚ self.data = pd.DataFrame(self.data).apply(          â”‚
â”‚     pd.to_numeric, errors='coerce'                  â”‚
â”‚ ).values                                            â”‚
â”‚                                                      â”‚
â”‚ # æ£€æŸ¥NaNå€¼:                                        â”‚
â”‚ nan_count = np.isnan(self.data).sum()               â”‚
â”‚ if nan_count &gt; 0:                                   â”‚
â”‚     print(f&quot;Warning: {nan_count} NaN values&quot;)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: è®¾ç½®çŠ¶æ€æ ‡å¿—                                 â”‚
â”‚                                                      â”‚
â”‚ self.data_loaded = True                             â”‚
â”‚ self.correlation_calculated = False                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 7: ç”Ÿæˆæ•°æ®é¢„è§ˆ                                 â”‚
â”‚                                                      â”‚
â”‚ preview = {                                         â”‚
â”‚     &quot;columns&quot;: [sample_col] + self.gene_names,      â”‚
â”‚     &quot;rows&quot;: [...]  # å‰å‡ è¡Œæ•°æ®                      â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 8: å­˜å‚¨analyzeråˆ°å†…å­˜                          â”‚
â”‚                                                      â”‚
â”‚ analyzer_id = str(uuid.uuid4())                     â”‚
â”‚ analyzers[analyzer_id] = analyzer                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 9: è¿”å›å“åº”                                     â”‚
â”‚                                                      â”‚
â”‚ return {                                            â”‚
â”‚     &quot;status&quot;: &quot;success&quot;,                            â”‚
â”‚     &quot;analyzer_id&quot;: analyzer_id,                     â”‚
â”‚     &quot;n_samples&quot;: self.data.shape[0],                â”‚
â”‚     &quot;n_genes&quot;: self.data.shape[1],                  â”‚
â”‚     &quot;preview&quot;: preview                              â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="42">4.2 ç›¸å…³æ€§è®¡ç®—æµç¨‹<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ç‚¹å‡»&quot;è®¡ç®—ç›¸å…³æ€§&quot;æŒ‰é’®                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: POST /api/ivcca/calculate-correlation         â”‚
â”‚                                                      â”‚
â”‚ Body: {                                             â”‚
â”‚     &quot;analyzer_id&quot;: &quot;uuid-string&quot;,                   â”‚
â”‚     &quot;method&quot;: &quot;pearson&quot;                             â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯: ä»å†…å­˜è·å–analyzer                             â”‚
â”‚                                                      â”‚
â”‚ analyzer = analyzers.get(analyzer_id)               â”‚
â”‚ if not analyzer:                                    â”‚
â”‚     raise HTTPException(404, &quot;Analyzer not found&quot;)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è°ƒç”¨: analyzer.calculate_correlations(method)        â”‚
â”‚                                                      â”‚
â”‚ def calculate_correlations(self, method='pearson'): â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: æ£€æŸ¥æ•°æ®æ˜¯å¦å·²åŠ è½½                           â”‚
â”‚                                                      â”‚
â”‚ if not self.data_loaded:                            â”‚
â”‚     return {&quot;status&quot;: &quot;error&quot;, ...}                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: è½¬æ¢ä¸ºDataFrame                              â”‚
â”‚                                                      â”‚
â”‚ data_df = pd.DataFrame(                             â”‚
â”‚     self.data,                                      â”‚
â”‚     columns=self.gene_names                         â”‚
â”‚ )                                                   â”‚
â”‚ # Shape: (samples, genes)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: è®¡ç®—ç›¸å…³æ€§çŸ©é˜µ                               â”‚
â”‚                                                      â”‚
â”‚ if method == 'pearson':                             â”‚
â”‚     self.correlation_matrix = data_df.corr(         â”‚
â”‚         method='pearson'                            â”‚
â”‚     ).values                                        â”‚
â”‚ # pandas.corr()å†…éƒ¨:                                â”‚
â”‚ # - å¯¹æ¯å¯¹åŸºå› è®¡ç®—Pearsonç›¸å…³ç³»æ•°                    â”‚
â”‚ # - è¿”å›ç›¸å…³æ€§çŸ©é˜µ (genes Ã— genes)                   â”‚
â”‚ # - å¯¹è§’çº¿ä¸º1ï¼ˆè‡ªç›¸å…³ï¼‰                              â”‚
â”‚ # - çŸ©é˜µå¯¹ç§°                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: å¤„ç†NaNå€¼                                    â”‚
â”‚                                                      â”‚
â”‚ self.correlation_matrix = np.nan_to_num(            â”‚
â”‚     self.correlation_matrix,                        â”‚
â”‚     nan=0.0                                         â”‚
â”‚ )                                                   â”‚
â”‚ # å°†NaNæ›¿æ¢ä¸º0ï¼ˆé€šå¸¸ç”±äºå¸¸æ•°å€¼å¯¼è‡´ï¼‰                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: è®¡ç®—ç»Ÿè®¡ä¿¡æ¯                                 â”‚
â”‚                                                      â”‚
â”‚ # æå–ä¸Šä¸‰è§’çŸ©é˜µï¼ˆæ’é™¤å¯¹è§’çº¿å’Œä¸‹ä¸‰è§’ï¼‰                â”‚
â”‚ corr_values = self.correlation_matrix[              â”‚
â”‚     np.triu_indices_from(                           â”‚
â”‚         self.correlation_matrix,                    â”‚
â”‚         k=1                                         â”‚
â”‚     )                                               â”‚
â”‚ ]                                                   â”‚
â”‚                                                      â”‚
â”‚ stats = {                                           â”‚
â”‚     &quot;mean&quot;: float(np.mean(corr_values)),            â”‚
â”‚     &quot;std&quot;: float(np.std(corr_values)),              â”‚
â”‚     &quot;min&quot;: float(np.min(corr_values)),              â”‚
â”‚     &quot;max&quot;: float(np.max(corr_values)),              â”‚
â”‚     &quot;median&quot;: float(np.median(corr_values))         â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: è®¾ç½®çŠ¶æ€æ ‡å¿—                                 â”‚
â”‚                                                      â”‚
â”‚ self.correlation_calculated = True                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 7: è¿”å›å“åº”                                     â”‚
â”‚                                                      â”‚
â”‚ return {                                            â”‚
â”‚     &quot;status&quot;: &quot;success&quot;,                            â”‚
â”‚     &quot;matrix_size&quot;: self.correlation_matrix.shape,   â”‚
â”‚     &quot;statistics&quot;: stats                             â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="43">4.3 çŸ©é˜µæ’åºæµç¨‹<a class="headerlink" href="#43" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ç‚¹å‡»&quot;æ’åº&quot;æŒ‰é’®                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯: analyzer.sort_correlation_matrix()             â”‚
â”‚                                                      â”‚
â”‚ def sort_correlation_matrix(self):                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: è®¡ç®—æ¯ä¸ªåŸºå› çš„å¹³å‡ç»å¯¹ç›¸å…³æ€§                  â”‚
â”‚                                                      â”‚
â”‚ abs_corr = np.abs(self.correlation_matrix)          â”‚
â”‚ # å–ç»å¯¹å€¼: æ­£ç›¸å…³å’Œè´Ÿç›¸å…³éƒ½è§†ä¸ºç›¸å…³æ€§                â”‚
â”‚                                                      â”‚
â”‚ np.fill_diagonal(abs_corr, 0)                       â”‚
â”‚ # å¯¹è§’çº¿è®¾ä¸º0ï¼ˆæ’é™¤è‡ªç›¸å…³ï¼‰                          â”‚
â”‚                                                      â”‚
â”‚ gene_scores = np.mean(abs_corr, axis=1)             â”‚
â”‚ # å¯¹æ¯ä¸€è¡Œæ±‚å‡å€¼ï¼Œå¾—åˆ°æ¯ä¸ªåŸºå› çš„å¹³å‡ç»å¯¹ç›¸å…³æ€§         â”‚
â”‚ # gene_scores[i] = mean(|r_ij|) for j â‰  i          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: æ’åºç´¢å¼•                                     â”‚
â”‚                                                      â”‚
â”‚ sorted_indices = np.argsort(gene_scores)[::-1]      â”‚
â”‚ # argsortè¿”å›ä»å°åˆ°å¤§çš„ç´¢å¼•                          â”‚
â”‚ # [::-1]åè½¬ï¼Œå¾—åˆ°ä»å¤§åˆ°å°çš„ç´¢å¼•                      â”‚
â”‚ # ç»“æœ: [5, 12, 3, ...]  # åŸºå› 5çš„ç›¸å…³æ€§æœ€é«˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: ä½¿ç”¨æ’åºç´¢å¼•é‡æ–°æ’åˆ—                         â”‚
â”‚                                                      â”‚
â”‚ sorted_matrix = self.correlation_matrix[            â”‚
â”‚     sorted_indices[:, None],                        â”‚
â”‚     sorted_indices                                  â”‚
â”‚ ]                                                   â”‚
â”‚ # åŒæ—¶é‡æ–°æ’åˆ—è¡Œå’Œåˆ—                                 â”‚
â”‚                                                      â”‚
â”‚ sorted_gene_names = [                               â”‚
â”‚     self.gene_names[i]                              â”‚
â”‚     for i in sorted_indices                         â”‚
â”‚ ]                                                   â”‚
â”‚                                                      â”‚
â”‚ sorted_scores = gene_scores[sorted_indices]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: è¿”å›æ’åºç»“æœ                                 â”‚
â”‚                                                      â”‚
â”‚ return {                                            â”‚
â”‚     &quot;status&quot;: &quot;success&quot;,                            â”‚
â”‚     &quot;sorted_matrix&quot;: sorted_matrix.tolist(),        â”‚
â”‚     &quot;sorted_gene_names&quot;: sorted_gene_names,         â”‚
â”‚     &quot;sorted_scores&quot;: sorted_scores.tolist()         â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="44-pca">4.4 PCAåˆ†ææµç¨‹<a class="headerlink" href="#44-pca" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ç‚¹å‡»&quot;æ‰§è¡ŒPCA&quot;æŒ‰é’®                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯: analyzer.perform_pca(n_components=3)           â”‚
â”‚                                                      â”‚
â”‚ def perform_pca(self, n_components=3):              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: ä½¿ç”¨ç›¸å…³æ€§çŸ©é˜µä½œä¸ºè¾“å…¥                        â”‚
â”‚                                                      â”‚
â”‚ data = np.abs(self.correlation_matrix)              â”‚
â”‚ # ä½¿ç”¨ç»å¯¹ç›¸å…³æ€§çŸ©é˜µ                                 â”‚
â”‚ # Shape: (genes, genes)                             â”‚
â”‚ # æ¯ä¸ªåŸºå› æ˜¯ä¸€ä¸ª&quot;æ ·æœ¬&quot;ï¼ŒåŸºå› é—´çš„ç›¸å…³æ€§æ˜¯&quot;ç‰¹å¾&quot;         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: å¡«å……NaNå€¼                                    â”‚
â”‚                                                      â”‚
â”‚ data_filled = np.nan_to_num(data, nan=0.0)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: æ‰§è¡ŒPCAï¼ˆä½¿ç”¨sklearnï¼‰                       â”‚
â”‚                                                      â”‚
â”‚ from sklearn.decomposition import PCA               â”‚
â”‚                                                      â”‚
â”‚ pca = PCA(n_components=25)  # è®¡ç®—25ä¸ªä¸»æˆåˆ†        â”‚
â”‚ pca.fit(data_filled)                                â”‚
â”‚                                                      â”‚
â”‚ # PCAå†…éƒ¨æ­¥éª¤:                                      â”‚
â”‚ # 1. æ ‡å‡†åŒ–æ•°æ®ï¼ˆå¦‚æœéœ€è¦ï¼‰                          â”‚
â”‚ # 2. è®¡ç®—åæ–¹å·®çŸ©é˜µ                                   â”‚
â”‚ # 3. ç‰¹å¾å€¼åˆ†è§£: C = Q Ã— Î› Ã— Q^T                    â”‚
â”‚ # 4. é€‰æ‹©å‰kä¸ªä¸»æˆåˆ†                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: è®¡ç®—ä¸»æˆåˆ†åˆ†æ•°                               â”‚
â”‚                                                      â”‚
â”‚ pca_scores = pca.transform(data_filled)             â”‚
â”‚ # Shape: (genes, n_components)                      â”‚
â”‚ # æ¯ä¸ªåŸºå› åœ¨ä¸»æˆåˆ†ç©ºé—´ä¸­çš„åæ ‡                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: è®¡ç®—è§£é‡Šæ–¹å·®                                 â”‚
â”‚                                                      â”‚
â”‚ explained_variance = pca.explained_variance_ratio_  â”‚
â”‚ # æ¯ä¸ªä¸»æˆåˆ†è§£é‡Šçš„æ–¹å·®æ¯”ä¾‹                            â”‚
â”‚ # ä¾‹å¦‚: [0.25, 0.15, 0.10, ...]                    â”‚
â”‚ # è¡¨ç¤ºPC1è§£é‡Š25%çš„æ–¹å·®ï¼ŒPC2è§£é‡Š15%ï¼Œç­‰ç­‰             â”‚
â”‚                                                      â”‚
â”‚ cumulative_variance = np.cumsum(explained_variance) â”‚
â”‚ # ç´¯ç§¯æ–¹å·®: [0.25, 0.40, 0.50, ...]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: ç”Ÿæˆå¯è§†åŒ–                                   â”‚
â”‚                                                      â”‚
â”‚ # 6.1 Screeå›¾ï¼ˆç´¯ç§¯æ–¹å·®ï¼‰                            â”‚
â”‚ fig = go.Figure()                                   â”‚
â”‚ fig.add_trace(go.Scatter(                           â”‚
â”‚     x=components,                                   â”‚
â”‚     y=cumulative_variance * 100,  # è½¬æ¢ä¸ºç™¾åˆ†æ¯”    â”‚
â”‚     mode='lines+markers'                            â”‚
â”‚ ))                                                  â”‚
â”‚                                                      â”‚
â”‚ # 6.2 3Dæ•£ç‚¹å›¾                                      â”‚
â”‚ fig = go.Figure()                                   â”‚
â”‚ fig.add_trace(go.Scatter3d(                         â”‚
â”‚     x=pca_scores[:, 0],  # PC1                      â”‚
â”‚     y=pca_scores[:, 1],  # PC2                      â”‚
â”‚     z=pca_scores[:, 2],  # PC3                      â”‚
â”‚     text=gene_names,                                â”‚
â”‚     mode='markers'                                  â”‚
â”‚ ))                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 7: è½¬æ¢ä¸ºJSONï¼ˆPlotlyï¼‰                        â”‚
â”‚                                                      â”‚
â”‚ plot_data = fig.to_json()                           â”‚
â”‚ # Plotlyå›¾è¡¨é…ç½®ï¼ˆJSONæ ¼å¼ï¼‰                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 8: è¿”å›å“åº”                                     â”‚
â”‚                                                      â”‚
â”‚ return {                                            â”‚
â”‚     &quot;status&quot;: &quot;success&quot;,                            â”‚
â”‚     &quot;scores&quot;: pca_scores.tolist(),                  â”‚
â”‚     &quot;explained_variance&quot;: explained_variance.tolist(),â”‚
â”‚     &quot;cumulative_variance&quot;: cumulative_variance.tolist(),â”‚
â”‚     &quot;scree_plot&quot;: {&quot;type&quot;: &quot;plotly&quot;, &quot;content&quot;: ...},â”‚
â”‚     &quot;scatter_plot&quot;: {&quot;type&quot;: &quot;plotly&quot;, &quot;content&quot;: ...}â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯: æ¸²æŸ“Plotlyå›¾è¡¨                                 â”‚
â”‚                                                      â”‚
â”‚ &lt;Plot                                               â”‚
â”‚     data={JSON.parse(plot_data.content)}            â”‚
â”‚     layout={...}                                    â”‚
â”‚ /&gt;                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="45">4.5 å¤šé€šè·¯åˆ†ææµç¨‹<a class="headerlink" href="#45" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·é€‰æ‹©å¤šä¸ªé€šè·¯æ–‡ä»¶å¹¶ç‚¹å‡»&quot;åˆ†æ&quot;                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯: analyzer.multi_pathway_analysis()              â”‚
â”‚                                                      â”‚
â”‚ def multi_pathway_analysis(                         â”‚
â”‚     self,                                           â”‚
â”‚     pathway_files: List[str],                       â”‚
â”‚     pathway_genes_list: List[List[str]],            â”‚
â”‚     sorted_genes: List[str] = None,                 â”‚
â”‚     sorted_correlations: List[float] = None         â”‚
â”‚ ):                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éå†æ¯ä¸ªé€šè·¯                                         â”‚
â”‚                                                      â”‚
â”‚ for pathway_file, pathway_genes in                  â”‚
â”‚     zip(pathway_files, pathway_genes_list):         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: æ‰¾åˆ°é€šè·¯åŸºå› åœ¨æ•°æ®é›†ä¸­çš„ç´¢å¼•                  â”‚
â”‚                                                      â”‚
â”‚ pathway_indices = []                                â”‚
â”‚ for gene in pathway_genes:                          â”‚
â”‚     gene_lower = gene.lower()                       â”‚
â”‚     if gene_lower in gene_names_lower:              â”‚
â”‚         idx = gene_names_lower.index(gene_lower)    â”‚
â”‚         pathway_indices.append(idx)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: æ£€æŸ¥æœ€å°åŸºå› æ•°é˜ˆå€¼                           â”‚
â”‚                                                      â”‚
â”‚ if len(pathway_indices) &lt; min_genes_threshold:      â”‚
â”‚     continue  # è·³è¿‡è¯¥é€šè·¯                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: è®¡ç®—PCI_Aï¼ˆé€šè·¯å†…ç›¸å…³æ€§ï¼‰                     â”‚
â”‚                                                      â”‚
â”‚ # æå–é€šè·¯ç›¸å…³æ€§å­çŸ©é˜µ                                â”‚
â”‚ pathway_corr = self.correlation_matrix[             â”‚
â”‚     np.ix_(pathway_indices, pathway_indices)        â”‚
â”‚ ]                                                   â”‚
â”‚ # Shape: (k, k) where k = len(pathway_indices)      â”‚
â”‚                                                      â”‚
â”‚ # è®¡ç®—ç»å¯¹ç›¸å…³æ€§                                      â”‚
â”‚ abs_pathway_corr = np.abs(pathway_corr)             â”‚
â”‚ np.fill_diagonal(abs_pathway_corr, 0)               â”‚
â”‚                                                      â”‚
â”‚ # è®¡ç®—æ¯ä¸ªåŸºå› çš„å¹³å‡ç»å¯¹ç›¸å…³æ€§                         â”‚
â”‚ sum_abs_correlations = np.sum(                      â”‚
â”‚     abs_pathway_corr, axis=1                        â”‚
â”‚ )                                                   â”‚
â”‚ avg_abs_correlation = sum_abs_correlations / (      â”‚
â”‚     len(pathway_indices) - 1                        â”‚
â”‚ )                                                   â”‚
â”‚                                                      â”‚
â”‚ # è®¡ç®—PCI_Aï¼ˆé€šè·¯å†…å¹³å‡ï¼‰                            â”‚
â”‚ pci_a = float(np.mean(avg_abs_correlation))         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: è®¡ç®—PCI_Bï¼ˆä»å…¨å±€æ’åºä¸­æå–ï¼‰                 â”‚
â”‚                                                      â”‚
â”‚ if sorted_genes and sorted_correlations:            â”‚
â”‚     pci_b_values = []                               â”‚
â”‚     for gene in pathway_genes:                      â”‚
â”‚         if gene in sorted_genes:                    â”‚
â”‚             idx = sorted_genes.index(gene)          â”‚
â”‚             pci_b_values.append(                    â”‚
â”‚                 sorted_correlations[idx]             â”‚
â”‚             )                                       â”‚
â”‚     pci_b = float(np.mean(pci_b_values))            â”‚
â”‚ else:                                               â”‚
â”‚     pci_b = None                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: è®¡ç®—PAIï¼ˆé€šè·¯æ¿€æ´»æŒ‡æ•°ï¼‰                       â”‚
â”‚                                                      â”‚
â”‚ pai = len(pathway_indices) / len(pathway_genes)     â”‚
â”‚ # æ•°æ®é›†ä¸­å‘ç°çš„åŸºå› æ•° / é€šè·¯æ€»åŸºå› æ•°                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: è®¡ç®—CECIï¼ˆç›¸å…³æ€§-è¡¨è¾¾å¤åˆæŒ‡æ•°ï¼‰               â”‚
â”‚                                                      â”‚
â”‚ if pci_b is not None:                               â”‚
â”‚     ceci = pai * pci_b * 100                        â”‚
â”‚ else:                                               â”‚
â”‚     ceci = pai * pci_a * 100                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 7: è®¡ç®—Z-score                                  â”‚
â”‚                                                      â”‚
â”‚ z_score = (ceci - 7.908) / 2.0605                  â”‚
â”‚ # 7.908: éšæœºåŸºå› é›†çš„CECIå‡å€¼                        â”‚
â”‚ # 2.0605: éšæœºåŸºå› é›†çš„CECIæ ‡å‡†å·®                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 8: å­˜å‚¨ç»“æœ                                     â”‚
â”‚                                                      â”‚
â”‚ results.append({                                    â”‚
â”‚     &quot;pathway_file&quot;: pathway_file,                   â”‚
â”‚     &quot;total_genes_in_pathway&quot;: len(pathway_genes),   â”‚
â”‚     &quot;genes_found_in_set&quot;: len(pathway_indices),     â”‚
â”‚     &quot;pai&quot;: float(pai),                              â”‚
â”‚     &quot;pci_a&quot;: pci_a,                                 â”‚
â”‚     &quot;pci_b&quot;: pci_b,                                 â”‚
â”‚     &quot;ceci&quot;: float(ceci),                            â”‚
â”‚     &quot;z_score&quot;: float(z_score)                       â”‚
â”‚ })                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 9: æŒ‰CECIæ’åº                                   â”‚
â”‚                                                      â”‚
â”‚ results.sort(                                       â”‚
â”‚     key=lambda x: x[&quot;ceci&quot;]                         â”‚
â”‚     if x[&quot;ceci&quot;] is not None                        â”‚
â”‚     else -float('inf'),                             â”‚
â”‚     reverse=True                                    â”‚
â”‚ )                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 10: è¿”å›ç»“æœ                                    â”‚
â”‚                                                      â”‚
â”‚ return {                                            â”‚
â”‚     &quot;status&quot;: &quot;success&quot;,                            â”‚
â”‚     &quot;pathways&quot;: results,                            â”‚
â”‚     &quot;n_pathways&quot;: len(results)                      â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2 id="_5">äº”ã€ç»„ä»¶é—´äº¤äº’å…³ç³»<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 å‰ç«¯ç»„ä»¶äº¤äº’<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RootLayout    â”‚
â”‚  (layout.tsx)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                          â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                            â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚  Page    â”‚                            â”‚  Navigation â”‚
    â”‚ Componentâ”‚                            â”‚  Component  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                  â”‚                   â”‚             â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ GeneSearch   â”‚  â”‚ ThemeAnalysis â”‚  â”‚ IVCCA Analysis â”‚
    â”‚ Page         â”‚  â”‚ Page          â”‚  â”‚ Page           â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚                   â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ SearchInput  â”‚  â”‚ FileUpload    â”‚  â”‚ DataUpload     â”‚
    â”‚ Component    â”‚  â”‚ Component     â”‚  â”‚ Component      â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚                   â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ResultsTable â”‚  â”‚ ThemeSelector â”‚  â”‚ AnalysisControlsâ”‚
    â”‚ Component    â”‚  â”‚ Component     â”‚  â”‚ Component       â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚                   â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ PlotDisplay  â”‚  â”‚ ChartDisplay  â”‚  â”‚ Visualization  â”‚
    â”‚ Component    â”‚  â”‚ Component     â”‚  â”‚ Panel          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ‰€æœ‰ç»„ä»¶é€šè¿‡ä»¥ä¸‹æ–¹å¼é€šä¿¡:
â”œâ”€â†’ Propsä¼ é€’ï¼ˆçˆ¶â†’å­ï¼‰
â”œâ”€â†’ Stateæå‡ï¼ˆå­â†’çˆ¶é€šè¿‡å›è°ƒå‡½æ•°ï¼‰
â””â”€â†’ APIè°ƒç”¨ï¼ˆç»„ä»¶â†’åç«¯ï¼‰
</code></pre>
<h3 id="52">5.2 åç«¯ç±»äº¤äº’<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         FastAPI App                  â”‚
â”‚         (server.py)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                  â”‚                  â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚GeneSearchAPIâ”‚   â”‚GeneOntologyAPIâ”‚   â”‚IVCCAAnalyzer    â”‚
    â”‚             â”‚   â”‚               â”‚   â”‚(ivcca_core.py)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                  â”‚                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   MongoDB   â”‚   â”‚ GProfiler    â”‚   â”‚  NumPy/SciPy    â”‚
    â”‚  Collection â”‚   â”‚    API       â”‚   â”‚  scikit-learn   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ•°æ®æµå‘:
â”œâ”€â†’ GeneSearchAPI â†â†’ MongoDB
â”œâ”€â†’ GeneOntologyAPI â†’ GProfiler API â†’ å¯Œé›†ç»“æœ
â””â”€â†’ IVCCAAnalyzer â†’ ç®—æ³•åº“ â†’ åˆ†æç»“æœ
</code></pre>
<h3 id="53">5.3 æ•°æ®æµæ€»è§ˆ<a class="headerlink" href="#53" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·æ“ä½œ    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        å‰ç«¯ç»„ä»¶                      â”‚
â”‚        (React State)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ HTTP Request (JSON)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      FastAPIè·¯ç”±                     â”‚
â”‚      (Request Validation)            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚              â”‚              â”‚              â”‚
       â–¼              â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚MongoDB   â”‚  â”‚GProfiler APIâ”‚  â”‚ç®—æ³•è®¡ç®—   â”‚  â”‚æ–‡ä»¶ç³»ç»Ÿ   â”‚
â”‚æŸ¥è¯¢/å†™å…¥  â”‚  â”‚å¯Œé›†åˆ†æ     â”‚  â”‚(NumPyç­‰)  â”‚  â”‚(Excel)   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚               â”‚             â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    æ•°æ®å¤„ç†å’Œè®¡ç®—     â”‚
          â”‚    (ä¸šåŠ¡é€»è¾‘å±‚)       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    å“åº”ç”Ÿæˆ           â”‚
          â”‚    (JSON/Base64)     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTP Response
                     â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    å‰ç«¯æ›´æ–°çŠ¶æ€       â”‚
          â”‚    (React Re-render) â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    ç”¨æˆ·çœ‹åˆ°ç»“æœ       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2 id="_6">å…­ã€å…³é”®ç®—æ³•æ‰§è¡Œæµç¨‹<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<h3 id="61-pearson">6.1 Pearsonç›¸å…³ç³»æ•°è®¡ç®—ï¼ˆè¯¦ç»†ï¼‰<a class="headerlink" href="#61-pearson" title="Permanent link">&para;</a></h3>
<pre><code>è¾“å…¥: ä¸¤ä¸ªåŸºå› è¡¨è¾¾å‘é‡
X = [x1, x2, ..., xn]  (nä¸ªæ ·æœ¬)
Y = [y1, y2, ..., yn]

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: è®¡ç®—å‡å€¼                                     â”‚
â”‚                                                      â”‚
â”‚ x_mean = (x1 + x2 + ... + xn) / n                   â”‚
â”‚ y_mean = (y1 + y2 + ... + yn) / n                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: è®¡ç®—åæ–¹å·®åˆ†å­                                â”‚
â”‚                                                      â”‚
â”‚ numerator = Î£(xi - x_mean) Ã— (yi - y_mean)         â”‚
â”‚           = (x1-x_mean)(y1-y_mean) +                â”‚
â”‚             (x2-x_mean)(y2-y_mean) +                â”‚
â”‚             ... +                                   â”‚
â”‚             (xn-x_mean)(yn-y_mean)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: è®¡ç®—æ ‡å‡†å·®                                   â”‚
â”‚                                                      â”‚
â”‚ x_var = Î£(xi - x_mean)Â²                            â”‚
â”‚       = (x1-x_mean)Â² + (x2-x_mean)Â² + ...          â”‚
â”‚                                                      â”‚
â”‚ y_var = Î£(yi - y_mean)Â²                            â”‚
â”‚       = (y1-y_mean)Â² + (y2-y_mean)Â² + ...          â”‚
â”‚                                                      â”‚
â”‚ x_std = âˆšx_var                                      â”‚
â”‚ y_std = âˆšy_var                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: è®¡ç®—ç›¸å…³ç³»æ•°                                 â”‚
â”‚                                                      â”‚
â”‚ r = numerator / (x_std Ã— y_std)                     â”‚
â”‚                                                      â”‚
â”‚ å¦‚æœ denominator == 0:                              â”‚
â”‚     r = NaN  # å…¶ä¸­ä¸€ä¸ªåŸºå› æ— å˜å¼‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¾“å‡º: r âˆˆ [-1, 1]                                   â”‚
â”‚                                                      â”‚
â”‚ r = 1:  å®Œå…¨æ­£ç›¸å…³                                   â”‚
â”‚ r = 0:  æ— çº¿æ€§ç›¸å…³                                   â”‚
â”‚ r = -1: å®Œå…¨è´Ÿç›¸å…³                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å‘é‡åŒ–å®ç°ï¼ˆpandasï¼‰:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ data_df.corr(method='pearson')                      â”‚
â”‚                                                      â”‚
â”‚ å†…éƒ¨å¯¹æ¯å¯¹åŸºå› åˆ—æ‰§è¡Œä¸Šè¿°è®¡ç®—ï¼Œæ„å»ºç›¸å…³æ€§çŸ©é˜µ           â”‚
â”‚ æ—¶é—´å¤æ‚åº¦: O(n Ã— mÂ²) å…¶ä¸­n=æ ·æœ¬æ•°ï¼Œm=åŸºå› æ•°         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="62-ceci">6.2 CECIè®¡ç®—æµç¨‹ï¼ˆè¯¦ç»†ï¼‰<a class="headerlink" href="#62-ceci" title="Permanent link">&para;</a></h3>
<pre><code>è¾“å…¥:
- pathway_genes: ['Gene1', 'Gene2', ...]  # é€šè·¯åŸºå› åˆ—è¡¨
- sorted_genes: ['Gene5', 'Gene12', ...]  # å…¨å±€æ’åºåŸºå› 
- sorted_correlations: [0.85, 0.82, ...]  # å¯¹åº”çš„ç›¸å…³æ€§åˆ†æ•°

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: åŒ¹é…é€šè·¯åŸºå› åˆ°æ•°æ®é›†                         â”‚
â”‚                                                      â”‚
â”‚ pathway_indices = []                                â”‚
â”‚ for gene in pathway_genes:                          â”‚
â”‚     if gene in dataset_genes:                       â”‚
â”‚         idx = find_index(gene)                      â”‚
â”‚         pathway_indices.append(idx)                 â”‚
â”‚                                                      â”‚
â”‚ # ç¤ºä¾‹:                                             â”‚
â”‚ # pathway_genes = ['GAPDH', 'ACTB', 'TUBB']        â”‚
â”‚ # pathway_indices = [5, 12, 23]  # åœ¨æ•°æ®é›†ä¸­çš„ç´¢å¼• â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: è®¡ç®—PCI_Aï¼ˆé€šè·¯å†…ç›¸å…³æ€§ï¼‰                     â”‚
â”‚                                                      â”‚
â”‚ # 2.1 æå–é€šè·¯ç›¸å…³æ€§å­çŸ©é˜µ                            â”‚
â”‚ pathway_corr = correlation_matrix[                  â”‚
â”‚     pathway_indices, :][:, pathway_indices]         â”‚
â”‚ # Shape: (k, k) å…¶ä¸­k = len(pathway_indices)        â”‚
â”‚                                                      â”‚
â”‚ # 2.2 è®¡ç®—ç»å¯¹ç›¸å…³æ€§                                  â”‚
â”‚ abs_pathway_corr = |pathway_corr|                   â”‚
â”‚ abs_pathway_corr[diagonal] = 0  # æ’é™¤è‡ªç›¸å…³        â”‚
â”‚                                                      â”‚
â”‚ # 2.3 è®¡ç®—æ¯ä¸ªåŸºå› çš„å¹³å‡ç»å¯¹ç›¸å…³æ€§                     â”‚
â”‚ for i in range(k):                                  â”‚
â”‚     Q_i = mean(abs_pathway_corr[i, :])              â”‚
â”‚     # æ’é™¤å¯¹è§’çº¿ï¼Œæ‰€ä»¥é™¤ä»¥(k-1)                       â”‚
â”‚                                                      â”‚
â”‚ # 2.4 è®¡ç®—PCI_A                                     â”‚
â”‚ PCI_A = mean([Q_1, Q_2, ..., Q_k])                  â”‚
â”‚       = mean(Q_i) for all i in pathway              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: è®¡ç®—PCI_Bï¼ˆå…¨å±€ç›¸å…³æ€§ï¼‰                       â”‚
â”‚                                                      â”‚
â”‚ if sorted_genes provided:                           â”‚
â”‚     pci_b_values = []                               â”‚
â”‚     for gene in pathway_genes:                      â”‚
â”‚         if gene in sorted_genes:                    â”‚
â”‚             idx = sorted_genes.index(gene)          â”‚
â”‚             Q_global = sorted_correlations[idx]     â”‚
â”‚             pci_b_values.append(Q_global)           â”‚
â”‚                                                      â”‚
â”‚     PCI_B = mean(pci_b_values)                      â”‚
â”‚ else:                                               â”‚
â”‚     PCI_B = None                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: è®¡ç®—PAIï¼ˆé€šè·¯æ¿€æ´»æŒ‡æ•°ï¼‰                       â”‚
â”‚                                                      â”‚
â”‚ PAI = genes_found / total_genes                     â”‚
â”‚     = len(pathway_indices) / len(pathway_genes)     â”‚
â”‚                                                      â”‚
â”‚ # ç¤ºä¾‹:                                             â”‚
â”‚ # pathway_genesæœ‰100ä¸ªåŸºå›                            â”‚
â”‚ # æ•°æ®é›†ä¸­æ‰¾åˆ°45ä¸ª                                   â”‚
â”‚ # PAI = 45/100 = 0.45                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: è®¡ç®—CECI                                    â”‚
â”‚                                                      â”‚
â”‚ if PCI_B is not None:                               â”‚
â”‚     CECI = PAI Ã— PCI_B Ã— 100                        â”‚
â”‚ else:                                               â”‚
â”‚     CECI = PAI Ã— PCI_A Ã— 100                        â”‚
â”‚                                                      â”‚
â”‚ # ç¤ºä¾‹:                                             â”‚
â”‚ # PAI = 0.45                                        â”‚
â”‚ # PCI_B = 0.72                                      â”‚
â”‚ # CECI = 0.45 Ã— 0.72 Ã— 100 = 32.4                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: è®¡ç®—Z-score                                  â”‚
â”‚                                                      â”‚
â”‚ # èƒŒæ™¯åˆ†å¸ƒå‚æ•°ï¼ˆä»éšæœºåŸºå› é›†è®¡ç®—å¾—åˆ°ï¼‰                â”‚
â”‚ background_mean = 7.908                             â”‚
â”‚ background_std = 2.0605                             â”‚
â”‚                                                      â”‚
â”‚ Z = (CECI - background_mean) / background_std       â”‚
â”‚   = (32.4 - 7.908) / 2.0605                         â”‚
â”‚   = 11.87                                           â”‚
â”‚                                                      â”‚
â”‚ # ä¸´ç•ŒZå€¼ï¼ˆÎ±=0.05ï¼‰:                                â”‚
â”‚ Z_critical = 1.96                                   â”‚
â”‚                                                      â”‚
â”‚ # åˆ¤æ–­:                                             â”‚
â”‚ if |Z| &gt; Z_critical:                                â”‚
â”‚     é€šè·¯æ˜¾è‘—æ¿€æ´»ï¼ˆæˆ–æŠ‘åˆ¶ï¼‰                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2 id="_7">ä¸ƒã€å†…å­˜ç®¡ç†å’ŒçŠ¶æ€æŒä¹…åŒ–<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 åç«¯å†…å­˜ç®¡ç†<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<p><strong>IVCCAåˆ†æå™¨å®ä¾‹å­˜å‚¨</strong>ï¼š</p>
<pre><code class="language-python"># å…¨å±€å­—å…¸ï¼ˆå†…å­˜ä¸­ï¼‰
analyzers: Dict[str, IVCCAAnalyzer] = {}

# åˆ›å»ºæ–°å®ä¾‹
analyzer_id = str(uuid.uuid4())
analyzers[analyzer_id] = IVCCAAnalyzer()

# è·å–å®ä¾‹
analyzer = analyzers.get(analyzer_id)
</code></pre>
<p><strong>å†…å­˜å ç”¨</strong>ï¼š</p>
<pre><code>å•ä¸ªanalyzerå®ä¾‹å†…å­˜å ç”¨:
â”œâ”€ self.data: (samples, genes) Ã— 8 bytes (float64)
â”œâ”€ self.correlation_matrix: (genes, genes) Ã— 8 bytes
â””â”€ å…¶ä»–å˜é‡: ~å‡ MB

ä¾‹å¦‚: 1000ä¸ªåŸºå› ï¼Œ100ä¸ªæ ·æœ¬
â”œâ”€ data: 100 Ã— 1000 Ã— 8 = 800 KB
â””â”€ correlation_matrix: 1000 Ã— 1000 Ã— 8 = 8 MB
æ€»è®¡: ~10 MB per analyzer
</code></pre>
<p><strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼š</p>
<ul>
<li>å®ä¾‹åœ¨å†…å­˜ä¸­ç›´åˆ°æœåŠ¡å™¨é‡å¯</li>
<li>æ— è‡ªåŠ¨æ¸…ç†æœºåˆ¶ï¼ˆå¯ä»¥æ·»åŠ TTLï¼‰</li>
<li>æ”¯æŒå¤šä¸ªç”¨æˆ·åŒæ—¶åˆ†æï¼ˆæ¯ä¸ªç”¨æˆ·æœ‰ç‹¬ç«‹çš„analyzer_idï¼‰</li>
</ul>
<h3 id="72">7.2 å‰ç«¯çŠ¶æ€ç®¡ç†<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<p><strong>çŠ¶æ€ç”Ÿå‘½å‘¨æœŸ</strong>ï¼š</p>
<pre><code>ç»„ä»¶æŒ‚è½½ (mount)
    â”‚
    â”œâ”€â†’ useStateåˆå§‹åŒ–
    â”œâ”€â†’ useEffectæ‰§è¡Œ
    â””â”€â†’ åˆå§‹æ¸²æŸ“
    â”‚
ç”¨æˆ·æ“ä½œ
    â”‚
    â”œâ”€â†’ çŠ¶æ€æ›´æ–° (setState)
    â””â”€â†’ Reacté‡æ¸²æŸ“
    â”‚
ç»„ä»¶å¸è½½ (unmount)
    â”‚
    â””â”€â†’ çŠ¶æ€æ¸…ç†
</code></pre>
<p><strong>æŒä¹…åŒ–å­˜å‚¨</strong>ï¼š</p>
<pre><code class="language-typescript">// localStorageï¼ˆæµè§ˆå™¨å­˜å‚¨ï¼‰
localStorage.setItem('authToken', token);      // è®¤è¯token
localStorage.setItem('isLoggedIn', 'true');    // ç™»å½•çŠ¶æ€

// ä¼šè¯çº§å­˜å‚¨ï¼ˆåˆ·æ–°é¡µé¢åä¸¢å¤±ï¼‰
// - æ‰€æœ‰useStateçŠ¶æ€
// - APIå“åº”æ•°æ®
// - UIçŠ¶æ€
</code></pre>
<hr />
<h2 id="_8">å…«ã€é”™è¯¯å¤„ç†å’Œå¼‚å¸¸æµç¨‹<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 å‰ç«¯é”™è¯¯å¤„ç†æµç¨‹<a class="headerlink" href="#81" title="Permanent link">&para;</a></h3>
<pre><code>APIè°ƒç”¨
    â”‚
    â”œâ”€â†’ æˆåŠŸ (response.ok === true)
    â”‚     â”‚
    â”‚     â””â”€â†’ è§£æJSON â†’ æ›´æ–°çŠ¶æ€ â†’ æ˜¾ç¤ºç»“æœ
    â”‚
    â””â”€â†’ å¤±è´¥
          â”‚
          â”œâ”€â†’ ç½‘ç»œé”™è¯¯ (fetch error)
          â”‚     â”‚
          â”‚     â””â”€â†’ catchå— â†’ setError() â†’ æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
          â”‚
          â””â”€â†’ HTTPé”™è¯¯ (response.ok === false)
                â”‚
                â”œâ”€â†’ 400: å®¢æˆ·ç«¯é”™è¯¯ â†’ æ˜¾ç¤ºé”™è¯¯è¯¦æƒ…
                â”œâ”€â†’ 401: æœªè®¤è¯ â†’ è·³è½¬ç™»å½•é¡µ
                â”œâ”€â†’ 404: èµ„æºä¸å­˜åœ¨ â†’ æ˜¾ç¤º&quot;æœªæ‰¾åˆ°&quot;
                â””â”€â†’ 500: æœåŠ¡å™¨é”™è¯¯ â†’ æ˜¾ç¤º&quot;æœåŠ¡å™¨é”™è¯¯&quot;
</code></pre>
<h3 id="82">8.2 åç«¯é”™è¯¯å¤„ç†æµç¨‹<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<pre><code>è¯·æ±‚æ¥æ”¶
    â”‚
    â”œâ”€â†’ å‚æ•°éªŒè¯å¤±è´¥ (Pydantic)
    â”‚     â”‚
    â”‚     â””â”€â†’ è‡ªåŠ¨è¿”å›422 (Unprocessable Entity)
    â”‚
    â”œâ”€â†’ ä¸šåŠ¡é€»è¾‘é”™è¯¯
    â”‚     â”‚
    â”‚     â”œâ”€â†’ ValueError â†’ HTTPException(400)
    â”‚     â”œâ”€â†’ KeyError â†’ HTTPException(404)
    â”‚     â””â”€â†’ Exception â†’ HTTPException(500)
    â”‚
    â””â”€â†’ æˆåŠŸ
          â”‚
          â””â”€â†’ è¿”å›JSONå“åº” (200)
</code></pre>
<hr />
<h2 id="_9">ä¹ã€æ€§èƒ½ä¼˜åŒ–ç»†èŠ‚<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–<a class="headerlink" href="#91" title="Permanent link">&para;</a></h3>
<p><strong>ç´¢å¼•ä½¿ç”¨</strong>ï¼š</p>
<pre><code>æŸ¥è¯¢: {&quot;gene_symbol&quot;: {&quot;$regex&quot;: &quot;^GAPDH$&quot;, &quot;$options&quot;: &quot;i&quot;}}

æ— ç´¢å¼•:
â”œâ”€ å…¨è¡¨æ‰«æ: O(n)
â””â”€ æ—¶é—´å¤æ‚åº¦: é«˜

æœ‰ç´¢å¼•:
â”œâ”€ ç´¢å¼•æŸ¥æ‰¾: O(log n)
â””â”€ æ—¶é—´å¤æ‚åº¦: ä½ï¼ˆå¯¹æ•°çº§ï¼‰

ç´¢å¼•ç»“æ„ï¼ˆB-Treeï¼‰:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ACTB â†’ doc1 â”‚
â”‚ ACTB â†’ doc2 â”‚
â”‚ ACTB â†’ doc3 â”‚
â”‚ ...         â”‚
â”‚ GAPDH â†’ doc5â”‚  â† å¿«é€Ÿå®šä½
â”‚ GAPDH â†’ doc6â”‚
â”‚ ...         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="92">9.2 ç›¸å…³æ€§è®¡ç®—ä¼˜åŒ–<a class="headerlink" href="#92" title="Permanent link">&para;</a></h3>
<p><strong>å‘é‡åŒ–è®¡ç®—</strong>ï¼š</p>
<pre><code>ä¼ ç»Ÿå¾ªç¯æ–¹å¼:
for i in range(n_genes):
    for j in range(i+1, n_genes):
        r[i,j] = calculate_correlation(data[:,i], data[:,j])
æ—¶é—´å¤æ‚åº¦: O(nÂ² Ã— m) å…¶ä¸­m=æ ·æœ¬æ•°

å‘é‡åŒ–æ–¹å¼ (pandas):
correlation_matrix = data_df.corr()
æ—¶é—´å¤æ‚åº¦: O(nÂ² Ã— m) ä½†å®é™…æ›´å¿«ï¼ˆåº•å±‚ä¼˜åŒ–ï¼‰

NumPyä¼˜åŒ–:
- ä½¿ç”¨BLASåº“ï¼ˆçº¿æ€§ä»£æ•°åº“ï¼‰
- å¤šçº¿ç¨‹è®¡ç®—
- SIMDæŒ‡ä»¤é›†åŠ é€Ÿ
</code></pre>
<h3 id="93">9.3 å‰ç«¯æ¸²æŸ“ä¼˜åŒ–<a class="headerlink" href="#93" title="Permanent link">&para;</a></h3>
<p><strong>Reactä¼˜åŒ–</strong>ï¼š</p>
<pre><code>1. ä½¿ç”¨useMemoç¼“å­˜è®¡ç®—ç»“æœ
   const filteredResults = useMemo(() =&gt; {
       return results.filter(...);
   }, [results]);

2. ä½¿ç”¨useCallbackç¼“å­˜å‡½æ•°
   const handleClick = useCallback(() =&gt; {
       // ...
   }, [dependencies]);

3. ä»£ç åˆ†å‰²ï¼ˆåŠ¨æ€å¯¼å…¥ï¼‰
   const Plot = dynamic(() =&gt; import('react-plotly.js'));
</code></pre>
<hr />
<h2 id="_10">åã€éƒ¨ç½²å’Œè¿è¡Œæµç¨‹<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<h3 id="101">10.1 å¼€å‘ç¯å¢ƒå¯åŠ¨æµç¨‹<a class="headerlink" href="#101" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: å¯åŠ¨åç«¯                    â”‚
â”‚                                     â”‚
â”‚ cd backend                          â”‚
â”‚ python server.py                    â”‚
â”‚                                     â”‚
â”‚ æˆ–:                                 â”‚
â”‚ uvicorn server:app --reload         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”œâ”€â†’ åŠ è½½ç¯å¢ƒå˜é‡
    â”œâ”€â†’ è¿æ¥MongoDB
    â”œâ”€â†’ åˆå§‹åŒ–APIç±»
    â”œâ”€â†’ å¯åŠ¨FastAPIæœåŠ¡å™¨
    â””â”€â†’ ç›‘å¬ç«¯å£8000
    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: å¯åŠ¨å‰ç«¯                    â”‚
â”‚                                     â”‚
â”‚ cd genegen                          â”‚
â”‚ npm run dev                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”œâ”€â†’ ç¼–è¯‘TypeScript
    â”œâ”€â†’ å¯åŠ¨Next.jså¼€å‘æœåŠ¡å™¨
    â””â”€â†’ ç›‘å¬ç«¯å£3000
    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: æµè§ˆå™¨è®¿é—®                  â”‚
â”‚                                     â”‚
â”‚ http://localhost:3000               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="102">10.2 ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æµç¨‹<a class="headerlink" href="#102" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: æ„å»ºå‰ç«¯                    â”‚
â”‚                                     â”‚
â”‚ cd genegen                          â”‚
â”‚ npm run build                       â”‚
â”‚ # ç”Ÿæˆ.nextç›®å½•                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: Dockeræ„å»º                  â”‚
â”‚                                     â”‚
â”‚ docker-compose build                â”‚
â”‚ # æ„å»ºbackendå’Œfrontendé•œåƒ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: å¯åŠ¨å®¹å™¨                    â”‚
â”‚                                     â”‚
â”‚ docker-compose up -d                â”‚
â”‚ # åå°è¿è¡Œæ‰€æœ‰æœåŠ¡                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: Nginxåå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰        â”‚
â”‚                                     â”‚
â”‚ é…ç½®Nginxå°†è¯·æ±‚è½¬å‘åˆ°å®¹å™¨            â”‚
â”‚ /api/* â†’ backend:8000              â”‚
â”‚ /* â†’ frontend:3000                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2 id="_11">åä¸€ã€å…³é”®æŠ€æœ¯å†³ç­–è¯´æ˜<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<h3 id="111-mongodb">11.1 ä¸ºä»€ä¹ˆé€‰æ‹©MongoDBï¼Ÿ<a class="headerlink" href="#111-mongodb" title="Permanent link">&para;</a></h3>
<p><strong>åŸå› </strong>ï¼š<br />
1. <strong>çµæ´»çš„æ•°æ®æ¨¡å‹</strong>ï¼šä¸åŒç»„ç»‡çš„åŸºå› æ•°é‡å¯èƒ½ä¸åŒï¼Œæ–‡æ¡£æ¨¡å‹æ›´çµæ´»<br />
2. <strong>å¿«é€Ÿå¼€å‘</strong>ï¼šæ— éœ€é¢„å®šä¹‰schema<br />
3. <strong>æ°´å¹³æ‰©å±•</strong>ï¼šæ”¯æŒåˆ†ç‰‡å’Œå‰¯æœ¬é›†<br />
4. <strong>ç´¢å¼•æ”¯æŒ</strong>ï¼šB-treeç´¢å¼•åŠ é€ŸæŸ¥è¯¢</p>
<p><strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼š<br />
- PostgreSQLï¼šéœ€è¦é¢„å®šä¹‰è¡¨ç»“æ„ï¼Œä½†æ”¯æŒSQLæŸ¥è¯¢<br />
- SQLiteï¼šè½»é‡çº§ï¼Œä½†ä¸é€‚åˆå¹¶å‘</p>
<h3 id="112-fastapi">11.2 ä¸ºä»€ä¹ˆé€‰æ‹©FastAPIï¼Ÿ<a class="headerlink" href="#112-fastapi" title="Permanent link">&para;</a></h3>
<p><strong>åŸå› </strong>ï¼š<br />
1. <strong>æ€§èƒ½</strong>ï¼šåŸºäºStarletteï¼Œå¼‚æ­¥æ”¯æŒï¼Œæ€§èƒ½æ¥è¿‘Node.js<br />
2. <strong>è‡ªåŠ¨æ–‡æ¡£</strong>ï¼šOpenAPI/Swaggerè‡ªåŠ¨ç”Ÿæˆ<br />
3. <strong>ç±»å‹å®‰å…¨</strong>ï¼šPydanticæ¨¡å‹è‡ªåŠ¨éªŒè¯<br />
4. <strong>Pythonç”Ÿæ€</strong>ï¼šå¯ä»¥ä½¿ç”¨æ‰€æœ‰Pythonç§‘å­¦è®¡ç®—åº“</p>
<p><strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼š<br />
- Djangoï¼šå¤ªé‡ï¼Œé€‚åˆå…¨æ ˆåº”ç”¨<br />
- Flaskï¼šè½»é‡ä½†ç¼ºå°‘è‡ªåŠ¨æ–‡æ¡£å’Œç±»å‹éªŒè¯</p>
<h3 id="113-nextjs">11.3 ä¸ºä»€ä¹ˆé€‰æ‹©Next.jsï¼Ÿ<a class="headerlink" href="#113-nextjs" title="Permanent link">&para;</a></h3>
<p><strong>åŸå› </strong>ï¼š<br />
1. <strong>æœåŠ¡ç«¯æ¸²æŸ“</strong>ï¼šSEOå‹å¥½<br />
2. <strong>æ–‡ä»¶ç³»ç»Ÿè·¯ç”±</strong>ï¼šç®€å•ç›´è§‚<br />
3. <strong>è‡ªåŠ¨ä»£ç åˆ†å‰²</strong>ï¼šä¼˜åŒ–åŠ è½½æ€§èƒ½<br />
4. <strong>Reactç”Ÿæ€</strong>ï¼šå¯ä»¥ä½¿ç”¨æ‰€æœ‰Reactåº“</p>
<p><strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼š<br />
- Create React Appï¼šç¼ºå°‘SSRå’Œè·¯ç”±<br />
- Vue.jsï¼šä¸åŒçš„æŠ€æœ¯æ ˆ</p>
<hr />
<h2 id="_12">åäºŒã€ç³»ç»Ÿæ‰©å±•ç‚¹<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<h3 id="121">12.1 æ•°æ®æ‰©å±•<a class="headerlink" href="#121" title="Permanent link">&para;</a></h3>
<p><strong>æ·»åŠ æ–°ç»„ç»‡</strong>ï¼š</p>
<pre><code>1. å°†æ–°çš„Excelæ–‡ä»¶æ”¾å…¥ backend/data/
2. é‡å¯åç«¯æœåŠ¡å™¨
3. GeneSearchAPI.__init__() è‡ªåŠ¨åŠ è½½æ–°æ•°æ®
</code></pre>
<p><strong>æ·»åŠ æ–°å­—æ®µ</strong>ï¼š</p>
<pre><code>1. ä¿®æ”¹Excelæ–‡ä»¶ï¼Œæ·»åŠ æ–°åˆ—
2. ä¿®æ”¹GeneDataæ¨¡å‹ï¼ˆserver.pyï¼‰
3. ä¿®æ”¹æ•°æ®åŠ è½½é€»è¾‘
4. ä¿®æ”¹å‰ç«¯æ˜¾ç¤ºç»„ä»¶
</code></pre>
<h3 id="122">12.2 åŠŸèƒ½æ‰©å±•<a class="headerlink" href="#122" title="Permanent link">&para;</a></h3>
<p><strong>æ·»åŠ æ–°çš„åˆ†æç®—æ³•</strong>ï¼š</p>
<pre><code>1. åœ¨ivcca_core.pyä¸­æ·»åŠ æ–°æ–¹æ³•
2. åœ¨server.pyä¸­æ·»åŠ æ–°çš„APIç«¯ç‚¹
3. åœ¨å‰ç«¯æ·»åŠ æ–°çš„UIç»„ä»¶
</code></pre>
<p><strong>æ·»åŠ æ–°çš„å¯è§†åŒ–ç±»å‹</strong>ï¼š</p>
<pre><code>1. åœ¨åç«¯åˆ›å»ºæ–°çš„å›¾è¡¨ç”Ÿæˆå‡½æ•°
2. ä½¿ç”¨matplotlib/Plotlyç”Ÿæˆå›¾è¡¨
3. è¿”å›base64æˆ–Plotly JSON
4. å‰ç«¯æ¸²æŸ“å›¾è¡¨
</code></pre>
<hr />
<p><strong>æ–‡æ¡£ç‰ˆæœ¬</strong>ï¼š1.0<br />
<strong>æœ€åæ›´æ–°</strong>ï¼š2024å¹´</p>
    
    <script>
        // Print hint
        window.onbeforeprint = function() {
            console.log("Print hint: Please select 'Save as PDF' or 'Print to PDF'");
        };
    </script>
</body>
</html>